<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="css/magnific-popup.css" /> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•ã‚’juliaã§ã‚„ã‚‹ </title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">ãƒˆãƒƒãƒ—</a> <li><a href="" class=has-arrow >çµ±è¨ˆçš„æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">ç¬¬ä¸€ç« ã€€ç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap2/">ç¬¬äºŒç« ã€€åˆ†é¡</a> <li><a href="/Joe.jl/StatisticalML/chap3/">ç¬¬ä¸‰ç« ã€€ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</a> <li><a href="/Joe.jl/StatisticalML/chap4/">ç¬¬å››ç« ã€€æƒ…å ±é‡åŸºæº–</a> <li><a href="/Joe.jl/StatisticalML/chap5/">ç¬¬äº”ç« ã€€æ­£å‰‡åŒ–</a> <li><a href="/Joe.jl/StatisticalML/chap6/">ç¬¬å…­ç« ã€€éç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap7/">ç¬¬ä¸ƒç« ã€€æ±ºå®šæœ¨</a> </ul> <li><a href="" class=has-arrow >ã‚¹ãƒ‘ãƒ¼ã‚¹æ¨å®š100å•</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">éç·šå½¢å›å¸°</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#å¤šé …å¼å›å¸°">å¤šé …å¼å›å¸°</a><ol><li><a href="#ä¾‹52">ä¾‹52</a><li><a href="#ä¾‹53">ä¾‹53</a></ol><li><a href="#ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°">ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°</a><ol><li><a href="#ä¾‹54">ä¾‹54</a><li><a href="#ä¾‹56_è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³æ›²ç·š">ä¾‹56 è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³æ›²ç·š</a></ol><li><a href="#å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³">å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³</a><ol><li><a href="#ä¾‹57">ä¾‹57</a><li><a href="#ä¾‹58_ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã®æ­£å‰‡åŒ–ä¹—æ•°ã®æœ€é©åŒ–">ä¾‹58 ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã®æ­£å‰‡åŒ–ä¹—æ•°ã®æœ€é©åŒ–</a></ol><li><a href="#å±€æ‰€å›å¸°">å±€æ‰€å›å¸°</a><ol><li><a href="#ä¾‹60_nadaraya-watsonæ¨å®šé‡">ä¾‹60 nadaraya-watsonæ¨å®šé‡</a><li><a href="#ä¾‹61_å±€æ‰€ç·šå½¢å›å¸°">ä¾‹61 å±€æ‰€ç·šå½¢å›å¸°</a></ol><li><a href="#ä¸€èˆ¬åŒ–åŠ æ³•ãƒ¢ãƒ‡ãƒ«">ä¸€èˆ¬åŒ–åŠ æ³•ãƒ¢ãƒ‡ãƒ«</a><ol><li><a href="#ä¾‹62">ä¾‹62</a><li><a href="#ä¾‹63">ä¾‹63</a></ol></ol></div> <h2 id="å¤šé …å¼å›å¸°"><a href="#å¤šé …å¼å›å¸°" class=header-anchor >å¤šé …å¼å›å¸°</a></h2> <h3 id="ä¾‹52"><a href="#ä¾‹52" class=header-anchor >ä¾‹52</a></h3> <p>siné–¢æ•°ã«ä¹±æ•°ã‚’è¶³ã—ãŸè¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’å¤šé …å¼ã§å›å¸°ã—ã¾ã™ã€‚ <div class=blank ></div> ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ</p> <pre><code class=language-julia >using Plots, Joe, Random
Random.seed&#33;&#40;12&#41;
n &#61; 100; x &#61; randn&#40;n&#41;; y &#61; sin.&#40;x&#41; &#43; randn&#40;n&#41;;
p52 &#61; scatter&#40;x,y,xlabel&#61;&quot;x&quot;, ylabel&#61;&quot;y&quot;, label&#61;false, legend&#61;:topleft&#41;;</code></pre> <p>3ã€5ã€7æ¬¡ã®å¤šé …å¼ã§å›å¸°ã—ã¾ã™ã€‚ å¤šé …å¼å›å¸°ç”¨ã«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œã‚‹é–¢æ•°ã‚’å®šç¾©ã—ãŸã®ã§ã€ã“ã‚Œã‚’ä½¿ã£ã¦ã¿ã¾ã™ã€‚</p> <pre><code class=language-julia >polynomial&#40;x::Vector, P::Int&#41; &#61; hcat&#40;&#91;x.^p for p in 1:P&#93;...&#41;
polynomial&#40;x::AbstractRange, P::Int&#41;&#61; polynomial&#40;collect&#40;x&#41;,P&#41;</code></pre> <pre><code class=language-julia >using Joe:polynomial
p_set &#61; &#91;3,5,7&#93;
x_seq &#61; -3:0.1:3
for p in p_set
    X &#61; polynomial&#40;x,p&#41;
    Î²Ì‚ &#61; multiple_regression&#40;X,y&#41;
    yÌ‚ &#61; insert_ones&#40;polynomial&#40;x_seq,p&#41;&#41;*Î²Ì‚
    plot&#33;&#40;p52, x_seq,yÌ‚,label&#61;&quot;p &#61; &#36;p&quot;&#41;
end</code></pre> <img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-1.svg" alt=""> <h3 id="ä¾‹53"><a href="#ä¾‹53" class=header-anchor >ä¾‹53</a></h3> <p>çŸ©å½¢æ³¢ã«é›‘éŸ³ã‚’ãƒã‚¤ã‚ºã‚’ã®ã›ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½œã£ã¦ã€ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚ ã¾ãšã¯ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p> <pre><code class=language-julia >using Plots, Random
Random.seed&#33;&#40;123&#41;
n &#61; 100; x &#61; randn&#40;n&#41; * Ï€
y &#61; abs.&#40;round.&#40;x&#41; .&#37;2&#41; * 2  .- 1&#43; randn&#40;n&#41;*0.2
p53 &#61; scatter&#40;x,y,label&#61; false&#41;;</code></pre> <p>åŸºåº•é–¢æ•°ãŒã€<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_1(x) = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>ã€ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>cos</mi><mo>â¡</mo><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f_2(x) = \cos(x) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >cos</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã€ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>3</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>cos</mi><mo>â¡</mo><mo stretchy=false >(</mo><mn>2</mn><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f_3(x) = \cos(2x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >cos</span><span class=mopen >(</span><span class=mord >2</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã€ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>4</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>cos</mi><mo>â¡</mo><mo stretchy=false >(</mo><mn>3</mn><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f_4(x) = \cos(3x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >cos</span><span class=mopen >(</span><span class=mord >3</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã®å ´åˆã¨ã€<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_1(x) = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>ã€ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>sin</mi><mo>â¡</mo><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f_2(x) = \sin(x) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >sin</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã€ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>3</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>sin</mi><mo>â¡</mo><mo stretchy=false >(</mo><mn>2</mn><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f_3(x) = \sin(2x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >sin</span><span class=mopen >(</span><span class=mord >2</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã€ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>4</mn></msub><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>sin</mi><mo>â¡</mo><mo stretchy=false >(</mo><mn>4</mn><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f_4(x) = \sin(4x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >sin</span><span class=mopen >(</span><span class=mord >4</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã®å ´åˆã¨ã§ãã‚Œãã‚Œå›å¸°åˆ†æã—ã¾ã™ã€‚ æº–å‚™ã¨ã—ã¦å…ˆã»ã©ã®polynomialé–¢æ•°ã‚’ã¹ãä¹—ä»¥å¤–ã«ã‚‚å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã§æ‹¡å¼µã—ã¾ã™ã€‚</p> <pre><code class=language-julia >polynomial&#40;x::Vector, P::Int, f::Function&#41; &#61; hcat&#40;&#91;f.&#40;p*x&#41; for p in 1:P&#93;...&#41;
polynomial&#40;x::AbstractRange, P::Int, f::Function&#41; &#61; polynomial&#40;collect&#40;x&#41;, P, f&#41;</code></pre> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mo>âˆ’</mo><mn>8</mn><mo separator=true >,</mo><mn>8</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(-8,8)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >âˆ’</span><span class=mord >8</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >8</span><span class=mclose >)</span></span></span></span>ã®åŒºé–“ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚</p> <pre><code class=language-julia >x_seq &#61; -8:0.2:8</code></pre><pre><code class="plaintext code-output">-8.0:0.2:8.0</code></pre>
<p>cosã®å ´åˆ</p>
<pre><code class=language-julia >X_cos &#61; polynomial&#40;x,3,cos&#41;
Î²Ì‚_cos &#61; multiple_regression&#40;X_cos,y&#41;
yÌ‚_cos &#61; insert_ones&#40;polynomial&#40;x_seq,3,cos&#41;&#41;*Î²Ì‚_cos;</code></pre>
<p>sinã®å ´åˆ</p>
<pre><code class=language-julia >X_sin &#61; polynomial&#40;x,3,sin&#41;
Î²Ì‚_sin &#61; multiple_regression&#40;X_sin,y&#41;
yÌ‚_sin &#61; insert_ones&#40;polynomial&#40;x_seq,3,sin&#41;&#41;*Î²Ì‚_sin;</code></pre>
<p>å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >plot&#33;&#40;p53,x_seq,yÌ‚_cos,label&#61;&quot;cos&quot;&#41;
plot&#33;&#40;p53,x_seq,yÌ‚_sin,label&#61;&quot;sin&quot;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-2.svg" alt=""> <div class=blank ></div> cosã‚’åŸºåº•ã«ã¨ã£ãŸã»ã†ãŒã€ä¸Šæ‰‹ããƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚</p>
<h2 id="ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°"><a href="#ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°" class=header-anchor >ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°</a></h2>
<p>ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°ã«ã¤ã„ã¦ã¯ã€ã¾ãšã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã«é–¢ã™ã‚‹è¤‡åˆå‹ã‚’ä½œã£ã¦ã€ function-like objectã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚ spline_matrixé–¢æ•°ã¯ã€ã‚ã¨ã§å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«ã—ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >using Parameters
@with_kw mutable struct Spline&#123;T&lt;:Number&#125;
    xmin::T &#61; -1.0
    xmax::T &#61; 1.0
    K::Int &#61; 5
end
function spline_matrix&#40;x::Vector,K::Int,xmin,xmax&#41;
    n &#61; length&#40;x&#41;
    Knots &#61; range&#40;xmin,stop&#61;xmax,length&#61;K&#41;
    X &#61; zeros&#40;n,K&#43;4&#41;
    X&#91;:,1&#93; .&#61; 1
    X&#91;:,2&#93; .&#61; x
    X&#91;:,3&#93; .&#61; x.^2
    X&#91;:,4&#93; .&#61; x.^3
    for j in 1:K
        X&#91;:,j&#43;4&#93; &#61; @. max&#40;x - Knots&#91;j&#93;, 0&#41;^3
    end
    return X
end
function &#40;s::Spline&#41;&#40;x::Vector, y::Vector, x_pred::Vector;
          spline_matrix::Function&#61;spline_matrix&#41;
    @unpack xmin, xmax, K &#61; s
    Knots &#61; range&#40;xmin,stop&#61;xmax,length&#61;K&#41;
    X &#61; spline_matrix&#40;x,K,xmin,xmax&#41;
    X_pred &#61; spline_matrix&#40;x_pred,K,xmin,xmax&#41;
    Î² &#61; &#40;X&#39;X&#41;\X&#39;y
    ypred &#61; X_pred*Î²
end
&#40;s::Spline&#41;&#40;x::Vector, y::Vector, x_pred::AbstractRange;kwargs...&#41; &#61; s&#40;x,y,collect&#40;x_pred&#41;;kwargs...&#41;</code></pre>
<h3 id="ä¾‹54"><a href="#ä¾‹54" class=header-anchor >ä¾‹54</a></h3>
<p>sinã‚«ãƒ¼ãƒ–ã«ä¹±æ•°ã‚’åŠ ãˆãŸãƒ‡ãƒ¼ã‚¿ã«ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å›å¸°ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚ åˆ†å‰²ç‚¹æ•°ãŒ7ä»¥ä¸Šã§ãƒ‡ãƒ¼ã‚¿ã«è¿½éšã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<pre><code class=language-julia >using Plots, Random
using Joe: Spline
using Joe
Random.seed&#33;&#40;123&#41;
n &#61; 100; x &#61; randn&#40;n&#41;*2Ï€; y &#61; sin.&#40;x&#41; &#43; 0.2randn&#40;n&#41;
p54 &#61; scatter&#40;x,y,xlims&#61;&#40;-5,5&#41;,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;&quot;,label&#61;false&#41;
K_set &#61; 5:2:9
for K in K_set
    spline &#61; Spline&#40;xmin&#61;-2Ï€, xmax&#61;2Ï€, K&#61;K&#41;
    u_seq &#61; -5:0.2:5
    v_seq &#61; spline&#40;x,y,u_seq&#41;
    plot&#33;&#40;p54, u_seq,v_seq, label&#61;&quot;K &#61; &#36;K&quot;&#41;
end</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-5.svg" alt="">
<h3 id="ä¾‹56_è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³æ›²ç·š"><a href="#ä¾‹56_è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³æ›²ç·š" class=header-anchor >ä¾‹56 è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³æ›²ç·š</a></h3>
<p>ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³æ›²ç·šã®ä¸¡ç«¯ãŒç›´ç·šã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã§ã™ã€‚ åŸè‘—ã§ã¯ã€é–¢æ•°dã¨ã‹é–¢æ•°hã‚’å®šç¾©ã—ã¦ä½¿ã£ã¦ã„ã¾ã—ãŸã€‚ ãã‚“ãªã“ã¨ã¯ã—ãŸããªã„ã‘ã©ã€ã„ã„åå‰ã‚‚ãªã„ã®ã§ã€é–¢æ•°å†…ã§å®šç¾©ã—ã¦ä½¿ã†ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >function natural_spline_matrix&#40;x::Vector, K::Int, xmin, xmax&#41;
    n &#61; length&#40;x&#41;
    Knots &#61; range&#40;xmin,stop&#61;xmax,length&#61;K&#41;
    X &#61; zeros&#40;n,K&#41;
    X&#91;:,1&#93; .&#61; 1
    X&#91;:,2&#93; .&#61; x
    d&#40;x::Vector,a::Number,b::Number&#41; &#61;  @. &#40;max&#40;x-a,0&#41;^3 - max&#40;x-b,0&#41;^3&#41; / &#40;b-a&#41;
    for j in 1:K-2
        X&#91;:,j&#43;2&#93; &#61; d&#40;x,Knots&#91;j&#93;,Knots&#91;end&#93;&#41; - d&#40;x,Knots&#91;end-1&#93;,Knots&#91;end&#93;&#41;
    end
    return X
end</code></pre>
<p>ä¾‹54ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿ã«ã€ãŸã ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã¨è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã®å›å¸°ã‚’é©ç”¨ã—ã€ çµæœã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚ã¾ãšãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã¨ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³å‹ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Plots, Random
using Joe: Spline
using Joe
Random.seed&#33;&#40;123&#41;
n &#61; 100; x &#61; randn&#40;n&#41;*2Ï€; y &#61; sin.&#40;x&#41; &#43; 0.2randn&#40;n&#41;
spline6 &#61; Spline&#40;xmin&#61;-5, xmax&#61;5, K&#61;6&#41;;
spline11 &#61; Spline&#40;xmin&#61;-5, xmax&#61;5, K&#61;11&#41;;</code></pre>
<p>æ¬¡ã«å›å¸°ã‚’è¡Œã„ã¾ã™ã€‚è‡ªç„¶ãªã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã§å›å¸°ã‚’è¡Œã†å ´åˆã«ã¯ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >u_seq &#61; -6:0.02:6;
v_seq6 &#61; spline6&#40;x,y,u_seq&#41;;
v_seq11 &#61; spline11&#40;x,y,u_seq&#41;;
w_seq6 &#61; spline6&#40;x,y,u_seq;splinematrix&#61;Joe.natural_spline_matrix&#41;;
w_seq11 &#61; spline11&#40;x,y,u_seq;splinematrix&#61;Joe.natural_spline_matrix&#41;;</code></pre>
<p>å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >p56_1 &#61; scatter&#40;x,y,xlims&#61;&#40;-7,7&#41;,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;,g&#40;x&#41;&quot;,label&#61;false,title&#61;&quot;K&#61;6&quot;&#41;
p56_2 &#61; scatter&#40;x,y,xlims&#61;&#40;-7,7&#41;,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;,g&#40;x&#41;&quot;,label&#61;false,title&#61;&quot;K&#61;11&quot;&#41;
plot&#33;&#40;p56_1,u_seq,v_seq6,label&#61;&quot;spline&quot;&#41;
plot&#33;&#40;p56_1,u_seq,w_seq6,label&#61;&quot;natural spline&quot;&#41;
vline&#33;&#40;p56_1,&#91;-5,5&#93;;linewidth&#61;1,label&#61;false&#41;
vline&#33;&#40;p56_1,range&#40;-5,stop&#61;5,length&#61;6&#41;;linestyle&#61;:dash,label&#61;false&#41;
plot&#33;&#40;p56_2,u_seq,v_seq11,label&#61;&quot;spline&quot;&#41;
plot&#33;&#40;p56_2,u_seq,w_seq11,label&#61;&quot;natural spline&quot;&#41;
vline&#33;&#40;p56_2,&#91;-5,5&#93;;linewidth&#61;1,label&#61;false&#41;
vline&#33;&#40;p56_2,range&#40;-5,stop&#61;5,length&#61;11&#41;;linestyle&#61;:dash,label&#61;false&#41;
p56 &#61; plot&#40;p56_1,p56_2,layout&#61;&#40;2,1&#41;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-7.svg" alt="">
<h2 id="å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³"><a href="#å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³" class=header-anchor >å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³</a></h2>
<p>å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã¯åŒºåˆ‡ã‚Šç‚¹ã‚’æŒ‡å®šã™ã‚‹ã¨ãã«ãƒ‡ãƒ¼ã‚¿ç‚¹è‡ªèº«ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã€ ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãç›´ã—ã¾ã—ãŸã€‚&#40;function-like objectã«ã™ã‚‹ã¾ã§ã‚‚ãªã‹ã£ãŸã€‚&#41;</p>
<pre><code class=language-julia >struct SmoothingSpline
    x::Vector
end
function &#40;s::SmoothingSpline&#41;&#40;y::Vector,x_pred::Union&#123;Vector,AbstractRange&#125;;Î»&#61;0&#41;
    x &#61; s.x
    X &#61; smoothing_spline_matrix&#40;x,x&#41;
    G &#61; green_silverman&#40;x&#41;
    Î³ &#61; &#40;X&#39;X &#43; Î»*G&#41;\X&#39;y
    X_pred &#61; smoothing_spline_matrix&#40;x_pred,x&#41;
    ypred &#61; X_pred*Î³
end</code></pre>
<p>ãŸã ã—ã€smoothing<em>spline</em>matrixã¨green_silvermané–¢æ•°ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</p>
<pre><code class=language-julia >function smoothing_spline_matrix&#40;x::Vector,Knots::Union&#123;Vector, AbstractRange&#125;&#41;
    n &#61; length&#40;x&#41;
    K &#61; length&#40;Vector&#41;
    X &#61; zeros&#40;n,K&#41;
    X&#91;:,1&#93; .&#61; 1
    X&#91;:,2&#93; .&#61; x
    d&#40;x::Vector,a::Number,b::Number&#41; &#61;  @. &#40;max&#40;x-a,0&#41;^3 - max&#40;x-b,0&#41;^3&#41; / &#40;b-a&#41;
    for j in 1:K-2
        X&#91;:,j&#43;2&#93; &#61; d&#40;x,Knots&#91;j&#93;,Knots&#91;end&#93;&#41; - d&#40;x,Knots&#91;end-1&#93;,Knots&#91;end&#93;&#41;
    end
    return X
end

function green_silverman&#40;x::Vector&#41;
    n &#61; length&#40;x&#41;
    g &#61; zeros&#40;n,n&#41;
    for i in 3:n ,j in i:n
        g&#91;j,i&#93; &#61;&#40;12&#40;x&#91;end&#93;-x&#91;end-1&#93;&#41;*&#40;x&#91;end-1&#93;-x&#91;j-2&#93;&#41;*&#40;x&#91;end-1&#93;-x&#91;i-2&#93;&#41;&#43;
                &#40;x&#91;end-1&#93;-x&#91;j-2&#93;&#41;^2*&#40;12x&#91;end-1&#93;&#43;6x&#91;j-2&#93;-18x&#91;i-2&#93;&#41;&#41;/
                &#40;x&#91;end&#93;-x&#91;i-2&#93;&#41;/&#40;x&#91;end&#93;-x&#91;j-2&#93;&#41;
        g&#91;i,j&#93; &#61; g&#91;j,i&#93;
    end
    return g
end</code></pre>
<h3 id="ä¾‹57"><a href="#ä¾‹57" class=header-anchor >ä¾‹57</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mo stretchy=false >(</mo><mo>âˆ’</mo><mn>5</mn><mo separator=true >,</mo><mn>5</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x\in(-5,5)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >âˆ’</span><span class=mord >5</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >5</span><span class=mclose >)</span></span></span></span>ã®ä¸€æ§˜åˆ†å¸ƒã‹ã‚‰ã‚µãƒ³ãƒ—ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ åŸè‘—ã§ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ç”Ÿæˆã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã€ipynbã®è¨˜è¿°ã‚’å‚ç…§ã—ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >using Plots, Random, Distributions
using Joe: SmoothingSpline
using Joe
Random.seed&#33;&#40;11&#41;
n &#61; 100;
x &#61; rand&#40;Uniform&#40;-5,5&#41;,n&#41;; y &#61; x .&#43; 2sin.&#40;x&#41; &#43; randn&#40;n&#41;
index &#61; sortperm&#40;x&#41;; x &#61; x&#91;index&#93;; y &#61; y&#91;index&#93;

p57 &#61; scatter&#40;x,y,label&#61;false&#41;

sspline &#61; SmoothingSpline&#40;x&#41;
u_seq &#61; -8:0.02:8
Î»_set &#61; &#91;40,400,1000&#93;
for Î» in Î»_set
    v_seq &#61; sspline&#40;y,u_seq,Î»&#61;Î»&#41;
    plot&#33;&#40;p57,u_seq,v_seq,label&#61;&quot;Î» &#61; &#36;Î»&quot;&#41;
end
p57
plot&#33;&#40;p57,u_seq,sspline&#40;y,u_seq,Î»&#61;1&#41;,label&#61;&quot;Î» &#61; 1&quot;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-8.svg" alt=""> <div class=blank ></div> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">Î»</span></span></span></span>ãŒå¤§ãããªã‚‹ã¨ã€ç›´ç·šã«è¿‘ããªã£ã¦ã„ãã‚ˆã†ã§ã™ã€‚</p>
<h3 id="ä¾‹58_ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã®æ­£å‰‡åŒ–ä¹—æ•°ã®æœ€é©åŒ–"><a href="#ä¾‹58_ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã®æ­£å‰‡åŒ–ä¹—æ•°ã®æœ€é©åŒ–" class=header-anchor >ä¾‹58 ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å¹³æ»‘åŒ–ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ã®æ­£å‰‡åŒ–ä¹—æ•°ã®æœ€é©åŒ–</a></h3>
<p>3ç« ã§ä½¿ã£ãŸç·šå½¢å›å¸°ã®å ´åˆã®é«˜é€Ÿãªã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å…¬å¼</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>C</mi><mi>V</mi><mo stretchy=false >[</mo><mi>Î»</mi><mo stretchy=false >]</mo><mo><mi mathvariant=normal >â‰”</mi></mo><munder><mo>âˆ‘</mo><mi>S</mi></munder><mi mathvariant=normal >âˆ£</mi><mi mathvariant=normal >âˆ£</mi><mo stretchy=false >(</mo><mi>I</mi><mo>âˆ’</mo><msub><mi>H</mi><mi>S</mi></msub><mo stretchy=false >[</mo><mi>Î»</mi><mo stretchy=false >]</mo><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msub><mi>e</mi><mi>S</mi></msub><mi mathvariant=normal >âˆ£</mi><msup><mi mathvariant=normal >âˆ£</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">CV[\lambda] \coloneqq \sum_{S}||(I - H_S[\lambda])^{-1}e_S ||^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class=mopen >[</span><span class="mord mathnormal">Î»</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class=mop  style="position:relative;top:-0.03472em;">:</span></span><span class=mrel ><span class=mspace  style="margin-right:-0.06666666666666667em;"></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.344341em;vertical-align:-1.294336em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.294336em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >âˆ£</span><span class=mord >âˆ£</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathnormal">Î»</span><span class=mclose >]</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class=mord ><span class=mord >âˆ£</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>H</mi><mi>S</mi></msub><mo stretchy=false >[</mo><mi>Î»</mi><mo stretchy=false >]</mo><mo><mi mathvariant=normal >â‰”</mi></mo><msub><mi>X</mi><mi>s</mi></msub><mo stretchy=false >(</mo><msup><mi>X</mi><mi mathvariant=sans-serif >T</mi></msup><mi>X</mi><mo>+</mo><mi>Î»</mi><mi>G</mi><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msubsup><mi>X</mi><mi>S</mi><mi mathvariant=sans-serif >T</mi></msubsup></mrow><annotation encoding="application/x-tex">H_S[\lambda] \coloneqq X_s(X^\mathsf{T}X+\lambda G)^{-1}X^\mathsf{T}_S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathnormal">Î»</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class=mop  style="position:relative;top:-0.03472em;">:</span></span><span class=mrel ><span class=mspace  style="margin-right:-0.06666666666666667em;"></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.149108em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathsf mtight">T</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1491079999999998em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Î»</span><span class="mord mathnormal">G</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathsf mtight">T</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>ã‚’åˆ©ç”¨ã—ã¦ã€<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">Î»</span></span></span></span>ã®æœ€é©åŒ–ã‚’è¡Œã„ã¾ã™ã€‚ ä»¥ä¸‹ã®cv<em>ss</em>fasté–¢æ•°ã‚’å®šç¾©ã—ã¦åˆ©ç”¨ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >function cv_ss_fast&#40;X::AbstractArray,y::Vector,G::AbstractArray,K::Int;Î»&#61;0&#41;
    n &#61; length&#40;y&#41;; m &#61; round&#40;Int,n/K&#41;
    H &#61; X*&#40;&#40;X&#39;X &#43; Î»*G&#41;\X&#39;&#41;
    e &#61; &#40;I&#40;n&#41; - H&#41;*y
    S &#61; 0
    @views for j in 1:K
        test &#61; j*m-m&#43;1:j*m;
        err &#61; &#40;I&#40;m&#41;-H&#91;test,test&#93;&#41; \ e&#91;test&#93;
        S &#43;&#61; dot&#40;err,err&#41;
    end
    return S/n,tr&#40;H&#41;
end</code></pre>
<p>3ç« ã®ä½¿ã£ãŸcv_fasté–¢æ•°ã¨ã»ã¼åŒæ§˜ã§ã™ãŒã€å®šæ•°é …ã®åˆ—ã‚’ä»˜ã‘ãªã„ã“ã¨ã¨ã€ æ­£å‰‡åŒ–ä¹—æ•°ãŒå¼•æ•°ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã€ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èª¤å·®ã ã‘ã§ãªãã€ Hã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚‚è¿”ã—ã¦ã„ã‚‹ã“ã¨ãªã©ãŒç•°ãªã‚Šã¾ã™ã€‚ ã¾ãšã¯ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Random, Distributions
Random.seed&#33;&#40;11&#41;
n &#61; 100; x &#61; rand&#40;Uniform&#40;-5,5&#41;,n&#41; ; y &#61; x -0.02sin.&#40;x&#41;-0.1randn&#40;n&#41;;
index &#61; sortperm&#40;x&#41;; x &#61; x&#91;index&#93;; y &#61; y&#91;index&#93;;</code></pre>
<p>Xã¨Gã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >X &#61; Joe.smoothing_spline_matrix&#40;x,x&#41;;
G &#61; Joe.green_silverman&#40;x&#41;;</code></pre>
<p>ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èª¤å·®ã¨Hã®ãƒˆãƒ¬ãƒ¼ã‚¹&#40;æœ‰åŠ¹è‡ªç”±åº¦&#41;ã‚’æ±‚ã‚ã¾ã™ã€‚</p>
<pre><code class=language-julia >result &#61; hcat&#40;&#91;collect&#40;Joe.cv_ss_fast&#40;X,y,G,n,Î»&#61;Î»&#41;&#41; for Î» in 1:50&#93;...&#41;
using Plots
p58 &#61; plot&#40;result&#91;2,:&#93;, result&#91;1,:&#93;,label&#61; false,
            xlabel&#61;&quot;æœ‰åŠ¹è‡ªç”±åº¦&quot;, ylabel&#61;&quot;CVã«ã‚ˆã‚‹äºˆæ¸¬èª¤å·®&quot;,
            title &#61; &quot;æœ‰åŠ¹è‡ªç”±åº¦ã¨CVã«ã‚ˆã‚‹äºˆæ¸¬èª¤å·®&quot;&#41;
savefig&#40;p58,joinpath&#40;@OUTPUT,&quot;fig6-9.svg&quot;&#41;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-9.svg" alt=""> <div class=blank ></div> &#40;æ³¨&#41;ã¡ãªã¿ã«ç”Ÿæˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦ã€ã‚°ãƒ©ãƒ•ã®å½¢ã¯ã‹ãªã‚Šå¤‰ã‚ã‚Šã¾ã™ã€‚</p>
<h2 id="å±€æ‰€å›å¸°"><a href="#å±€æ‰€å›å¸°" class=header-anchor >å±€æ‰€å›å¸°</a></h2>
<h3 id="ä¾‹60_nadaraya-watsonæ¨å®šé‡"><a href="#ä¾‹60_nadaraya-watsonæ¨å®šé‡" class=header-anchor >ä¾‹60 nadaraya-watsonæ¨å®šé‡</a></h3>
<p>nadaraya-watsonæ¨å®šé‡ã®è¨ˆç®—ã®å®Ÿè£…ã§ã™ã€‚ ã‚«ãƒ¼ãƒãƒ«ã¯é–¢æ•°ã®å¼•æ•°ã«ã—ã¦ã€åˆ¥ã®ã‚‚ã®ã«å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚&#40;ã“ã“ã§ã¯ä»–ã®ã‚«ãƒ¼ãƒãƒ«ã¯å‡ºã¦ãã¾ã›ã‚“ãŒã€‚&#41;</p>
<pre><code class=language-julia >epanechnikov&#40;x,y,Î»&#41; &#61; norm&#40;x-y&#41;/Î» |&gt; c -&gt; max&#40;0.75*&#40;1-c^2&#41;,0&#41;

function nadaraya_watson_estimator&#40;x_observed::Vector,y_observed::Vector,kk::Function,x_pred::TP;Î»&#61;1.0&#41; where &#123;TP&lt;:Number&#125;
    n &#61; length&#40;y_observed&#41;
    S &#61; 0; T &#61; 0;
    for i in 1:n
        S &#43;&#61; kk&#40;x_observed&#91;i&#93;,x_pred,Î»&#41;*y_observed&#91;i&#93;
        T &#43;&#61; kk&#40;x_observed&#91;i&#93;,x_pred,Î»&#41;
    end
    result &#61; T &#61;&#61; 0 ? 0 : S/T
    return result
end
ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã«ã‚‚å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
function nadaraya_watson_estimator&#40;x_observed::Vector,y_observed::Vector,kk::Function,x_pred::Union&#123;Vector,AbstractRange&#125;;Î»&#61;1.0&#41;
    y_pred &#61; &#91;nadaraya_watson_estimator&#40;x_observed,y_observed,kk,xp; Î»&#41; for xp in x_pred&#93;
end</code></pre>
<p><div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content >epanechnikocé–¢æ•°ã«çµ¶å¯¾å€¤ã®å‡¦ç†ã¯å¿…è¦ã«ãªã‚Šã¾ã™ãŒã€absé–¢æ•°ã‚’ä½¿ã†ã‚ˆã‚Šã‚‚LinearAlgebra.jlã®normã‚’ä½¿ã£ãŸæ–¹ãŒã€å¤šæ¬¡å…ƒåŒ–ã«å¯¾å¿œã§ãã¦è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</div></div> ãƒˆã‚¤ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦siné–¢æ•°ã«ãƒã‚¤ã‚ºã‚’ã®ã›ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Random
Random.seed&#33;&#40;123&#41;
n&#61;250;x &#61; 2randn&#40;n&#41;; y &#61; sin.&#40;2Ï€*x&#41; &#43; randn&#40;n&#41;/4

using Plots
p58 &#61; scatter&#40;x,y,xlims&#61;&#40;-3,3&#41;,label&#61;false&#41;
xx &#61; -3:0.1:3
using Joe:nadaraya_watson_estimator, epanechnikov
using LinearAlgebra</code></pre>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi><mo>=</mo><mn>0.05</mn><mo separator=true >,</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\lambda=0.05,0.25</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">Î»</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >5</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >2</span><span class=mord >5</span></span></span></span>ã®å ´åˆã«ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >plot&#33;&#40;p58,xx,nadaraya_watson_estimator&#40;x,y,epanechnikov,xx;Î»&#61;0.05&#41;,
         label&#61;&quot;Î» &#61; 0.05&quot;&#41;;
plot&#33;&#40;p58,xx,nadaraya_watson_estimator&#40;x,y,epanechnikov,xx;Î»&#61;0.25&#41;,
         label&#61;&quot;Î» &#61; 0.25&quot;&#41;;</code></pre>
<p>ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">Î»</span></span></span></span>ã‚’æœ€é©åŒ–ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >Î»_seq &#61; 0.05:0.01:1
SS_min &#61; Inf
Î»_best &#61; Î»_seq&#91;1&#93;
for Î» in Î»_seq
    SS &#61; 0
    m &#61; Int&#40;n/10&#41;
    for k in 1:10
        test &#61; k*m-m&#43;1:k*m
        train &#61; setdiff&#40;1:n,test&#41;
        y_pred &#61; nadaraya_watson_estimator&#40;x&#91;train&#93;,y&#91;train&#93;,epanechnikov,x&#91;test&#93;;Î»&#61;Î»&#41;
        SS &#43;&#61; dot&#40;y&#91;test&#93;-y_pred,y&#91;test&#93;-y_pred&#41;
    end
    if SS &lt; SS_min
        SS_min &#61; SS
        Î»_best &#61; Î»
    end
end

plot&#33;&#40;p58,xx,nadaraya_watson_estimator&#40;x,y,epanechnikov,xx;Î»&#61;Î»_best&#41;, label&#61;&quot;Î» &#61; Î»_best&quot;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-10.svg" alt=""> <div class=blank ></div> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mrow><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{best}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">Î»</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã¯ã“ã®ç¨‹åº¦ã®å€¤ã«ãªã‚‹ã‚ˆã†ã§ã™ã€‚</p>
<pre><code class=language-julia >@show Î»_best;</code></pre><pre><code class="plaintext code-output">Î»_best = 0.19
</code></pre>
<h3 id="ä¾‹61_å±€æ‰€ç·šå½¢å›å¸°"><a href="#ä¾‹61_å±€æ‰€ç·šå½¢å›å¸°" class=header-anchor >ä¾‹61 å±€æ‰€ç·šå½¢å›å¸°</a></h3>
<p>ã‚«ãƒ¼ãƒãƒ«é–¢æ•°<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã‚’æˆåˆ†ã«æŒã£ãŸå¯¾è§’è¡Œåˆ—<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >W</mi></mrow><annotation encoding="application/x-tex">\bm{W}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.15972em;">W</span></span></span></span></span></span>ã‚’</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi mathvariant=bold-italic >W</mi><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>k</mi><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=false >)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo lspace=0em  rspace=0em >â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi><mi mathvariant=normal >â‹®</mi><mpadded height="+0em" voffset=0em ><mspace mathbackground=black  width=0em  height=1.5em ></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo lspace=0em  rspace=0em >â‹±</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mi><mi mathvariant=normal >â‹®</mi><mpadded height="+0em" voffset=0em ><mspace mathbackground=black  width=0em  height=1.5em ></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo lspace=0em  rspace=0em >â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>k</mi><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{W} = \begin{bmatrix}
 k(x,x_1) &amp; \cdots &amp; 0 \\
 \vdots &amp; \ddots &amp; \vdots \\
 0 &amp; \cdots &amp; k(x,x_n) \end{bmatrix} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.15972em;">W</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:4.260000000000001em;vertical-align:-1.8800000000000006em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.352005em;"><span style="top:-1.9499950000000004em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-3.0999950000000003em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.1109850000000003em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.352005em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.850025em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span><span style="top:-3.3674999999999997em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class=mord >â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.8800000000000006em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.3800000000000003em;"><span style="top:-5.04em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ><span class=minner >â‹¯</span></span></span><span style="top:-3.1799999999999997em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ><span class=minner >â‹±</span></span></span><span style="top:-1.9799999999999995em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ><span class=minner >â‹¯</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.8800000000000006em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord >0</span></span></span><span style="top:-3.3674999999999997em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class=mord >â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.8800000000000006em;"><span></span></span></span></span></span></span></span><span class=mclose ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.352005em;"><span style="top:-1.9499950000000004em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-3.0999950000000003em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.1109850000000003em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.352005em;"><span class=pstrut  style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.850025em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>ã¨ã—ãŸæ™‚ã€</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>L</mi><mo><mi mathvariant=normal >â‰”</mi></mo><mo stretchy=false >(</mo><mi mathvariant=bold-italic >y</mi><mo>âˆ’</mo><mi><mrow><mi mathvariant=bold-italic >X</mi><mi mathvariant=bold-italic >Î²</mi></mrow></mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><msup><mo stretchy=false >)</mo><mi mathvariant=sans-serif >T</mi></msup><mi mathvariant=bold-italic >W</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >y</mi><mo>âˆ’</mo><mi><mrow><mi mathvariant=bold-italic >X</mi><mi mathvariant=bold-italic >Î²</mi></mrow></mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> L \coloneqq (\bm{y} - \bm{XÎ²}(x))^\mathsf{T}\bm{W}(\bm{y} - \bm{XÎ²}(x)) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class=mop  style="position:relative;top:-0.03472em;">:</span></span><span class=mrel ><span class=mspace  style="margin-right:-0.06666666666666667em;"></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.149108em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span><span class="mord boldsymbol" style="margin-right:0.03403em;">Î²</span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathsf mtight">T</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.15972em;">W</span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span><span class="mord boldsymbol" style="margin-right:0.03403em;">Î²</span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mclose >)</span></span></span></span></span>
<p>ã‚’æœ€å°åŒ–ã™ã‚‹<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold-italic >Î²</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\bm{\beta}(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03403em;">Î²</span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>ã‚’æ±‚ã‚ã¾ã™ã€‚</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >âˆ‚</mi><mi>L</mi></mrow><mrow><mi mathvariant=normal >âˆ‚</mi><mi mathvariant=bold-italic >Î²</mi></mrow></mfrac><mo>=</mo><mo>âˆ’</mo><mn>2</mn><msup><mi mathvariant=bold-italic >X</mi><mi mathvariant=sans-serif >T</mi></msup><mi mathvariant=bold-italic >W</mi><mo stretchy=false >(</mo><mi mathvariant=bold-italic >y</mi><mo>âˆ’</mo><mi><mrow><mi mathvariant=bold-italic >X</mi><mi mathvariant=bold-italic >Î²</mi></mrow></mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> \dfrac{\partial L}{\partial \bm{\beta}} =
-2\bm{X}^\mathsf{T}\bm{W}(\bm{y} - \bm{XÎ²}(x))=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">âˆ‚</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03403em;">Î²</span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathnormal">L</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.1751179999999999em;vertical-align:-0.25em;"></span><span class=mord >âˆ’</span><span class=mord >2</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9251179999999999em;"><span style="top:-3.1390100000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathsf mtight">T</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.15972em;">W</span></span></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span><span class="mord boldsymbol" style="margin-right:0.03403em;">Î²</span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span>
<p>ã¨ãŠãã¨ã€</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi mathvariant=bold-italic >Î²</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mo stretchy=false >(</mo><msup><mi mathvariant=bold-italic >X</mi><mi mathvariant=sans-serif >T</mi></msup><mi><mrow><mi mathvariant=bold-italic >W</mi><mi mathvariant=bold-italic >X</mi></mrow></mi><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mi mathvariant=bold-italic >X</mi><mi mathvariant=sans-serif >T</mi></msup><mi><mrow><mi mathvariant=bold-italic >W</mi><mi mathvariant=bold-italic >y</mi></mrow></mi></mrow><annotation encoding="application/x-tex"> \bm{\beta}(x) = (\bm{X}^\mathsf{T}\bm{WX})^{-1}\bm{X}^\mathsf{T}\bm{Wy}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.03403em;">Î²</span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.1751179999999999em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9251179999999999em;"><span style="top:-3.1390100000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathsf mtight">T</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.15972em;">W</span><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9251179999999999em;"><span style="top:-3.1390100000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathsf mtight">T</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord ><span class="mord boldsymbol" style="margin-right:0.15972em;">W</span><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span></span></span>
<p>ã§ä¿‚æ•°ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®å‡¦ç†ã‚’é–¢æ•°ã§å®Ÿè£…ã™ã‚‹ã‚ã‘ã§ã™ãŒã€åŸè‘—ã®localã¨ã„ã†é–¢æ•°åã¯è‰¯ããªã„ã®ã§ã€ local_regressionã¨ã„ã†åå‰ã§å®Ÿè£…ã—ã¾ã—ãŸã€‚ä¾‹ã§ã¯1æ¬¡å…ƒã«é™å®šã—ã¦ã„ã¾ã—ãŸãŒã€ å¤šæ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã«ã‚‚å¯¾å¿œã•ã›ã¦ã„ã¾ã™ã€‚</p>
<pre><code class=language-julia >function local_regression&#40;x::Matrix&#123;T&#125;,
                          y::Vector&#123;T&#125;,
                          kernel::Function;
                          x_pred&#61;x, Î»&#61;1&#41; where &#123;T&lt;:Number&#125;
    N,_ &#61; size&#40;x&#41;
    @assert N&#61;&#61;length&#40;y&#41;
    X &#61; insert_ones&#40;x&#41;
    m,_ &#61; size&#40;x_pred&#41;
    y_pred &#61; Vector&#123;T&#125;&#40;undef,m&#41;
    for j in 1:m
        W &#61; &#91;kernel&#40;x&#91;i,:&#93;,x_pred&#91;j,:&#93;,Î»&#41; for i in 1:N&#93; |&gt; diagm
        Î²Ì‚ &#61; &#40;X&#39;*W*X&#41;\X&#39;*W*y
        y_pred&#91;j&#93; &#61; dot&#40;insert_ones&#40;x_pred&#91;j,:&#93;&#41;,Î²Ì‚&#41;
    end
    return y_pred
end
function local_regression&#40;x::Vector&#123;T&#125;, y::Vector&#123;T&#125;,kernel::Function;x_pred&#61;x,Î»&#61;1&#41; where &#123;T&lt;:Number&#125;
    return local_regression&#40;x&#91;:,:&#93;,y,kernel;x_pred&#61;x_pred&#91;:,:&#93;,Î»&#61;Î»&#41;
end</code></pre>
<p>ãƒˆã‚¤ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦siné–¢æ•°ã«ãƒã‚¤ã‚ºã‚’ã®ã›ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Random,Joe
Random.seed&#33;&#40;123&#41;
n&#61;30; x &#61; 2Ï€*rand&#40;n&#41; .- Ï€; y &#61; sin.&#40;x&#41; .&#43; randn&#40;&#41;
p61 &#61; scatter&#40;x,y,label&#61;false&#41;
m &#61; 200;U &#61; -Ï€:Ï€/m:Ï€;</code></pre>
<p>æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">Î»</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>ã®æ¡ä»¶ã§å›å¸°åˆ†æã‚’è¡Œã£ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >V &#61; Joe.local_regression&#40;x,y,Joe.epanechnikov;x_pred&#61;U&#41;
plot&#33;&#40;p61,U,V,label&#61;false,title &#61; &quot;å±€æ‰€ç·šå½¢å›å¸°&#40;p&#61;1, N&#61;30&#41;&quot;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-11.svg" alt=""> <div class=blank ></div> äºˆæ¸¬ã—ãŸã„å ´æ‰€ã®æ•°ã ã‘å›å¸°åˆ†æã®è¨ˆç®—ã‚’è¡Œã‚ãªã„ã¨ã„ã‘ãªã„ã®ã§ã€å…ƒãƒ‡ãƒ¼ã‚¿ã®æ•°ãŒå¤šã„æ™‚ã¯ è¨ˆç®—ãŒå¤§å¤‰ãã†ã§ã™ã€‚</p>
<h2 id="ä¸€èˆ¬åŒ–åŠ æ³•ãƒ¢ãƒ‡ãƒ«"><a href="#ä¸€èˆ¬åŒ–åŠ æ³•ãƒ¢ãƒ‡ãƒ«" class=header-anchor >ä¸€èˆ¬åŒ–åŠ æ³•ãƒ¢ãƒ‡ãƒ«</a></h2>
<h3 id="ä¾‹62"><a href="#ä¾‹62" class=header-anchor >ä¾‹62</a></h3>
<p>åŸºåº•é–¢æ•°ã®æ•°ãŒæœ‰é™å€‹ãªã‚‰ç·šå½¢å›å¸°ã®æ‰‹æ³•ã§ä¿‚æ•°ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã‘ã©ã€ æ•°ãŒå¤šã™ãã‚‹ã¨é€†è¡Œåˆ—ã‚’è§£ãã®ãŒå¤§å¤‰ã§ã©ã†ã—ã¾ã—ã‚‡ã†ã¨ã„ï¼“ã†è©±ã€‚ ãƒãƒƒã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¯ä¾‹63ã§å®Ÿè£…ã—ã¾ã™ã€‚</p>
<h3 id="ä¾‹63"><a href="#ä¾‹63" class=header-anchor >ä¾‹63</a></h3>
<p>ä»¥ä¸‹ã®ã‚ˆã†ãªpolyfité–¢æ•°ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >function polyfit&#40;x,y;x_pred&#61;x, P::Int&#61;3&#41;
    X &#61; polynomial&#40;x,P&#41;
    X_pred&#61;polynomial&#40;x_pred,P&#41;
    Î²Ì‚ &#61; multiple_regression&#40;X,y&#41;
    y_pred &#61; insert_ones&#40;X_pred&#41; * Î²Ì‚
end</code></pre>
<p><a href="#ä¾‹61">ä¾‹ï¼–ï¼‘</a>ã®ãƒ‡ãƒ¼ã‚¿ã«ä¸€èˆ¬åŠ æ³•ãƒ¢ãƒ‡ãƒ«ã‚’é©ç”¨ã—ã¾ã™ã€‚ å…ˆã«å¤šé …å¼ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¦æ®‹ã‚Šã‚’å±€æ‰€ç·šå½¢å›å¸°ã§æ±‚ã‚ã¦ã„ãã¾ã™ã€‚</p>
<pre><code class=language-julia >using Random,Joe
Random.seed&#33;&#40;123&#41;
n&#61;30; x &#61; 2Ï€*rand&#40;n&#41; .- Ï€; sort&#33;&#40;x&#41;; y &#61; sin.&#40;x&#41; .&#43; randn&#40;&#41;
yâ‚ &#61; zeros&#40;n&#41;; yâ‚‚ &#61; zeros&#40;n&#41;
for k in 1:10
    yâ‚ &#61; Joe.polyfit&#40;x,y-yâ‚‚&#41;
    yâ‚‚ &#61; Joe.local_regression&#40;x,y-yâ‚,Joe.epanechnikov&#41;
end
using Plots
p62_1 &#61; plot&#40;x,yâ‚,label&#61;false,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;&quot;,title&#61;&quot;å¤šé …å¼å›å¸°&#40;3æ¬¡&#41;&quot;&#41;
p62_2 &#61; plot&#40;x,yâ‚‚,label&#61;false,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;&quot;,title&#61;&quot;å±€æ‰€ç·šå½¢å›å¸°&quot;&#41;
p62ã€€&#61; plot&#40;p62_1,p62_2,layout&#61;&#40;1,2&#41;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-12.svg" alt=""> <div class=blank ></div> å¤§ä½“ï¼“æ¬¡å¤šé …å¼ã§å›å¸°ã•ã‚Œã¦ã„ã¦ã€æ®‹ã‚ŠãŒå±€æ‰€ç·šå½¢å›å¸°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ å…ˆã«3æ¬¡å¤šé …å¼ã§å›å¸°ã—ãŸãŸã‚ã§ã—ã‚‡ã†ã‹ã€‚ ç¢ºèªã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Random,Joe
Random.seed&#33;&#40;123&#41;
n&#61;30; x &#61; 2Ï€*rand&#40;n&#41; .- Ï€; sort&#33;&#40;x&#41;; y &#61; sin.&#40;x&#41; .&#43; randn&#40;&#41;
yâ‚ &#61; zeros&#40;n&#41;; yâ‚‚ &#61; zeros&#40;n&#41;
using Plots
for k in 1:10
    yâ‚‚ &#61; Joe.local_regression&#40;x,y-yâ‚,Joe.epanechnikov&#41;
    yâ‚ &#61; Joe.polyfit&#40;x,y-yâ‚‚&#41;
end
p62_3 &#61; plot&#40;x,yâ‚,label&#61;false,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;&quot;,title&#61;&quot;å¤šé …å¼å›å¸°&#40;3æ¬¡&#41;&quot;&#41;
p62_4 &#61; plot&#40;x,yâ‚‚,label&#61;false,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;f&#40;x&#41;&quot;,title&#61;&quot;å±€æ‰€ç·šå½¢å›å¸°&quot;&#41;
p62_5ã€€&#61; plot&#40;p62_3,p62_4,layout&#61;&#40;1,2&#41;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap6/code/output/fig6-12-2.svg" alt=""> <div class=blank ></div> å¤šé …å¼å›å¸°ã®å½±éŸ¿ãŒæ¸›ã£ã¦ã€å±€æ‰€ç·šå½¢å›å¸°ã®æˆåˆ†ãŒå¤§ãããªã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚</p>
  <p style="text-align:right">  ã‚ã§ãŸã—ã‚ã§ãŸã— </p>  <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p>
<div class=page-foot >
  <div class=copyright >
    &copy; Kei Hanafusa. Last modified: August 09, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/Joe.jl/libs/vela/slideout.min.js"></script>
  <script src="/Joe.jl/libs/myBtn/myBtn.js"></script>
  <script src="/Joe.jl/libs/popup/jquery.magnific-popup.min.js"></script>
  <script src="/Joe.jl/libs/popup/mypopup.js"></script>
  
    



  
  
    <script src="/Joe.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>機械学習の数理100問をjuliaでやる </title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>機械学習の数理100問</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">トップ</a> <li><a href="" class=has-arrow >統計的機械学習の数理100問</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">第一章</a> <li><a href="/Joe.jl/StatisticalML/chap2/">第二章</a> <li><a href="/Joe.jl/StatisticalML/chap3/">第三章</a> <li><a href="/Joe.jl/StatisticalML/chap4/">第四章</a> </ul> <li><a href="" class=has-arrow >スパース推定100問</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">リサンプリング</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#クロスバリデーション">クロスバリデーション</a><ol><li><a href="#例39">例39</a></ol></ol></div> <h2 id="クロスバリデーション"><a href="#クロスバリデーション">クロスバリデーション</a></h2> <h3 id="例39"><a href="#例39">例39</a></h3> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Random, Plots
<span class=hljs-keyword >using</span> Joe: cv_linear
n = <span class=hljs-number >100</span>; p = <span class=hljs-number >5</span>
Random.seed!(<span class=hljs-number >1</span>)
X = randn(n, p)
β = randn(p+<span class=hljs-number >1</span>); β[<span class=hljs-number >2</span>:<span class=hljs-number >3</span>] .= <span class=hljs-number >0</span>
y = expand_matrix(X)*β + randn(n)
<span class=hljs-meta >@show</span> cv_linear(X[:,[<span class=hljs-number >3</span>,<span class=hljs-number >4</span>,<span class=hljs-number >5</span>]],y,<span class=hljs-number >10</span>);
<span class=hljs-meta >@show</span> cv_linear(X,y,<span class=hljs-number >10</span>);</code></pre><pre><code class="plaintext hljs">cv_linear(X[:, [3, 4, 5]], y, 10) = 0.7113670647592754
cv_linear(X, y, 10) = 0.6995149878356592
</code></pre> <p>あれ？変数選択した方が誤差でかいぞ？回数を増やしてグラフにしてみよ。</p> <pre><code class="julia hljs">U=<span class=hljs-built_in >Float64</span>[]; V = <span class=hljs-built_in >Float64</span>[]
<span class=hljs-keyword >for</span> _ <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >100</span>
    <span class=hljs-keyword >global</span> U, V, X, β, n
    <span class=hljs-keyword >local</span> y
    y = expand_matrix(X)*β + randn(n)
    push!(U,cv_linear(X[:,[<span class=hljs-number >3</span>,<span class=hljs-number >4</span>,<span class=hljs-number >5</span>]],y,<span class=hljs-number >10</span>))
    push!(V,cv_linear(X,y,<span class=hljs-number >10</span>))
<span class=hljs-keyword >end</span>

p39 = scatter(U,V,xlabel=<span class=hljs-string >&quot;with variable 3,4,5&quot;</span>,ylabel=<span class=hljs-string >&quot;all variable&quot;</span>,title=<span class=hljs-string >&quot;overlearning&quot;</span>)
plot!(p39, x-&gt;x,xlims=(<span class=hljs-number >0.7</span>,<span class=hljs-number >1.5</span>),legend=<span class=hljs-literal >false</span>)</code></pre> <p><img src="/Joe.jl/assets/StatisticalML/chap3/code/output/fig3-1.svg" alt=""> <div class=blank ></div> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y=x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> の直線の上側に大多数の点がプロットされているので、 変数選択をした方が誤差が少ないことが分かりました。</p> <p style="text-align:right"> おしまい </p> <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p> <div class=page-foot > <div class=copyright > &copy; Kei Hanafusa. Last modified: December 27, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </main> <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script> <script src="/Joe.jl/libs/vela/slideout.min.js"></script> <script src="/Joe.jl/libs/myBtn/myBtn.js"></script>
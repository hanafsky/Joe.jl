<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="css/magnific-popup.css" /> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•ã‚’juliaã§ã‚„ã‚‹ </title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">ãƒˆãƒƒãƒ—</a> <li><a href="" class=has-arrow >çµ±è¨ˆçš„æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">ç¬¬ä¸€ç« ã€€ç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap2/">ç¬¬äºŒç« ã€€åˆ†é¡</a> <li><a href="/Joe.jl/StatisticalML/chap3/">ç¬¬ä¸‰ç« ã€€ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</a> <li><a href="/Joe.jl/StatisticalML/chap4/">ç¬¬å››ç« ã€€æƒ…å ±é‡åŸºæº–</a> <li><a href="/Joe.jl/StatisticalML/chap5/">ç¬¬äº”ç« ã€€æ­£å‰‡åŒ–</a> <li><a href="/Joe.jl/StatisticalML/chap6/">ç¬¬å…­ç« ã€€éç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap7/">ç¬¬ä¸ƒç« ã€€æ±ºå®šæœ¨</a> </ul> <li><a href="" class=has-arrow >ã‚¹ãƒ‘ãƒ¼ã‚¹æ¨å®š100å•</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">ç·šå½¢å›å¸°</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#11æœ€å°äºŒä¹—æ³•">1.1æœ€å°äºŒä¹—æ³•</a><ol><li><a href="#ä¾‹19å•3ã«å¯¾å¿œ">ä¾‹19ï¼ˆå•3ã«å¯¾å¿œï¼‰</a></ol><li><a href="#12_é‡å›å¸°">1.2 é‡å›å¸°</a><ol><li><a href="#ä¾‹20">ä¾‹20</a></ol><li><a href="#14_rssã®åˆ†å¸ƒ">1.4 RSSã®åˆ†å¸ƒ</a><ol><li><a href="#ä¾‹21">ä¾‹21</a></ol><li><a href="#15_hatbeta_j_neq_0ã®ä»®èª¬æ¤œå®š">1.5 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>Î²</mi><mo>^</mo></mover><mi>j</mi></msub><mo mathvariant=normal >â‰ </mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\hat{\beta}_j \neq 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2439879999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9578799999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mrel >î€ </span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã®ä»®èª¬æ¤œå®š</a><ol><li><a href="#ä¾‹22">ä¾‹22</a><li><a href="#ä¾‹23">ä¾‹23</a><li><a href="#ä¾‹24å•12ã«å¯¾å¿œ">ä¾‹24&#40;å•12ã«å¯¾å¿œ&#41;</a><li><a href="#ä¾‹25å•13ã«å¯¾å¿œ">ä¾‹25&#40;å•13ã«å¯¾å¿œ&#41;</a></ol><li><a href="#16_æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º">1.6 æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º</a><ol><li><a href="#ä¾‹26">ä¾‹26</a><li><a href="#ä¾‹27">ä¾‹27</a></ol><li><a href="#17_ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“">1.7 ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“</a><ol><li><a href="#ä¾‹28">ä¾‹28</a></ol></ol></div> <h1 id="ç·šå½¢å›å¸°"><a href="#ç·šå½¢å›å¸°" class=header-anchor >ç·šå½¢å›å¸°</a></h1> <h2 id="11æœ€å°äºŒä¹—æ³•"><a href="#11æœ€å°äºŒä¹—æ³•" class=header-anchor >1.1æœ€å°äºŒä¹—æ³•</a></h2> <h3 id="ä¾‹19å•3ã«å¯¾å¿œ"><a href="#ä¾‹19å•3ã«å¯¾å¿œ" class=header-anchor >ä¾‹19ï¼ˆå•3ã«å¯¾å¿œï¼‰</a></h3> <p>å˜å›å¸°åˆ†æã€‚å›å¸°ä¿‚æ•°ã¨åˆ‡ç‰‡ã‚’è¿”ã™é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚ ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰ä½¿ç”¨å¯èƒ½ãªã®ã§æ•°å¼ã¨é–¢æ•°ã¨ã®å¯¾å¿œãŒåˆ†ã‹ã‚Šã‚„ã™ãã§ãã‚‹ã®ãŒjuliaã®ç‰¹é•·ã®ä¸€ã¤ã§ã™ã€‚</p> <div class=note ><div class=title >ğŸ˜² Note</div> <div class=content >meanã‚„normé–¢æ•°ãªã©ã‚’ä½¿ã†ãŸã‚ã€Distributions.jlã¨LinearAlgebra.jlã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãŠãã¾ã™ã€‚</div></div> <hr /> <pre><code class=language-julia >function min_sq&#40;x::Vector&#123;T&#125;,y::Vector&#123;T&#125;&#41; where &#123;T&lt;:Number&#125;
    xÌ„ &#61; mean&#40;x&#41;
    yÌ„ &#61; mean&#40;y&#41;
    Î²â‚ &#61; &#40;x .- xÌ„&#41;&#39;*&#40;y .- yÌ„&#41; / norm&#40;x .- xÌ„&#41;^2 #å‚¾ã
    Î²â‚€ &#61; yÌ„ - Î²â‚ * xÌ„ #åˆ‡ç‰‡
    return  Î²â‚,Î²â‚€
end</code></pre> <p>ã¾ãšã¯ãƒˆã‚¤ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã‹ã‚‰ã€‚</p> <pre><code class=language-julia >using Joe, Random, Distributions, LinearAlgebra
Random.seed&#33;&#40;123&#41; #ä¹±æ•°ã®ç¨®ã‚’å›ºå®š
N &#61; 100
a &#61; rand&#40;Normal&#40;2,1&#41;,N&#41; #å‚¾ãã€å¹³å‡2åˆ†æ•£1ã®æ­£è¦åˆ†å¸ƒã‹ã‚‰ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
b &#61; randn&#40;&#41; #åˆ‡ç‰‡
x &#61; randn&#40;N&#41;
y &#61; a .* x .&#43; b  &#43; randn&#40;N&#41;;</code></pre> <p>æ™®é€šã«å˜å›å¸°ã™ã‚‹å ´åˆã€‚</p> <pre><code class=language-julia >a1, b1 &#61; min_sq&#40;x,y&#41;</code></pre><pre><code class="plaintext code-output">(2.36898664420743, 0.34890217814737906)</code></pre>
<p>ãƒ‡ãƒ¼ã‚¿ã‚’ä¸­å¿ƒåŒ–ã—ãŸã‚ã¨ã«å›å¸°åˆ†æã™ã‚‹ã¨åˆ‡ç‰‡ãŒï¼ã«ãªã‚‹ï¼ˆã‚ãŸã‚Šã¾ãˆï¼‰ã€‚</p>
<pre><code class=language-julia >xx &#61; x .- mean&#40;x&#41;; yy &#61; y .- mean&#40;y&#41;
a2,b2 &#61; min_sq&#40;xx,yy&#41;</code></pre><pre><code class="plaintext code-output">(2.36898664420743, 2.8132563058077054e-17)</code></pre>
<p>å›³1.2ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã‚‹ã€‚matplotlibã«æ¯”ã¹ã¦ã‚³ãƒ¼ãƒ‰ãŒçŸ­ã„ã®ãŒã„ã„ã§ã™ã­ã€‚ juliaã‚’æ‰±ã†æœ¬ã¯ã“ã‚Œã‹ã‚‰ã©ã‚“ã©ã‚“å¢—ãˆã¦ãã‚‹ã¨æ€ã„ã¾ã™ãŒã€pythonã§æ›¸ã„ãŸæœ¬ã‚ˆã‚Šã‚‚ã‹ãªã‚Šç´™é¢ ã‚’ç¯€ç´„ã§ãã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’æ‰±ã†ãŸã‚ã®è¨­å®šã¯<a href="https://gist.github.com/genkuroki/6c2b71f62504432bdf8a27d24106cad8">GenKurokiã•ã‚“ã®ã‚³ãƒ¼ãƒ‰</a>ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚ ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¨ãªãœã‹xlabelã¨ylabelãŒåˆ‡ã‚Œã¦ã—ã¾ã†ã®ã§ã€ä½™ç™½ã®èª¿æ•´ã‚‚ã—ã¦ã„ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Plots; gr&#40;&#41;
using Plots.PlotMeasures
Plots.reset_defaults&#40;&#41;
default&#40;
    titlefont  &#61; font&#40;&quot;JuliaMono&quot;, default&#40;:titlefontsize&#41;,  &#41;,
    guidefont  &#61; font&#40;&quot;JuliaMono&quot;,  default&#40;:guidefontsize&#41;,  &#41;,
    tickfont   &#61; font&#40;&quot;JuliaMono&quot;, default&#40;:tickfontsize&#41;,   &#41;,
    legendfont &#61; font&#40;&quot;JuliaMono&quot;,  default&#40;:legendfontsize&#41;, &#41;,
    left_margin &#61; 30px,
    bottom_margin &#61; 30px,
&#41;
p12 &#61; scatter&#40;x,y,label&#61;&quot;original&quot;,legend&#61;:topleft,xlabel&#61;&quot;x&quot;, ylabel&#61;&quot;y&quot;&#41;
plot&#33;&#40;c-&gt;a1*c&#43;b1 ,label&#61;&quot;before centering&quot;&#41;
plot&#33;&#40;c-&gt;a2*c&#43;b2 , label&#61;&quot;after centering&quot;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-2.svg" alt="">
<h2 id="12_é‡å›å¸°"><a href="#12_é‡å›å¸°" class=header-anchor >1.2 é‡å›å¸°</a></h2>
<h3 id="ä¾‹20"><a href="#ä¾‹20" class=header-anchor >ä¾‹20</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>Î²</mi><mo>^</mo></mover><mo>=</mo><mo stretchy=false >(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">\hat{\beta} = (X^T X)^{-1} X^Ty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9578799999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> ã‚’è§£ãã ã‘ãªã®ã§ã€ã‚‚ã¯ã‚„é–¢æ•°åŒ–ã™ã‚‹ç¨‹ã§ã‚‚ãªã„ãŒã€ å¾Œã€…ã®ã“ã¨ã‚’è€ƒãˆã¦ã€é–¢æ•°åŒ–ã—ã¾ã™ã€‚ ã¾ãŸã€ä¿‚æ•°è¡Œåˆ—ã«å®šæ•°é …ã®ãŸã‚ã«å…¨ã¦ã®è¦ç´ ãŒ1ã®åˆ—ã‚’1åˆ—ç›®ã«æŒ¿å…¥ã—ã¾ã™ãŒã€ ã‚ã–ã‚ã–numpyã‚’importã—ã¦np.insert&#40;x,0,1,axis&#61;1&#41;ã‚’å‘¼ã³å‡ºã™ã®ãŒå«Œãªã®ã§ã€ ä»¥ä¸‹ã®ã‚ˆã†ãªé–¢æ•°ã‚’å®šç¾©ã—ã¾ã—ãŸã€‚&#40;ã“ã®è¡Œåˆ—ã€ä½•ã‹ã„ã„åå‰ãŒã‚ã‚‹ã¨ã„ã„ã®ã§ã™ãŒã€‚&#41;</p>
<pre><code class=language-julia >function insert_ones&#40;X&#41;
    N &#61; typeof&#40;X&#41; &lt;: Matrix  ?  size&#40;X&#41;&#91;1&#93; :  length&#40;X&#41;
    T &#61; eltype&#40;X&#41;
    return hcat&#40;ones&#40;T,N&#41;,X&#41;
end</code></pre>
<p>ã¾ãŸã€é‡å›å¸°ä¿‚æ•°ã‚’æœ€å°äºŒä¹—æ³•ã§æ±‚ã‚ã‚‹é–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >function multiple_regression&#40;x::Matrix&#123;T&#125;, y::Vector&#123;T&#125;&#41; where &#123;T&lt;:Number&#125;
    N,_ &#61; size&#40;x&#41;
    @assert N&#61;&#61;length&#40;y&#41;
    X &#61; insert_ones&#40;x&#41;
    return &#40;X&#39;X&#41;\X&#39;y
end</code></pre>
<h2 id="14_rssã®åˆ†å¸ƒ"><a href="#14_rssã®åˆ†å¸ƒ" class=header-anchor >1.4 RSSã®åˆ†å¸ƒ</a></h2>
<h3 id="ä¾‹21"><a href="#ä¾‹21" class=header-anchor >ä¾‹21</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ï‡</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.008548em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">Ï‡</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>åˆ†å¸ƒã®ãƒ—ãƒ­ãƒƒãƒˆã€‚åŸè‘—ã®ãƒ—ãƒ­ãƒƒãƒˆï¼ˆå›³1.3ï¼‰ã¯é–“é•ã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ Plots.jlã¯ç„¡åé–¢æ•°ã®ãƒ—ãƒ­ãƒƒãƒˆãŒã§ãã‚‹ã®ã§ä¾¿åˆ©ã€‚</p>
<pre><code class=language-julia >p13 &#61; plot&#40;xlims&#61;&#40;0,8&#41;,ylims&#61;&#40;0,1&#41;,title&#61;&quot;DOF of chi&quot;,legend&#61;:topright&#41;
for i in 1:10
    plot&#33;&#40;p13,0.1:0.1:8,x-&gt;pdf&#40;Chisq&#40;i&#41;,x&#41;,label&#61;&quot;dof &#61; &#36;&#40;i&#41;&quot;&#41;
end</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-3.svg" alt="">
<h2 id="15_hatbeta_j_neq_0ã®ä»®èª¬æ¤œå®š"><a href="#15_hatbeta_j_neq_0ã®ä»®èª¬æ¤œå®š" class=header-anchor >1.5 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>Î²</mi><mo>^</mo></mover><mi>j</mi></msub><mo mathvariant=normal >â‰ </mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\hat{\beta}_j \neq 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2439879999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9578799999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mrel >î€ </span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã®ä»®èª¬æ¤œå®š</a></h2>
<h3 id="ä¾‹22"><a href="#ä¾‹22" class=header-anchor >ä¾‹22</a></h3>
<p>tåˆ†å¸ƒã®ãƒ—ãƒ­ãƒƒãƒˆ</p>
<pre><code class=language-julia >p15 &#61; plot&#40;x-&gt;pdf&#40;Normal&#40;0,1&#41;,x&#41;,label&#61;&quot;æ­£è¦åˆ†å¸ƒ&quot;&#41;
for i in 1:10
    plot&#33;&#40;x-&gt;pdf&#40;TDist&#40;i&#41;,x&#41;, ls&#61;:dash, label&#61;&quot;dof: &#36;&#40;i&#41;&quot;&#41;
end</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-5.svg" alt="">
<h3 id="ä¾‹23"><a href="#ä¾‹23" class=header-anchor >ä¾‹23</a></h3>
<pre><code class=language-julia >N&#61;100;iter_num&#61;100;
data23 &#61; Matrix&#40;undef,iter_num,2&#41;
for i in 1:iter_num
    x23&#61;randn&#40;N&#41;  .&#43;2
    y23&#61; x23 .&#43; 1 &#43;  randn&#40;N&#41;
    data23&#91;i,:&#93; &#61; min_sq&#40;x23,y23&#41; |&gt; collect
end
p14 &#61; scatter&#40;data23&#91;:,2&#93;,data23&#91;:,1&#93;,xlabel&#61;&quot;Î²â‚€&quot;,ylabel&#61;&quot;Î²â‚&quot;,title&#61;&quot;test&quot;,legend&#61;false&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-4.svg" alt="">
<h3 id="ä¾‹24å•12ã«å¯¾å¿œ"><a href="#ä¾‹24å•12ã«å¯¾å¿œ" class=header-anchor >ä¾‹24&#40;å•12ã«å¯¾å¿œ&#41;</a></h3>
<p>å¾Œã€…ã®ã“ã¨ã‚’è€ƒãˆã¦ã€RSSã‚„Rï¼’ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class=language-julia >function RSS&#40;x::Vector,y&#41;
    Î²Ì‚ &#61; min_sq&#40;x,y&#41;
    yÌ‚ &#61; Î²Ì‚&#91;1&#93;*x .&#43; Î²Ì‚&#91;2&#93;
    return &#40;y-yÌ‚&#41;&#39;*&#40;y-yÌ‚&#41;
end
function RSS&#40;x,y&#41;
    yÌ‚ &#61; insert_ones&#40;x&#41;*multiple_regression&#40;x,y&#41;
    return &#40;y-yÌ‚&#41;&#39;*&#40;y-yÌ‚&#41;
end


function RSE&#40;x::Matrix,y&#41;
    n,p &#61; size&#40;x&#41;
    RSS&#40;x,y&#41; / &#40;n-p-1&#41; |&gt; sqrt
end

function RSE&#40;x::Vector,y&#41;
    RSS&#40;x,y&#41; / &#40;length&#40;x&#41;-2&#41; |&gt; sqrt
end

function Bdiag&#40;x&#41;
    X &#61; insert_ones&#40;x&#41;
    return X&#39;X |&gt; inv |&gt; diag
end</code></pre>
<pre><code class=language-julia >using Joe, Statistics
N &#61; 100;Random.seed&#33;&#40;123&#41;
x24 &#61; randn&#40;N&#41;; y24&#61;randn&#40;N&#41;;
Î²â‚, Î²â‚€ &#61; min_sq&#40;x24,y24&#41;
rse &#61; Joe.RSE&#40;x24,y24&#41;
seâ‚€, seâ‚ &#61; rse*sqrt.&#40;Joe.Bdiag&#40;x24&#41;&#41;
tâ‚€ &#61; Î²â‚€ / seâ‚€
tâ‚ &#61; Î²â‚ / seâ‚
pâ‚€ &#61; 2*&#40;ccdf&#40;TDist&#40;N-2&#41;,abs&#40;tâ‚€&#41;&#41;&#41;
pâ‚ &#61; 2*&#40;ccdf&#40;TDist&#40;N-2&#41;,abs&#40;tâ‚&#41;&#41;&#41;
@show Î²â‚€, Î²â‚;
@show tâ‚€, tâ‚;
@show pâ‚€, pâ‚;</code></pre><pre><code class="plaintext code-output">(Î²â‚€, Î²â‚) = (0.10898230758144681, -0.05761023247512567)
(tâ‚€, tâ‚) = (1.0893138251707204, -0.6469066946933425)
(pâ‚€, pâ‚) = (0.27868694362737306, 0.5192046691957626)
</code></pre>
<p>GLM.jlã‚’ä½¿ã£ãŸå ´åˆã§ã‚‚åŒã˜å€¤ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<pre><code class=language-julia >using GLM, DataFrames
data &#61; DataFrame&#40;X&#61;x24,Y&#61;y24&#41;
ols &#61; lm&#40;@formula&#40;Y ~ X&#41;, data&#41;</code></pre><pre><code class="plaintext code-output">StatsModels.TableRegressionModel{GLM.LinearModel{GLM.LmResp{Vector{Float64}}, GLM.DensePredChol{Float64, LinearAlgebra.CholeskyPivoted{Float64, Matrix{Float64}}}}, Matrix{Float64}}

Y ~ 1 + X

Coefficients:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                  Coef.  Std. Error      t  Pr(>|t|)   Lower 95%  Upper 95%
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(Intercept)   0.108982    0.10005     1.09    0.2787  -0.0895638   0.307528
X            -0.0576102   0.0890579  -0.65    0.5192  -0.234343    0.119122
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</code></pre>
<h3 id="ä¾‹25å•13ã«å¯¾å¿œ"><a href="#ä¾‹25å•13ã«å¯¾å¿œ" class=header-anchor >ä¾‹25&#40;å•13ã«å¯¾å¿œ&#41;</a></h3>
<p>Î²Ì‚â‚/SE&#40;Î²â‚&#41;ã‚’ç¹°ã‚Šè¿”ã—æ¨å®šã—ã¦ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’ä½œã‚Šã¾ã™ã€‚ è‡ªç”±åº¦N-2ã®tåˆ†å¸ƒã«ã‚ˆãä¸€è‡´ã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<pre><code class=language-julia >t25 &#61; Vector&#123;Real&#125;&#40;undef,1000&#41;
for i in 1:1000
    x25 &#61; randn&#40;N&#41;; y25 &#61; randn&#40;N&#41;
    t25&#91;i&#93;,_ &#61; collect&#40;min_sq&#40;x25,y25&#41;&#41; / Joe.RSE&#40;x25,y25&#41; ./ sqrt.&#40;Joe.Bdiag&#40;x25&#41;&#41;
end
p25_1 &#61; histogram&#40;t25,xlims&#61;&#40;-3,3&#41;,bins&#61;20,normalize&#61;true,xlabel&#61;&quot;tã®å€¤&quot;,legend&#61;false&#41;
title&#33;&#40;&quot;å¸°ç„¡ä»®èª¬ãŒæˆç«‹ã™ã‚‹å ´åˆ&quot;&#41;
plot&#33;&#40;p25_1,x-&gt;pdf&#40;TDist&#40;98&#41;,x&#41;&#41;;</code></pre>
<p>åŒã˜ã“ã¨ã‚’y&#61;0.1x&#43;Ïµã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >t25_ &#61; Vector&#123;Real&#125;&#40;undef,1000&#41;
for i in 1:1000
    x25 &#61; randn&#40;N&#41;; y25 &#61; 0.1*x25 .&#43; randn&#40;N&#41;
    t25_&#91;i&#93;,_ &#61; collect&#40;min_sq&#40;x25,y25&#41;&#41; / Joe.RSE&#40;x25,y25&#41; ./ sqrt.&#40;Joe.Bdiag&#40;x25&#41;&#41;
end
p25_2 &#61; histogram&#40;t25_,xlims&#61;&#40;-3,3&#41;,bins&#61;20,normalize&#61;true, xlabel&#61;&quot;tã®å€¤&quot;,legend&#61;false&#41;
title&#33;&#40;&quot;å¸°ç„¡ä»®èª¬ãŒæˆç«‹ã—ãªã„å ´åˆ&quot;&#41;
plot&#33;&#40;p25_2,x-&gt;pdf&#40;TDist&#40;98&#41;,x&#41;&#41;
p25 &#61; plot&#40;p25_1,p25_2&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-6.svg" alt="">
<h2 id="16_æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º"><a href="#16_æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º" class=header-anchor >1.6 æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º</a></h2>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow><mrow><mi>T</mi><mi>S</mi><mi>S</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>E</mi><mi>S</mi><mi>S</mi></mrow><mrow><mi>T</mi><mi>S</mi><mi>S</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">R^2 = 1 - \dfrac{RSS}{TSS} = \dfrac{ESS}{TSS}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã«ã—ãŸãŒã£ã¦ã€æ¬¡ã®é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class=language-julia >function TSS&#40;y&#41;
    Y &#61; y .- mean&#40;y&#41;
    return Y&#39;*Y
end

ESS&#40;x,y&#41; &#61; TSS&#40;y&#41; - RSS&#40;x,y&#41;

R2&#40;x,y&#41; &#61; ESS&#40;x,y&#41;/TSS&#40;y&#41;</code></pre>
<h3 id="ä¾‹26"><a href="#ä¾‹26" class=header-anchor >ä¾‹26</a></h3>
<p>æ±ºå®šä¿‚æ•°ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >N &#61; 100; Random.seed&#33;&#40;123&#41;
x26_2 &#61; randn&#40;N,2&#41;; x26_1 &#61; randn&#40;N&#41;
y26 &#61; randn&#40;N&#41;
@show Joe.R2&#40;x26_2,y26&#41;;</code></pre><pre><code class="plaintext code-output">Joe.R2(x26_2, y26) = 0.0021037427008463584
</code></pre>
<p>ã¾ãŸã€1å¤‰é‡ãªã‚‰ç›¸é–¢ä¿‚æ•°ã®äºŒä¹—ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >@show Joe.R2&#40;x26_1,y26&#41;;
@show cor&#40;x26_1,y26&#41;^2 ; # Statistics.jl</code></pre><pre><code class="plaintext code-output">Joe.R2(x26_1, y26) = 0.02246508247965494
cor(x26_1, y26) ^ 2 = 0.02246508247965464
</code></pre>
<h3 id="ä¾‹27"><a href="#ä¾‹27" class=header-anchor >ä¾‹27</a></h3>
<p>VIFã®è¨ˆç®—ã¯æ—¢å­˜ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ãªã•ãã†ã§ã™ã€‚</p>
<pre><code class=language-julia >function VIF&#40;x&#41;
    _,ncol&#61; size&#40;x&#41;
    v &#61; Vector&#123;Float64&#125;&#40;undef, ncol&#41;
    for j in 1:ncol
        index &#61; setdiff&#40;1:ncol,j&#41;
        v&#91;j&#93; &#61; 1/&#40;1-R2&#40;x&#91;:,index&#93;,x&#91;:,j&#93;&#41;&#41;
    end
    return v
end</code></pre>
<pre><code class=language-julia >using Joe, RDatasets,DataFrames
using Chain
df &#61; dataset&#40;&quot;MASS&quot;,&quot;BOSTON&quot;&#41;
x27 &#61; @chain df select&#40;_,Not&#40;:MedV&#41;&#41; Array #df&#91;Not&#40;:MedV&#41;&#93;ãŒFranklinã§å‹•ã‹ã‚“ã€‚
#TabularDisplayã‚’ä½¿ã£ã¦ç¶ºéº—ã«è¡¨ç¤ºã™ã‚‹ã€‚
using TabularDisplay, Formatting
foo &#61; generate_formatter&#40;&quot;&#37;7.5f&quot;&#41;
displaytable&#40;Joe.VIF&#40;x27&#41;;index&#61;true,indexsep&#61;&quot; -&gt; &quot;,formatter&#61;foo&#41;</code></pre><pre><code class="plaintext code-output">Failed to precompile RDatasets [ce6b1742-4840-55fa-b093-852dadbb1d8b] to /home/runner/.julia/compiled/v1.6/RDatasets/jl_wOl9gm.
</code></pre>
<h2 id="17_ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“"><a href="#17_ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“" class=header-anchor >1.7 ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“</a></h2>
<p>å®šç¾©ã«ã—ãŸãŒã£ã¦ã€ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“ã®å®šç¾©ã‚’ã—ã¾ã™ã€‚å±é™ºç‡ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯0.01ã¨ã—ã¦ã„ã¾ã™ã€‚ &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mo lspace=0em  rspace=0em >â‹†</mo></msub><mo stretchy=false >(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msubsup><mi>x</mi><mo lspace=0em  rspace=0em >â‹†</mo><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">x_{\star}(X^TX)^{-1}x_{\star}^T</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.175696em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â‹†</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â‹†</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ã®è¨ˆç®—ã«æ¨ªç€ã—ã¦diagã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€ã¡ã‚‡ã£ã¨å‹¿ä½“ãªã„ãƒªã‚½ãƒ¼ã‚¹ã®ä½¿ã„æ–¹ã‚’ã—ã¦ã„ã‚‹ã€‚&#41;</p>
<pre><code class=language-julia >function confident_interval&#40;xp,x,y;Î±&#61;0.01&#41;
    N,p &#61; size&#40;x&#41;
    X &#61; insert_ones&#40;x&#41;
    XP &#61; insert_ones&#40;xp&#41;
    typeof&#40;xp&#41; &lt;:Number &amp;&amp; &#40;xp &#61;&#91;xp&#93;&#41;
    yerror &#61; quantile&#40;TDist&#40;N-p-1&#41;,1-Î±/2&#41; * sqrt.&#40;diag&#40;XP * &#40;&#40;X&#39;X&#41; \ XP&#39;&#41;&#41;&#41;
end

function prediction_interval&#40;xp,x,y;Î±&#61;0.01&#41;
    N,p &#61; size&#40;x&#41;
    X &#61; insert_ones&#40;x&#41;
    XP &#61; insert_ones&#40;xp&#41;
    typeof&#40;xp&#41; &lt;:Number &amp;&amp; &#40;xp &#61;&#91;xp&#93;&#41;
    yerror &#61; quantile&#40;TDist&#40;N-p-1&#41;,1-Î±/2&#41; * sqrt.&#40; 1 .&#43; diag&#40;XP * &#40;&#40;X&#39;X&#41; \ XP&#39;&#41;&#41;&#41;
end</code></pre>
<h3 id="ä¾‹28"><a href="#ä¾‹28" class=header-anchor >ä¾‹28</a></h3>
<pre><code class=language-julia >using Plots, Random, Joe
N &#61; 100; Random.seed&#33;&#40;123&#41;
x28 &#61; randn&#40;N,1&#41;
y28 &#61; x28 .&#43;1 &#43; randn&#40;N&#41;  |&gt; vec # çœŸã®åˆ‡ç‰‡ã¨å‚¾ãã¯ã¨ã‚‚ã«1
p28 &#61; scatter&#40;x28,y28,xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;y&quot;,
                label&#61;&quot;data     &quot;,legend&#61;:topleft&#41;
Î²28 &#61; multiple_regression&#40;x28,y28&#41;
x_seq &#61; -10:0.1:10
yÌ‚ &#61; insert_ones&#40;x_seq&#41; * Î²28
yerror1 &#61; Joe.confident_interval&#40;x_seq,x28,y28&#41;
yerror2 &#61; Joe.prediction_interval&#40;x_seq,x28,y28&#41;
plot&#33;&#40;p28,x_seq,yÌ‚,ribbon&#61;yerror2, label&#61;&quot;äºˆæ¸¬åŒºé–“&quot;&#41;
plot&#33;&#40;p28,x_seq,yÌ‚,ribbon&#61;yerror1, label&#61;&quot;ä¿¡é ¼åŒºé–“&quot;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-7.svg" alt="">
  <p style="text-align:right">  ã‚ã§ãŸã—ã‚ã§ãŸã— </p>  <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p>
<div class=page-foot >
  <div class=copyright >
    &copy; Kei Hanafusa. Last modified: August 08, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/Joe.jl/libs/vela/slideout.min.js"></script>
  <script src="/Joe.jl/libs/myBtn/myBtn.js"></script>
  <script src="/Joe.jl/libs/popup/jquery.magnific-popup.min.js"></script>
  <script src="/Joe.jl/libs/popup/mypopup.js"></script>
  
    



  
  
    <script src="/Joe.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
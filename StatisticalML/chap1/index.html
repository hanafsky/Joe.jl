<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•ã‚’juliaã§ã‚„ã‚‹ </title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">ãƒˆãƒƒãƒ—</a> <li><a href="" class=has-arrow >çµ±è¨ˆçš„æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">ç¬¬ä¸€ç« </a> <li><a href="/Joe.jl/StatisticalML/chap2/">ç¬¬äºŒç« </a> <li><a href="/Joe.jl/StatisticalML/chap3/">ç¬¬ä¸‰ç« </a> <li><a href="/Joe.jl/StatisticalML/chap4/">ç¬¬å››ç« </a> </ul> <li><a href="" class=has-arrow >ã‚¹ãƒ‘ãƒ¼ã‚¹æ¨å®š100å•</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">ç·šå½¢å›å¸°</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#11æœ€å°äºŒä¹—æ³•">1.1æœ€å°äºŒä¹—æ³•</a><ol><li><a href="#ä¾‹19å•3ã«å¯¾å¿œ">ä¾‹19ï¼ˆå•3ã«å¯¾å¿œï¼‰</a></ol><li><a href="#12_é‡å›å¸°">1.2 é‡å›å¸°</a><ol><li><a href="#ä¾‹20">ä¾‹20</a></ol><li><a href="#14_rssã®åˆ†å¸ƒ">1.4 RSSã®åˆ†å¸ƒ</a><ol><li><a href="#ä¾‹21">ä¾‹21</a></ol><li><a href="#15_hatbeta_j_neq_0ã®ä»®èª¬æ¤œå®š">1.5 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>Î²</mi><mo>^</mo></mover><mi>j</mi></msub><mo mathvariant=normal >â‰ </mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\hat{\beta}_j \neq 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2439879999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9578799999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mrel >î€ </span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã®ä»®èª¬æ¤œå®š</a><ol><li><a href="#ä¾‹22">ä¾‹22</a><li><a href="#ä¾‹23">ä¾‹23</a><li><a href="#ä¾‹24å•12ã«å¯¾å¿œ">ä¾‹24&#40;å•12ã«å¯¾å¿œ&#41;</a><li><a href="#ä¾‹25å•13ã«å¯¾å¿œ">ä¾‹25&#40;å•13ã«å¯¾å¿œ&#41;</a></ol><li><a href="#16_æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º">1.6 æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º</a><ol><li><a href="#ä¾‹26">ä¾‹26</a><li><a href="#ä¾‹27">ä¾‹27</a></ol><li><a href="#17_ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“">1.7 ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“</a><ol><li><a href="#ä¾‹28">ä¾‹28</a></ol></ol></div> <h1 id="ç·šå½¢å›å¸°"><a href="#ç·šå½¢å›å¸°">ç·šå½¢å›å¸°</a></h1> <h2 id="11æœ€å°äºŒä¹—æ³•"><a href="#11æœ€å°äºŒä¹—æ³•">1.1æœ€å°äºŒä¹—æ³•</a></h2> <h3 id="ä¾‹19å•3ã«å¯¾å¿œ"><a href="#ä¾‹19å•3ã«å¯¾å¿œ">ä¾‹19ï¼ˆå•3ã«å¯¾å¿œï¼‰</a></h3> <p>å˜å›å¸°åˆ†æã€‚å›å¸°ä¿‚æ•°ã¨åˆ‡ç‰‡ã‚’è¿”ã™é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚ ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰ä½¿ç”¨å¯èƒ½ãªã®ã§æ•°å¼ã¨é–¢æ•°ã¨ã®å¯¾å¿œãŒåˆ†ã‹ã‚Šã‚„ã™ãã§ãã‚‹ã®ãŒjuliaã®ç‰¹é•·ã®ä¸€ã¤ã§ã™ã€‚</p> <div class=note ><div class=title >ğŸ˜² Note</div> <div class=content >meanã‚„normé–¢æ•°ãªã©ã‚’ä½¿ã†ãŸã‚ã€Distributions.jlã¨LinearAlgebra.jlã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãŠãã¾ã™ã€‚</div></div> <hr /> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> min_sq(x::<span class=hljs-built_in >Vector</span>{T},y::<span class=hljs-built_in >Vector</span>{T}) <span class=hljs-keyword >where</span> {T&lt;:<span class=hljs-built_in >Number</span>}
    xÌ„ = mean(x)
    yÌ„ = mean(y)
    Î²â‚ = (x .- xÌ„)&#x27;*(y .- yÌ„) / norm(x .- xÌ„)^<span class=hljs-number >2</span> <span class=hljs-comment >#å‚¾ã</span>
    Î²â‚€ = yÌ„ - Î²â‚ * xÌ„ <span class=hljs-comment >#åˆ‡ç‰‡</span>
    <span class=hljs-keyword >return</span>  Î²â‚,Î²â‚€
<span class=hljs-keyword >end</span></code></pre> <p>ã¾ãšã¯ãƒˆã‚¤ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã‹ã‚‰ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Random, Distributions, LinearAlgebra
Random.seed!(<span class=hljs-number >123</span>) <span class=hljs-comment >#ä¹±æ•°ã®ç¨®ã‚’å›ºå®š</span>
N = <span class=hljs-number >100</span>
a = rand(Normal(<span class=hljs-number >2</span>,<span class=hljs-number >1</span>),N) <span class=hljs-comment >#å‚¾ãã€å¹³å‡2åˆ†æ•£1ã®æ­£è¦åˆ†å¸ƒã‹ã‚‰ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</span>
b = randn() <span class=hljs-comment >#åˆ‡ç‰‡</span>
x = randn(N)
y = a .* x .+ b  + randn(N);</code></pre> <p>æ™®é€šã«å˜å›å¸°ã™ã‚‹å ´åˆã€‚</p> <pre><code class="julia hljs">a1, b1 = min_sq(x,y)</code></pre><pre><code class="plaintext hljs">(2.36898664420743, 0.34890217814737906)</code></pre>
<p>ãƒ‡ãƒ¼ã‚¿ã‚’ä¸­å¿ƒåŒ–ã—ãŸã‚ã¨ã«å›å¸°åˆ†æã™ã‚‹ã¨åˆ‡ç‰‡ãŒï¼ã«ãªã‚‹ï¼ˆã‚ãŸã‚Šã¾ãˆï¼‰ã€‚</p>
<pre><code class="julia hljs">xx = x .- mean(x); yy = y .- mean(y)
a2,b2 = min_sq(xx,yy)</code></pre><pre><code class="plaintext hljs">(2.36898664420743, 2.8132563058077054e-17)</code></pre>
<p>å›³1.2ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã‚‹ã€‚matplotlibã«æ¯”ã¹ã¦ã‚³ãƒ¼ãƒ‰ãŒçŸ­ã„ã®ãŒã„ã„ã§ã™ã­ã€‚ juliaã‚’æ‰±ã†æœ¬ã¯ã“ã‚Œã‹ã‚‰ã©ã‚“ã©ã‚“å¢—ãˆã¦ãã‚‹ã¨æ€ã„ã¾ã™ãŒã€pythonã§æ›¸ã„ãŸæœ¬ã‚ˆã‚Šã‚‚ã‹ãªã‚Šç´™é¢ ã‚’ç¯€ç´„ã§ãã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ æ—¥æœ¬èªæ‰±ã†ãŸã‚ã®è¨­å®šã¯<a href="https://gist.github.com/genkuroki/6c2b71f62504432bdf8a27d24106cad8">GenKurokiã•ã‚“ã®ã‚³ãƒ¼ãƒ‰</a>ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Plots; gr()
Plots.reset_defaults()
default(
    titlefont  = font(<span class=hljs-string >&quot;JuliaMono&quot;</span>, default(:titlefontsize),  ),
    guidefont  = font(<span class=hljs-string >&quot;JuliaMono&quot;</span>,  default(:guidefontsize),  ),
    tickfont   = font(<span class=hljs-string >&quot;JuliaMono&quot;</span>, default(:tickfontsize),   ),
    legendfont = font(<span class=hljs-string >&quot;JuliaMono&quot;</span>,  default(:legendfontsize), )
)
p12 = scatter(x,y,label=<span class=hljs-string >&quot;original&quot;</span>,legend=:topleft,xlabel=<span class=hljs-string >&quot;x&quot;</span>, ylabel=<span class=hljs-string >&quot;y&quot;</span>)
plot!(c-&gt;a1*c+b1 ,label=<span class=hljs-string >&quot;before centering&quot;</span>)
plot!(c-&gt;a2*c+b2 , label=<span class=hljs-string >&quot;after centering&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-2.svg" alt="">
<h2 id="12_é‡å›å¸°"><a href="#12_é‡å›å¸°">1.2 é‡å›å¸°</a></h2>
<h3 id="ä¾‹20"><a href="#ä¾‹20">ä¾‹20</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>Î²</mi><mo>^</mo></mover><mo>=</mo><mo stretchy=false >(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">\hat{\beta} = (X^T X)^{-1} X^Ty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9578799999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> ã‚’è§£ãã ã‘ãªã®ã§ã€ã‚‚ã¯ã‚„é–¢æ•°åŒ–ã™ã‚‹ç¨‹ã§ã‚‚ãªã„ãŒã€ å¾Œã€…ã®ã“ã¨ã‚’è€ƒãˆã¦ã€é–¢æ•°åŒ–ã—ã¾ã™ã€‚ ã¾ãŸã€ä¿‚æ•°è¡Œåˆ—ã«å®šæ•°é …ã®ãŸã‚ã«å…¨ã¦ã®è¦ç´ ãŒ1ã®åˆ—ã‚’1åˆ—ç›®ã«æŒ¿å…¥ã—ã¾ã™ãŒã€ ã‚ã–ã‚ã–numpyã‚’importã—ã¦np.insert&#40;x,0,1,axis&#61;1&#41;ã‚’å‘¼ã³å‡ºã™ã®ãŒå«Œãªã®ã§ã€ ä»¥ä¸‹ã®ã‚ˆã†ãªé–¢æ•°ã‚’å®šç¾©ã—ã¾ã—ãŸã€‚&#40;ã“ã®è¡Œåˆ—ã€ä½•ã‹ã„ã„åå‰ãŒã‚ã‚‹ã¨ã„ã„ã®ã§ã™ãŒã€‚&#41;</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> expand_matrix(X)
    N = typeof(X) &lt;: <span class=hljs-built_in >Matrix</span>  ?  size(X)[<span class=hljs-number >1</span>] :  length(X)
    T = eltype(X)
    <span class=hljs-keyword >return</span> hcat(ones(T,N),X)
<span class=hljs-keyword >end</span></code></pre>
<p>ã¾ãŸã€é‡å›å¸°ä¿‚æ•°ã‚’æœ€å°äºŒä¹—æ³•ã§æ±‚ã‚ã‚‹é–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã—ãŸã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> MultipleRegression(x::<span class=hljs-built_in >Matrix</span>{T}, y::<span class=hljs-built_in >Vector</span>{T}) <span class=hljs-keyword >where</span> {T&lt;:<span class=hljs-built_in >Number</span>}
    N,_ = size(x)
    <span class=hljs-meta >@assert</span> N==length(y)
    X = expand_matrix(x)
    <span class=hljs-keyword >return</span> (X&#x27;X)\X&#x27;y
<span class=hljs-keyword >end</span></code></pre>
<h2 id="14_rssã®åˆ†å¸ƒ"><a href="#14_rssã®åˆ†å¸ƒ">1.4 RSSã®åˆ†å¸ƒ</a></h2>
<h3 id="ä¾‹21"><a href="#ä¾‹21">ä¾‹21</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ï‡</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.008548em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">Ï‡</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>åˆ†å¸ƒã®ãƒ—ãƒ­ãƒƒãƒˆã€‚åŸè‘—ã®ãƒ—ãƒ­ãƒƒãƒˆï¼ˆå›³1.3ï¼‰ã¯é–“é•ã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ Plots.jlã¯ç„¡åé–¢æ•°ã®ãƒ—ãƒ­ãƒƒãƒˆãŒã§ãã‚‹ã®ã§ä¾¿åˆ©ã€‚</p>
<pre><code class="julia hljs">p13 = plot(xlims=(<span class=hljs-number >0</span>,<span class=hljs-number >8</span>),ylims=(<span class=hljs-number >0</span>,<span class=hljs-number >1</span>),title=<span class=hljs-string >&quot;DOF of chi&quot;</span>,legend=:topright)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    plot!(p13,<span class=hljs-number >0.1</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >8</span>,x-&gt;pdf(Chisq(i),x),label=<span class=hljs-string >&quot;dof = <span class=hljs-subst >$(i)</span>&quot;</span>)
<span class=hljs-keyword >end</span></code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-3.svg" alt="">
<h2 id="15_hatbeta_j_neq_0ã®ä»®èª¬æ¤œå®š"><a href="#15_hatbeta_j_neq_0ã®ä»®èª¬æ¤œå®š">1.5 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>Î²</mi><mo>^</mo></mover><mi>j</mi></msub><mo mathvariant=normal >â‰ </mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\hat{\beta}_j \neq 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2439879999999999em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9578799999999998em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mrel >î€ </span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã®ä»®èª¬æ¤œå®š</a></h2>
<h3 id="ä¾‹22"><a href="#ä¾‹22">ä¾‹22</a></h3>
<p>tåˆ†å¸ƒã®ãƒ—ãƒ­ãƒƒãƒˆ</p>
<pre><code class="julia hljs">p15 = plot(x-&gt;pdf(Normal(<span class=hljs-number >0</span>,<span class=hljs-number >1</span>),x),label=<span class=hljs-string >&quot;æ­£è¦åˆ†å¸ƒ&quot;</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    plot!(x-&gt;pdf(TDist(i),x), ls=:dash, label=<span class=hljs-string >&quot;dof: <span class=hljs-subst >$(i)</span>&quot;</span>)
<span class=hljs-keyword >end</span></code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-5.svg" alt="">
<h3 id="ä¾‹23"><a href="#ä¾‹23">ä¾‹23</a></h3>
<pre><code class="julia hljs">N=<span class=hljs-number >100</span>;iter_num=<span class=hljs-number >100</span>;
data23 = <span class=hljs-built_in >Matrix</span>(<span class=hljs-literal >undef</span>,iter_num,<span class=hljs-number >2</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:iter_num
    x23=randn(N)  .+<span class=hljs-number >2</span>
    y23= x23 .+ <span class=hljs-number >1</span> +  randn(N)
    data23[i,:] = min_sq(x23,y23) |&gt; collect
<span class=hljs-keyword >end</span>
p14 = scatter(data23[:,<span class=hljs-number >2</span>],data23[:,<span class=hljs-number >1</span>],xlabel=<span class=hljs-string >&quot;Î²â‚€&quot;</span>,ylabel=<span class=hljs-string >&quot;Î²â‚&quot;</span>,title=<span class=hljs-string >&quot;test&quot;</span>,legend=<span class=hljs-literal >false</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-4.svg" alt="">
<h3 id="ä¾‹24å•12ã«å¯¾å¿œ"><a href="#ä¾‹24å•12ã«å¯¾å¿œ">ä¾‹24&#40;å•12ã«å¯¾å¿œ&#41;</a></h3>
<p>å¾Œã€…ã®ã“ã¨ã‚’è€ƒãˆã¦ã€RSSã‚„Rï¼’ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> RSS(x::<span class=hljs-built_in >Vector</span>,y)
    Î²Ì‚ = min_sq(x,y)
    yÌ‚ = Î²Ì‚[<span class=hljs-number >1</span>]*x .+ Î²Ì‚[<span class=hljs-number >2</span>]
    <span class=hljs-keyword >return</span> (y-yÌ‚)&#x27;*(y-yÌ‚)
<span class=hljs-keyword >end</span>
<span class=hljs-keyword >function</span> RSS(x,y)
    yÌ‚ = expand_matrix(x)*MultipleRegression(x,y)
    <span class=hljs-keyword >return</span> (y-yÌ‚)&#x27;*(y-yÌ‚)
<span class=hljs-keyword >end</span>


<span class=hljs-keyword >function</span> RSE(x::<span class=hljs-built_in >Matrix</span>,y)
    n,p = size(x)
    RSS(x,y) / (n-p-<span class=hljs-number >1</span>) |&gt; sqrt
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> RSE(x::<span class=hljs-built_in >Vector</span>,y)
    RSS(x,y) / (length(x)-<span class=hljs-number >2</span>) |&gt; sqrt
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> Bdiag(x)
    X = expand_matrix(x)
    <span class=hljs-keyword >return</span> X&#x27;X |&gt; inv |&gt; diag
<span class=hljs-keyword >end</span></code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Statistics
N = <span class=hljs-number >100</span>;Random.seed!(<span class=hljs-number >123</span>)
x24 = randn(N); y24=randn(N);
Î²â‚, Î²â‚€ = min_sq(x24,y24)
rse = Joe.RSE(x24,y24)
seâ‚€, seâ‚ = rse*sqrt.(Joe.Bdiag(x24))
tâ‚€ = Î²â‚€ / seâ‚€
tâ‚ = Î²â‚ / seâ‚
pâ‚€ = <span class=hljs-number >2</span>*(ccdf(TDist(N-<span class=hljs-number >2</span>),abs(tâ‚€)))
pâ‚ = <span class=hljs-number >2</span>*(ccdf(TDist(N-<span class=hljs-number >2</span>),abs(tâ‚)))
<span class=hljs-meta >@show</span> Î²â‚€, Î²â‚;
<span class=hljs-meta >@show</span> tâ‚€, tâ‚;
<span class=hljs-meta >@show</span> pâ‚€, pâ‚;</code></pre><pre><code class="plaintext hljs">(Î²â‚€, Î²â‚) = (0.10898230758144681, -0.05761023247512567)
(tâ‚€, tâ‚) = (1.0893138251707204, -0.6469066946933425)
(pâ‚€, pâ‚) = (0.27868694362737306, 0.5192046691957626)
</code></pre>
<p>GLM.jlã‚’ä½¿ã£ãŸå ´åˆã§ã‚‚åŒã˜å€¤ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> GLM, DataFrames
data = DataFrame(X=x24,Y=y24)
ols = lm(<span class=hljs-meta >@formula</span>(Y ~ X), data)</code></pre><pre><code class="plaintext hljs">StatsModels.TableRegressionModel{GLM.LinearModel{GLM.LmResp{Array{Float64,1}},GLM.DensePredChol{Float64,LinearAlgebra.Cholesky{Float64,Array{Float64,2}}}},Array{Float64,2}}

Y ~ 1 + X

Coefficients:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                  Coef.  Std. Error      t  Pr(&gt;|t|)   Lower 95%  Upper 95%
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(Intercept)   0.108982    0.10005     1.09    0.2787  -0.0895638   0.307528
X            -0.0576102   0.0890579  -0.65    0.5192  -0.234343    0.119122
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</code></pre>
<h3 id="ä¾‹25å•13ã«å¯¾å¿œ"><a href="#ä¾‹25å•13ã«å¯¾å¿œ">ä¾‹25&#40;å•13ã«å¯¾å¿œ&#41;</a></h3>
<p>Î²Ì‚â‚/SE&#40;Î²â‚&#41;ã‚’ç¹°ã‚Šè¿”ã—æ¨å®šã—ã¦ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’ä½œã‚Šã¾ã™ã€‚ è‡ªç”±åº¦N-2ã®tåˆ†å¸ƒã«ã‚ˆãä¸€è‡´ã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<pre><code class="julia hljs">t25 = <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Real</span>}(<span class=hljs-literal >undef</span>,<span class=hljs-number >1000</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>
    x25 = randn(N); y25 = randn(N)
    t25[i],_ = collect(min_sq(x25,y25)) / Joe.RSE(x25,y25) ./ sqrt.(Joe.Bdiag(x25))
<span class=hljs-keyword >end</span>
p25_1 = histogram(t25,xlims=(-<span class=hljs-number >3</span>,<span class=hljs-number >3</span>),bins=<span class=hljs-number >20</span>,normalize=<span class=hljs-literal >true</span>,xlabel=<span class=hljs-string >&quot;tã®å€¤&quot;</span>,legend=<span class=hljs-literal >false</span>)
title!(<span class=hljs-string >&quot;å¸°ç„¡ä»®èª¬ãŒæˆç«‹ã™ã‚‹å ´åˆ&quot;</span>)
plot!(p25_1,x-&gt;pdf(TDist(<span class=hljs-number >98</span>),x));</code></pre>
<p>åŒã˜ã“ã¨ã‚’y&#61;0.1x&#43;Ïµã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs">t25_ = <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Real</span>}(<span class=hljs-literal >undef</span>,<span class=hljs-number >1000</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>
    x25 = randn(N); y25 = <span class=hljs-number >0.1</span>*x25 .+ randn(N)
    t25_[i],_ = collect(min_sq(x25,y25)) / Joe.RSE(x25,y25) ./ sqrt.(Joe.Bdiag(x25))
<span class=hljs-keyword >end</span>
p25_2 = histogram(t25_,xlims=(-<span class=hljs-number >3</span>,<span class=hljs-number >3</span>),bins=<span class=hljs-number >20</span>,normalize=<span class=hljs-literal >true</span>, xlabel=<span class=hljs-string >&quot;tã®å€¤&quot;</span>,legend=<span class=hljs-literal >false</span>)
title!(<span class=hljs-string >&quot;å¸°ç„¡ä»®èª¬ãŒæˆç«‹ã—ãªã„å ´åˆ&quot;</span>)
plot!(p25_2,x-&gt;pdf(TDist(<span class=hljs-number >98</span>),x))
p25 = plot(p25_1,p25_2)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-6.svg" alt="">
<h2 id="16_æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º"><a href="#16_æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º">1.6 æ±ºå®šä¿‚æ•°ã¨å…±ç·šå½¢æ€§ã®æ¤œå‡º</a></h2>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow><mrow><mi>T</mi><mi>S</mi><mi>S</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>E</mi><mi>S</mi><mi>S</mi></mrow><mrow><mi>T</mi><mi>S</mi><mi>S</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">R^2 = 1 - \dfrac{RSS}{TSS} = \dfrac{ESS}{TSS}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã«ã—ãŸãŒã£ã¦ã€æ¬¡ã®é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> TSS(y)
    Y = y .- mean(y)
    <span class=hljs-keyword >return</span> Y&#x27;*Y
<span class=hljs-keyword >end</span>

ESS(x,y) = TSS(y) - RSS(x,y)

R2(x,y) = ESS(x,y)/TSS(y)</code></pre>
<h3 id="ä¾‹26"><a href="#ä¾‹26">ä¾‹26</a></h3>
<p>æ±ºå®šä¿‚æ•°ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs">N = <span class=hljs-number >100</span>; Random.seed!(<span class=hljs-number >123</span>)
x26_2 = randn(N,<span class=hljs-number >2</span>); x26_1 = randn(N)
y26 = randn(N)
<span class=hljs-meta >@show</span> Joe.R2(x26_2,y26);</code></pre><pre><code class="plaintext hljs">Joe.R2(x26_2, y26) = 0.0021037427008463584
</code></pre>
<p>ã¾ãŸã€1å¤‰é‡ãªã‚‰ç›¸é–¢ä¿‚æ•°ã®äºŒä¹—ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-meta >@show</span> Joe.R2(x26_1,y26);
<span class=hljs-meta >@show</span> cor(x26_1,y26)^<span class=hljs-number >2</span> ; <span class=hljs-comment ># Statistics.jl</span></code></pre><pre><code class="plaintext hljs">Joe.R2(x26_1, y26) = 0.02246508247965494
cor(x26_1, y26) ^ 2 = 0.02246508247965464
0.02246508247965464</code></pre>
<h3 id="ä¾‹27"><a href="#ä¾‹27">ä¾‹27</a></h3>
<p>VIFã®è¨ˆç®—ã¯æ—¢å­˜ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ãªã•ãã†ã§ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> VIF(x)
    _,ncol= size(x)
    v = <span class=hljs-built_in >Vector</span>(<span class=hljs-literal >undef</span>, ncol)
    <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:ncol
        index = delete!(<span class=hljs-built_in >Set</span>(<span class=hljs-number >1</span>:ncol),j) |&gt; collect
        v[j] = <span class=hljs-number >1</span>/(<span class=hljs-number >1</span>-R2(x[:,index],x[:,j]))
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> v
<span class=hljs-keyword >end</span></code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, RDatasets,DataFrames
<span class=hljs-keyword >using</span> <span class=hljs-built_in >Pipe</span>: <span class=hljs-meta >@pipe</span>
df = dataset(<span class=hljs-string >&quot;MASS&quot;</span>,<span class=hljs-string >&quot;BOSTON&quot;</span>)
x27 = <span class=hljs-meta >@pipe</span> df |&gt; select(_,Not(:MedV)) |&gt; <span class=hljs-built_in >Array</span> <span class=hljs-comment >#df[Not(:MedV)]ãŒFranklinã§å‹•ã‹ã‚“ã€‚</span>
<span class=hljs-comment >#TabularDisplayã‚’ä½¿ã£ã¦ç¶ºéº—ã«è¡¨ç¤ºã™ã‚‹ã€‚</span>
<span class=hljs-keyword >using</span> TabularDisplay, Formatting
foo = generate_formatter(<span class=hljs-string >&quot;%7.5f&quot;</span>)
displaytable(Joe.VIF(x27);index=<span class=hljs-literal >true</span>,indexsep=<span class=hljs-string >&quot; -&gt; &quot;</span>,formatter=foo)</code></pre><pre><code class="plaintext hljs">ArgumentError: Package Pipe not found in current path:
- Run `import Pkg; Pkg.add(&quot;Pipe&quot;)` to install the Pipe package.

</code></pre>
<h2 id="17_ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“"><a href="#17_ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“">1.7 ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“</a></h2>
<p>å®šç¾©ã«ã—ãŸãŒã£ã¦ã€ä¿¡é ¼åŒºé–“ã¨äºˆæ¸¬åŒºé–“ã®å®šç¾©ã‚’ã—ã¾ã™ã€‚å±é™ºç‡ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯0.01ã¨ã—ã¦ã„ã¾ã™ã€‚ &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mo lspace=0em  rspace=0em >â‹†</mo></msub><mo stretchy=false >(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=false >)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msubsup><mi>x</mi><mo lspace=0em  rspace=0em >â‹†</mo><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">x_{\star}(X^TX)^{-1}x_{\star}^T</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.175696em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â‹†</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â‹†</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ã®è¨ˆç®—ã«æ¨ªç€ã—ã¦diagã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€ã¡ã‚‡ã£ã¨å‹¿ä½“ãªã„ãƒªã‚½ãƒ¼ã‚¹ã®ä½¿ã„æ–¹ã‚’ã—ã¦ã„ã‚‹ã€‚&#41;</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> confident_interval(xp,x,y;Î±=<span class=hljs-number >0.01</span>)
    N,p = size(x)
    X = expand_matrix(x)
    XP = expand_matrix(xp)
    typeof(xp) &lt;:<span class=hljs-built_in >Number</span> &amp;&amp; (xp =[xp])
    yerror = quantile(TDist(N-p-<span class=hljs-number >1</span>),<span class=hljs-number >1</span>-Î±/<span class=hljs-number >2</span>) * sqrt.(diag(XP * ((X&#x27;X) \ XP&#x27;)))
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> prediction_interval(xp,x,y;Î±=<span class=hljs-number >0.01</span>)
    N,p = size(x)
    X = expand_matrix(x)
    XP = expand_matrix(xp)
    typeof(xp) &lt;:<span class=hljs-built_in >Number</span> &amp;&amp; (xp =[xp])
    yerror = quantile(TDist(N-p-<span class=hljs-number >1</span>),<span class=hljs-number >1</span>-Î±/<span class=hljs-number >2</span>) * sqrt.( <span class=hljs-number >1</span> .+ diag(XP * ((X&#x27;X) \ XP&#x27;)))
<span class=hljs-keyword >end</span></code></pre>
<h3 id="ä¾‹28"><a href="#ä¾‹28">ä¾‹28</a></h3>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Plots, Random, Joe
N = <span class=hljs-number >100</span>; Random.seed!(<span class=hljs-number >123</span>)
x28 = randn(N,<span class=hljs-number >1</span>)
y28 = x28 .+<span class=hljs-number >1</span> + randn(N)  |&gt; vec <span class=hljs-comment ># çœŸã®åˆ‡ç‰‡ã¨å‚¾ãã¯ã¨ã‚‚ã«1</span>
p28 = scatter(x28,y28,xlabel=<span class=hljs-string >&quot;x&quot;</span>,ylabel=<span class=hljs-string >&quot;y&quot;</span>,label=<span class=hljs-string >&quot;data     &quot;</span>,legend=:topleft)

Î²<span class=hljs-number >28</span> = MultipleRegression(x28,y28)
x_seq = -<span class=hljs-number >10</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >10</span>
yÌ‚ = expand_matrix(x_seq) * Î²<span class=hljs-number >28</span>
yerror1 = Joe.confident_interval(x_seq,x28,y28)
yerror2 = Joe.prediction_interval(x_seq,x28,y28)
plot!(p28,x_seq,yÌ‚,ribbon=yerror2, label=<span class=hljs-string >&quot;äºˆæ¸¬åŒºé–“&quot;</span>)
plot!(p28,x_seq,yÌ‚,ribbon=yerror1, label=<span class=hljs-string >&quot;ä¿¡é ¼åŒºé–“&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap1/code/output/fig1-7.svg" alt="">
  <p style="text-align:right">  ãŠã—ã¾ã„ </p>  <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p>
<div class=page-foot >
  <div class=copyright >
    &copy; Kei Hanafusa. Last modified: December 26, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/Joe.jl/libs/vela/slideout.min.js"></script>
  <script src="/Joe.jl/libs/myBtn/myBtn.js"></script>
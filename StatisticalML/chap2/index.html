<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•ã‚’juliaã§ã‚„ã‚‹ </title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">ãƒˆãƒƒãƒ—</a> <li><a href="" class=has-arrow >çµ±è¨ˆçš„æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">ç¬¬ä¸€ç« ã€€ç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap2/">ç¬¬äºŒç« ã€€åˆ†é¡</a> <li><a href="/Joe.jl/StatisticalML/chap3/">ç¬¬ä¸‰ç« ã€€ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</a> <li><a href="/Joe.jl/StatisticalML/chap4/">ç¬¬å››ç« ã€€æƒ…å ±é‡åŸºæº–</a> <li><a href="/Joe.jl/StatisticalML/chap5/">ç¬¬äº”ç« ã€€æ­£å‰‡åŒ–</a> <li><a href="/Joe.jl/StatisticalML/chap6/">ç¬¬äº”ç« ã€€éç·šå½¢å›å¸°</a> </ul> <li><a href="" class=has-arrow >ã‚¹ãƒ‘ãƒ¼ã‚¹æ¨å®š100å•</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">åˆ†é¡</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</a><ol><li><a href="#ä¾‹29">ä¾‹29</a></ol><li><a href="#ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•">ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ»ãƒ©ãƒ•ã‚½ãƒ³æ³•</a><ol><li><a href="#ä¾‹31">ä¾‹31</a><li><a href="#ä¾‹31__2">ä¾‹31</a><li><a href="#ä¾‹33">ä¾‹33</a><li><a href="#ä¾‹34">ä¾‹34</a></ol><li><a href="#23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥">2.3 ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥</a><ol><li><a href="#ä¾‹35">ä¾‹35</a><li><a href="#ä¾‹36_fisherã®ã‚ã‚„ã‚">ä¾‹36 &#40;Fisherã®ã‚ã‚„ã‚&#41;</a><li><a href="#å•29_äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ">å•29 äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ</a></ol><li><a href="#kè¿‘å‚æ³•">Kè¿‘å‚æ³•</a><ol><li><a href="#ä¾‹37_fisherã®ã‚ã‚„ã‚_returns">ä¾‹37 Fisherã®ã‚ã‚„ã‚ returns</a></ol><li><a href="#rocæ›²ç·š">ROCæ›²ç·š</a><ol><li><a href="#ä¾‹38">ä¾‹38</a></ol></ol></div> <h2 id="ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°"><a href="#ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</a></h2> <h3 id="ä¾‹29"><a href="#ä¾‹29">ä¾‹29</a></h3> <p>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p> <pre><code class="julia hljs">sigmoid(x::<span class=hljs-built_in >Matrix</span>, Î²::<span class=hljs-built_in >Vector</span>) = <span class=hljs-number >1</span> / (<span class=hljs-number >1</span> + exp(-x*Î²))</code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Plots
p29 = plot(xlims=(-<span class=hljs-number >10</span>,<span class=hljs-number >10</span>), xlabel=<span class=hljs-string >&quot;x&quot;</span>,ylabel=<span class=hljs-string >&quot;P(Y=1|x)&quot;</span>,
            legend=:topleft, title=<span class=hljs-string >&quot;ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ›²ç·š&quot;</span>)
x29 = insert_ones(-<span class=hljs-number >10</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >10</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> [<span class=hljs-number >0</span>, <span class=hljs-number >0.2</span>, <span class=hljs-number >0.5</span>, <span class=hljs-number >1</span>, <span class=hljs-number >2</span>, <span class=hljs-number >10</span>]
    plot!(p29, x29[:,<span class=hljs-number >2</span>], Joe.sigmoid(x29,[<span class=hljs-number >0</span>,i]),label=<span class=hljs-string >&quot;<span class=hljs-variable >$i</span>&quot;</span>)
<span class=hljs-keyword >end</span></code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-1.svg" alt="">
<h2 id="ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•"><a href="#ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•">ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ»ãƒ©ãƒ•ã‚½ãƒ³æ³•</a></h2>
<h3 id="ä¾‹31"><a href="#ä¾‹31">ä¾‹31</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x^2-1=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã‚’4ã‚’åˆæœŸå€¤ã¨ã—ã¦æ•°å€¤è¨ˆç®—ã§è§£ãå•é¡Œã€‚10å›ã§ã©ã®ç¨‹åº¦è¿‘ã¥ãã‹ã€‚ ã›ã£ã‹ããªã®ã§ã€ å¾®åˆ†ã‚’ã‚ã‚‰ã‚ã«æ›¸ãä¸‹ã™ã®ã§ã¯ãªãã¦ã€è‡ªå‹•å¾®åˆ†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ è¦‹ãŸç›®ãŒ<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>â†</mo><mi>x</mi><mo>âˆ’</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mrow><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">x \leftarrow x - \dfrac{f(x)}{f&#x27;(x)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã¨ã„ã†å…¬å¼ã®ã¾ã‚“ã¾ã§ã™ã­ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Zygote
f(x) = x^<span class=hljs-number >2</span> -<span class=hljs-number >1</span>
x=<span class=hljs-number >4</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    x -= f(x)/f&#x27;(x)
    println(x)
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">2.125
1.2977941176470589
1.0341661806365605
1.0005643811996305
1.0000001591732348
1.0000000000000127
1.0
1.0
1.0
1.0
</code></pre>
<h3 id="ä¾‹31__2"><a href="#ä¾‹31__2">ä¾‹31</a></h3>
<p>2å¤‰æ•°é–¢æ•°ãŒ2ã¤ã‚ã‚‹å ´åˆã€‚ Zygote.jlã«jacobianãŒãªã‹ã£ãŸã®ã§ã€ForwardDiff.jlã‚’ä½¿ã£ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> ForwardDiff

f(x,y) = [x^<span class=hljs-number >2</span>+y^<span class=hljs-number >2</span>-<span class=hljs-number >1</span>, x+y]
z = [<span class=hljs-number >3</span>,<span class=hljs-number >4</span>]
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    z -= ForwardDiff.jacobian(x-&gt;f(x[<span class=hljs-number >1</span>], x[<span class=hljs-number >2</span>]),z) \ f(z[<span class=hljs-number >1</span>],z[<span class=hljs-number >2</span>])
    println(z)
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">[-13.000000000000004, 13.000000000000002]
[-6.519230769230771, 6.519230769230771]
[-3.297963467211255, 3.297963467211255]
[-1.7247860905930625, 1.7247860905930625]
[-1.0073385555621193, 1.0073385555621193]
[-0.7518480044063836, 0.7518480044063836]
[-0.7084380190454468, 0.7084380190454468]
[-0.7071080319623313, 0.7071080319623313]
[-0.7071067811876538, 0.7071067811876538]
[-0.7071067811865475, 0.7071067811865475]
</code></pre>
<h3 id="ä¾‹33"><a href="#ä¾‹33">ä¾‹33</a></h3>
<p>æœ€å°¤æ¨å®šã«ã‚ˆã‚Šãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã‚’è¡Œã†å•é¡Œã€‚ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >âˆ‡</mi><mi>l</mi><mo stretchy=false >(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo separator=true >,</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nabla l(\beta_0, \beta) = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >âˆ‡</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã‚’æ±‚ã‚ã‚‹å•é¡Œã‚’è§£ã„ã¦ã¿ã‚‹ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Random, LinearAlgebra
<span class=hljs-keyword >using</span> Plots
N=<span class=hljs-number >1000</span>; p=<span class=hljs-number >2</span>; Random.seed!(<span class=hljs-number >1</span>)
X = insert_ones(randn(N,p))
Î² = randn(p+<span class=hljs-number >1</span>)
prob = @. <span class=hljs-number >1</span>/(<span class=hljs-number >1</span> + exp($*(X,Î²)))
threshold=<span class=hljs-number >0.5</span>
y = ifelse.(rand(N) .&gt; prob,<span class=hljs-number >1</span>,-<span class=hljs-number >1</span>) <span class=hljs-comment ># ã“ã“ã¾ã§ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ</span>
<span class=hljs-meta >@show</span> y Î²;</code></pre><pre><code class="plaintext hljs">y = [-1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, 1, 1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, -1, 1, 1, 1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, -1, -1, -1, -1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1]
Î² = [-0.8743656729822114, -1.945231200473885, 1.6388761704740658]
</code></pre>
<p>ã›ã£ã‹ããªã®ã§ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs">data1 = X[y .== <span class=hljs-number >1</span>, <span class=hljs-number >2</span>:<span class=hljs-number >3</span>]
data2 = X[y .== -<span class=hljs-number >1</span>, <span class=hljs-number >2</span>:<span class=hljs-number >3</span>]
p33=scatter(data1[:,<span class=hljs-number >1</span>],data1[:,<span class=hljs-number >2</span>],ylims=(-<span class=hljs-number >5</span>,<span class=hljs-number >5</span>),marker=:auto, label=<span class=hljs-string >&quot;y=1&quot;</span>)
scatter!(p33,data2[:,<span class=hljs-number >1</span>],data2[:,<span class=hljs-number >2</span>],marker=:auto,label=<span class=hljs-string >&quot;y=-1&quot;</span>)
plot!(p33,x-&gt; -Î²[<span class=hljs-number >1</span>]/Î²[<span class=hljs-number >3</span>] - Î²[<span class=hljs-number >2</span>]/Î²[<span class=hljs-number >3</span>]*x, label=<span class=hljs-string >&quot;Î²&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2.svg" alt="">
<pre><code class="julia hljs">Î³ = randn(<span class=hljs-number >2</span>+<span class=hljs-number >1</span>) <span class=hljs-comment >#åˆæœŸå€¤</span>
Î³<span class=hljs-number >2</span> = copy(Î³) <span class=hljs-comment >#åˆ¥è§£ç”¨ã«ã‚³ãƒ”ãƒ¼</span>
<span class=hljs-meta >@show</span> Î³
W(v::<span class=hljs-built_in >Vector</span>) = @.(v/(<span class=hljs-number >1</span>+ v)^<span class=hljs-number >2</span>) |&gt; diagm
t = <span class=hljs-literal >true</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    <span class=hljs-keyword >global</span> Î³
    s=X*Î³
    v = @. exp(-y*s)
    u = @. y*v/(<span class=hljs-number >1</span>+v)
    Î³ += ((X&#x27;*W(v)*X) \ X&#x27;) * u
    <span class=hljs-comment >#Î´&#x27;*Î´ &lt; 0.001 &amp;&amp; (t = false)</span>
    <span class=hljs-meta >@show</span> Î³
<span class=hljs-keyword >end</span>
plot!(x-&gt; -Î³[<span class=hljs-number >1</span>]/Î³[<span class=hljs-number >3</span>] - Î³[<span class=hljs-number >2</span>]/Î³[<span class=hljs-number >3</span>]*x, label=<span class=hljs-string >&quot;Î³&quot;</span>)</code></pre><pre><code class="plaintext hljs">Î³ = [-0.9588319286678549, -2.142965143840243, 0.49000586969362697]
Î³ = [-0.6868290426397674, -1.4905574506024164, 1.3181038933475095]
Î³ = [-0.8389578286870751, -1.813314273328805, 1.4260329338938003]
Î³ = [-0.864933524808484, -1.871868634791574, 1.4560345475721006]
Î³ = [-0.8656536058114845, -1.873524320938391, 1.4570217428831782]
Î³ = [-0.8656541720759061, -1.8735256324938316, 1.4570225945617945]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623723]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623723]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623723]
Plot{Plots.GRBackend() n=4}</code></pre>
<p>ä»Šåº¦ã¯æ¨ªç€ã‚’ã—ã¦ã€ãƒ˜ã‚·ã‚¢ãƒ³ã‚’ä½¿ã£ã¦è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Zygote, LinearAlgebra
l(Î³,X=X,y=y) = sum(@. log( <span class=hljs-number >1</span> /(<span class=hljs-number >1</span>+exp(*($*(X,Î³),-y))))) <span class=hljs-comment >#å¯¾æ•°å°¤åº¦é–¢æ•°</span>

<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    <span class=hljs-keyword >global</span> Î³<span class=hljs-number >2</span>
    Î´ =  Zygote.hessian(l,Î³<span class=hljs-number >2</span>) \ l&#x27;(Î³<span class=hljs-number >2</span>)
    Î³<span class=hljs-number >2</span> -= Î´
    <span class=hljs-meta >@show</span> Î³<span class=hljs-number >2</span>
<span class=hljs-keyword >end</span>

plot!(p33,x-&gt; -Î³<span class=hljs-number >2</span>[<span class=hljs-number >1</span>]/Î³<span class=hljs-number >2</span>[<span class=hljs-number >3</span>] - Î³<span class=hljs-number >2</span>[<span class=hljs-number >2</span>]/Î³<span class=hljs-number >2</span>[<span class=hljs-number >3</span>]*x, label=<span class=hljs-string >&quot;Î³2&quot;</span>)</code></pre><pre><code class="plaintext hljs">Î³2 = [-0.6868290426397674, -1.4905574506024166, 1.3181038933475095]
Î³2 = [-0.8389578286870754, -1.8133142733288061, 1.4260329338938007]
Î³2 = [-0.864933524808484, -1.8718686347915743, 1.4560345475721008]
Î³2 = [-0.8656536058114844, -1.8735243209383907, 1.457021742883178]
Î³2 = [-0.8656541720759061, -1.8735256324938316, 1.4570225945617945]
Î³2 = [-0.8656541720762696, -1.8735256324946747, 1.4570225945623723]
Î³2 = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³2 = [-0.8656541720762696, -1.8735256324946747, 1.4570225945623723]
Î³2 = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³2 = [-0.8656541720762696, -1.8735256324946747, 1.4570225945623723]
</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2-2.svg" alt=""> <div class=blank ></div> ã ã„ãŸã„åŒã˜ã‚ˆã†ãªå¢ƒç•Œç·šãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚</p>
<h3 id="ä¾‹34"><a href="#ä¾‹34">ä¾‹34</a></h3>
<p>ãƒ‡ãƒ¼ã‚¿ã®åŠåˆ†ã‚’ä½¿ã£ã¦ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã§å­¦ç¿’ã—ã€æ®‹ã‚Šã®ãƒ‡ãƒ¼ã‚¿ã§æ¤œè¨¼ã™ã‚‹ç·´ç¿’ã€‚ ã¾ãšãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Random, Distributions, Plots, LinearAlgebra
Random.seed!(<span class=hljs-number >123</span>)
n=<span class=hljs-number >100</span>
x34 = vcat(randn(n).+<span class=hljs-number >1</span>,randn(n).-<span class=hljs-number >1</span>) |&gt; insert_ones
y34 = vcat(ones(n),-ones(n));</code></pre>
<p>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¦å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs">index = sample(<span class=hljs-number >1</span>:<span class=hljs-number >2</span>n,<span class=hljs-number >2</span>n,replace=<span class=hljs-literal >false</span>); <span class=hljs-comment >#ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œã‚Š</span>
train = index[<span class=hljs-keyword >begin</span>:n];<span class=hljs-comment ># å­¦ç¿’ç”¨ã¨ãƒ†ã‚¹ãƒˆç”¨ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ†ã‘ã‚‹ã€‚</span>
test = index[n+<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>];
X_train = x34[train,:];y_train = y34[train]
X_test = x34[test,:];y_test = y34[test]
p34 = scatter(X_train[:,<span class=hljs-number >2</span>],y_train,label=<span class=hljs-string >&quot;train&quot;</span>)
scatter!(p34,X_test[:,<span class=hljs-number >2</span>],y_test,label=<span class=hljs-string >&quot;test&quot;</span>)</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2-3.svg" alt=""> <div class=blank ></div> <div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content ><p><strong>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã‚‹æ–¹æ³•</strong></p>
<p>åŸè‘—ã®pythonã‚³ãƒ¼ãƒ‰ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
train = np.random.choice(<span class=hljs-number >2</span>*n, <span class=hljs-built_in >int</span>(n), replace=false)
test = <span class=hljs-built_in >list</span>(<span class=hljs-built_in >set</span>(<span class=hljs-built_in >range</span>(n))-<span class=hljs-built_in >set</span>(train))</code></pre>
<p>setã‚’ä½¿ã£ãŸæ›¸ãæ–¹ã¯ä¾¿åˆ©ã§ã™ãŒã€juliaã§ã¯é‡è¤‡ã‚’è¨±ã•ãšã«ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã¹ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’äºŒã¤ã«åˆ†ã‘ã‚‹ æ–¹æ³•ã‚’ä½¿ã„ã¾ã—ãŸã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsBase
index = sample(<span class=hljs-number >1</span>:n,n,replace=<span class=hljs-literal >false</span>);
train = index[<span class=hljs-keyword >begin</span>:<span class=hljs-built_in >Int</span>(n/<span class=hljs-number >2</span>)];
test = index[<span class=hljs-built_in >Int</span>(n/<span class=hljs-number >2</span>)+<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>];</code></pre>
<p>ã§ã‚‚ã‚ˆãè€ƒãˆã‚‹ã¨setdiffã‚’ä½¿ãˆã°ååˆ†ã§ã—ãŸã€‚</p>
<pre><code class="julia hljs">train = sample(<span class=hljs-number >1</span>:<span class=hljs-number >2</span>n,n,replace=<span class=hljs-literal >false</span>); test = setdiff(<span class=hljs-number >1</span>:<span class=hljs-number >2</span>n,train)</code></pre></div></div> ãƒ«ãƒ¼ãƒ—ã¯åŸè‘—ã®æ–¹æ³•ã«å¾“ã„ã¾ã—ãŸã€‚</p>
<pre><code class="julia hljs">Î² = [<span class=hljs-number >0</span>,<span class=hljs-number >0</span>] <span class=hljs-comment >#åˆæœŸå€¤</span>
Î³ = randn(<span class=hljs-number >2</span>)
<span class=hljs-keyword >while</span> sum(Î²-Î³)^<span class=hljs-number >2</span> &gt; <span class=hljs-number >0.001</span>
    <span class=hljs-keyword >global</span> Î², Î³
    <span class=hljs-keyword >local</span> W
    Î² = Î³
    s = X_train*Î²
    v = @. exp(-s*y_train)
    u = @. y_train*v/(<span class=hljs-number >1</span>+v)
    w = @. v/(<span class=hljs-number >1</span>+v)^<span class=hljs-number >2</span>
    W = diagm(w)
    z = @. s + u/w
    Î³ = (X_train&#x27;*W*X_train)\(X_train&#x27;*W*z)
    <span class=hljs-meta >@show</span> Î³;
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">Î³ = [-0.25068749058454703, 1.2955594588774142]
Î³ = [-0.2018146034801543, 1.7007995013607489]
Î³ = [-0.2049537016121021, 1.8380963810033202]
Î³ = [-0.20628662758607502, 1.8500602521823715]
</code></pre>
<p>æ¬¡ã«ã“ã®Î³ã‚’ä½¿ã£ã¦ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’äºˆæ¸¬ã—ã¦ã¿ã¾ã™ã€‚ æ­£èª¤ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹é–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> table_count(test,pred)
    <span class=hljs-meta >@assert</span> length(test) == length(pred)
    m = unique(test) |&gt; length
    count = zeros(<span class=hljs-built_in >Int</span>,m,m)
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:length(test)
        count[test[i],pred[i]] += <span class=hljs-number >1</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> count
<span class=hljs-keyword >end</span></code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe:table_count
y_pred = X_test*Î³ .|&gt; x -&gt; ifelse(x&gt;<span class=hljs-number >0</span>,<span class=hljs-number >2</span>,<span class=hljs-number >1</span>)
y_answer = y_test .|&gt; x -&gt; ifelse(x&gt;<span class=hljs-number >0</span>,<span class=hljs-number >2</span>,<span class=hljs-number >1</span>)
table = table_count(y_answer,y_pred)
<span class=hljs-meta >@show</span> table;
æ­£ç­”ç‡ = sum(diag(table)) / sum(table)</code></pre><pre><code class="plaintext hljs">table = [44 5; 10 41]
0.85</code></pre>
<h2 id="23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥"><a href="#23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥">2.3 ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥</a></h2>
<h3 id="ä¾‹35"><a href="#ä¾‹35">ä¾‹35</a></h3>
<p>ã¾ãšã¯ä¸ãˆã‚‰ã‚ŒãŸå¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‹ã‚‰äºŒæ¬¡å…ƒæ­£è¦åˆ†å¸ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’2ç¨®é¡ç”Ÿæˆã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, Random,Plots, LinearAlgebra, Parameters
Î¼â‚=[<span class=hljs-number >2</span>,<span class=hljs-number >2</span>];  Î£â‚ = [<span class=hljs-number >2</span> <span class=hljs-number >0</span>; <span class=hljs-number >0</span> <span class=hljs-number >2</span>]
Î¼â‚‚=[-<span class=hljs-number >3</span>,-<span class=hljs-number >3</span>]; Î£â‚‚ = [<span class=hljs-number >1</span> -<span class=hljs-number >0.8</span>; -<span class=hljs-number >0.8</span> <span class=hljs-number >1</span>]

N = <span class=hljs-number >100</span>;Random.seed!(<span class=hljs-number >123</span>)
data1 = rand(MvNormal(Î¼â‚,Î£â‚),<span class=hljs-number >100</span>) |&gt; transpose
data2 = rand(MvNormal(Î¼â‚‚,Î£â‚‚),<span class=hljs-number >100</span>) |&gt; transpose
p35 = scatter(data1[:,<span class=hljs-number >1</span>],data1[:,<span class=hljs-number >2</span>])
scatter!(p35, data2[:,<span class=hljs-number >1</span>],data2[:,<span class=hljs-number >2</span>])</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-3.svg" alt=""> <div class=blank ></div> ã“ã“ã¾ã§ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã€‚ ç”Ÿæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®—ã™ã‚‹ã€‚</p>
<pre><code class="julia hljs">Î¼Ì‚â‚ = mean(data1,dims=<span class=hljs-number >1</span>)&#x27;; Î£Ì‚â‚ = cov(data1,dims=<span class=hljs-number >1</span>);
Î¼Ì‚â‚‚ = mean(data2,dims=<span class=hljs-number >1</span>)&#x27; ; Î£Ì‚â‚‚ = cov(data2,dims=<span class=hljs-number >1</span>);</code></pre>
<p><div class=warning ><div class=title >ğŸ˜• Warning&#33;</div>
<div class=content >meané–¢æ•°ã§è¡Œåˆ—ã®åˆ—æ–¹å‘ã®å¹³å‡ã‚’ã¨ã‚‹æ™‚ã€å¾—ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯äºŒæ¬¡å…ƒã®æ¨ªãƒ™ã‚¯ãƒˆãƒ«ã«ãªã£ã¦ã„ã‚‹ã€‚ ç¸¦ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦æ‰±ã„ãŸã„ã®ã§ã€è»¢ç½®&#40;æ­£ç¢ºã«ã¯è¤‡ç´ å…±å½¹ï¼‰ã‚’ã—ã¦ã„ã‚‹ã€‚</div></div> ãã‚Œãã‚Œã®åˆ†å¸ƒã®æƒ…å ±ã‚’è¤‡åˆå‹ã«ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-meta >@with_kw</span> <span class=hljs-keyword >struct</span> QDA
    Î¼::<span class=hljs-built_in >Array</span> <span class=hljs-comment ># å¹³å‡</span>
    Î£::<span class=hljs-built_in >Matrix</span> <span class=hljs-comment ># åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—</span>
    invÎ£::<span class=hljs-built_in >Array</span> = inv(Î£) <span class=hljs-comment ># åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®é€†è¡Œåˆ—</span>
    detÎ£ = det(Î£) <span class=hljs-comment ># åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®è¡Œåˆ—å¼</span>
<span class=hljs-keyword >end</span></code></pre>
<p><div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content >ã—ã‚Œã£ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ãŸè¤‡åˆå‹ã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€ã“ã“ã§ã¯Parameters.jlã¨ã„ ã†ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚</div></div> ã¾ãŸã€å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®å¯¾æ•°å°¤åº¦ã‚’å–å¾—ã™ã‚‹é–¢æ•°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚ ã“ã“ã§ã¯ã€juliaã®function-like objectã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ ã¾ãŸã€å¯å¤‰é•·å¼•æ•°&#40;x...&#41;ã‚’åˆ©ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãŒ3æ¬¡å…ƒä»¥ä¸Šã®å ´åˆã«ã‚‚æ‹¡å¼µã—ã¦ã„ã¾ã™ã€‚ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»˜ãå¼•æ•°ã«äº‹å‰ç¢ºç‡ã‚’åŠ ãˆã¦ã„ã¾ã™ã€‚ <div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content >function-like objectã®æ©Ÿèƒ½ã‚’ä½¿ã†ã¨ã€è¤‡åˆå‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’é–¢æ•°ã®ã‚ˆã†ã« ä½¿ã†ã“ã¨ãŒã§ãã€å†åˆ©ç”¨ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚</div></div></p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> (qda::QDA)(x...,prior=<span class=hljs-number >1.0</span>)
    data = collect(x)
    <span class=hljs-meta >@unpack</span> Î¼,invÎ£,detÎ£ = qda
    a = -<span class=hljs-number >0.5</span>*(data-Î¼)&#x27; * invÎ£ * (data-Î¼)
    a[<span class=hljs-number >1</span>] - log(detÎ£) - log(prior)
<span class=hljs-keyword >end</span></code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe: QDA
param1=QDA(Î¼= Î¼Ì‚â‚,Î£ = Î£Ì‚â‚);param2=QDA(Î¼ = Î¼Ì‚â‚‚,Î£ = Î£Ì‚â‚‚)

hanbetsu(x,y) = param1(x,y) - param2(x,y)
x35=-<span class=hljs-number >5</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >5</span>;y35=-<span class=hljs-number >5</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >5</span>;
scatter(data1[:,<span class=hljs-number >1</span>],data1[:,<span class=hljs-number >2</span>])
scatter!( data2[:,<span class=hljs-number >1</span>],data2[:,<span class=hljs-number >2</span>])
p35_2=contour!(x35,y35, hanbetsu.(x35,y35&#x27;), title=<span class=hljs-string >&quot;QDA&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-4.svg" alt="">
<p>ç·šå½¢åˆ¤åˆ¥ã‚’è¡Œã†å ´åˆã¯ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ãŒç­‰ã—ã„ã“ã¨ã‚’ä»®å®šã—ã¾ã™ã€‚ data1ã¨data2ã‚’ã€ãã‚Œãã‚Œä¸­å¿ƒåŒ–å¾Œã«çµ±åˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦ã€ æ–°ãŸãªåˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ±‚ã‚ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs">Î£_L =  vcat(data1 .- Î¼Ì‚â‚&#x27; , data2 .- Î¼Ì‚â‚‚&#x27;) |&gt; cov
param1_L=QDA(Î¼= Î¼Ì‚â‚,Î£ =Î£_L );param2_L=QDA(Î¼ = Î¼Ì‚â‚‚,Î£ = Î£_L)
hanbetsu_L(x,y) = param1_L(x,y) - param2_L(x,y)
p35_3=contour!(p35,x35,y35, hanbetsu_L.(x35,y35&#x27;), title=<span class=hljs-string >&quot;LDA&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-5.svg" alt="">
<h3 id="ä¾‹36_fisherã®ã‚ã‚„ã‚"><a href="#ä¾‹36_fisherã®ã‚ã‚„ã‚">ä¾‹36 &#40;Fisherã®ã‚ã‚„ã‚&#41;</a></h3>
<p>ã¾ãšRDatasetsã‹ã‚‰irisã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> RDatasets, StatsBase, Random
<span class=hljs-keyword >using</span> Joe:QDA
iris = dataset(<span class=hljs-string >&quot;datasets&quot;</span>,<span class=hljs-string >&quot;iris&quot;</span>)
x = iris[!,<span class=hljs-number >1</span>:<span class=hljs-number >4</span>] |&gt; <span class=hljs-built_in >Matrix</span>
targets=unique(iris.Species)</code></pre><pre><code class="plaintext hljs">3-element Array{String,1}:
 &quot;setosa&quot;
 &quot;versicolor&quot;
 &quot;virginica&quot;</code></pre>
<p>ã‚ã‚„ã‚ã®ç¨®é¡ã‚’Intã«å¤‰æ›ã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs">label = <span class=hljs-built_in >Dict</span>(target=&gt;i <span class=hljs-keyword >for</span> (i,target) <span class=hljs-keyword >in</span> enumerate(targets))
y = [label[i] <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> iris.Species];</code></pre>
<p>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¾ã™ã€‚</p>
<pre><code class="julia hljs">Random.seed!(<span class=hljs-number >123</span>)
n = length(y)
index = sample(<span class=hljs-number >1</span>:n,n,replace=<span class=hljs-literal >false</span>); <span class=hljs-comment >#ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œã‚Š</span>
train = index[<span class=hljs-keyword >begin</span>:<span class=hljs-built_in >Int</span>(n/<span class=hljs-number >2</span>)];<span class=hljs-comment ># å­¦ç¿’ç”¨ã¨ãƒ†ã‚¹ãƒˆç”¨ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ†ã‘ã‚‹ã€‚</span>
test = index[<span class=hljs-built_in >Int</span>(n/<span class=hljs-number >2</span>)+<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>];
X_train= x[train,:]; X_test = x[test,:];
y_train = y[train]; y_test = y[test];</code></pre>
<p>ãã‚Œãã‚Œã®ã‚ã‚„ã‚ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ±‚ã‚ã¦ä¿å­˜ã™ã‚‹ã€‚</p>
<pre><code class="julia hljs">Params = QDA[]
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >3</span>
    Î¼,Î£ =  mean_and_cov(X_train[y_train .==i,:])
    push!(Params, QDA(Î¼=Î¼&#x27;, Î£=Î£)) <span class=hljs-comment >#Î¼ã¯è¡Œãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„</span>
<span class=hljs-keyword >end</span></code></pre>
<p>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¤œè¨¼ã™ã‚‹ã€‚å¯¾æ•°å°¤åº¦ã‚’æœ€å¤§åŒ–ã™ã‚‹ãƒ©ãƒ™ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs">y_pred = similar(y_test)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:length(y_test)
    y_pred[i] = argmax([param(X_test[i,:]...) <span class=hljs-keyword >for</span> param <span class=hljs-keyword >in</span> Params])
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >using</span> Joe:table_count
table_count(y_test,y_pred)</code></pre><pre><code class="plaintext hljs">3Ã—3 Array{Int64,2}:
 29   0   0
  0  23   2
  0   2  19</code></pre>
<h3 id="å•29_äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ"><a href="#å•29_äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ">å•29 äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ</a></h3>
<p>ã‚ã‚„ã‚ã®äº‹å‰ç¢ºç‡ãŒ&#91;0.5,0.25,0.25&#93;ã ã£ãŸã¨ãã¯ã€å¯¾æ•°ã‚’ã¨ã£ã¦è¶³ã›ã°è‰¯ã„ã§ã—ã‚‡ã†ã€‚ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»˜ãå¼•æ•°ã§äº‹å‰ç¢ºç‡ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã—ãŸã®ã§ã€ å°‘ã—æ›¸ãæ›ãˆã‚‹ã ã‘ã§å¯¾å¿œå¯èƒ½ã§ã™ã€‚ä»Šå›ã®å ´åˆã€äºˆæ¸¬çµæœã«å¯¾ã—ã¦å½±éŸ¿ã¯å°‘ãªã„ã‚ˆã†ã§ã™ã€‚</p>
<pre><code class="julia hljs">priors = [<span class=hljs-number >0.5</span>,<span class=hljs-number >0.25</span>,<span class=hljs-number >0.25</span>]
y_pred2 = similar(y_test)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:length(y_test)
    y_pred2[i] = argmax([Params[j](X_test[i,:]...;prior=priors[j]) <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >3</span>])
<span class=hljs-keyword >end</span>
table_count(y_test,y_pred2)</code></pre><pre><code class="plaintext hljs">3Ã—3 Array{Int64,2}:
 29   0   0
  0  23   2
  0   2  19</code></pre>
<h2 id="kè¿‘å‚æ³•"><a href="#kè¿‘å‚æ³•">Kè¿‘å‚æ³•</a></h2>
<p>ã¾ãšã€Kè¿‘å‚æ³•ã«ã‚ˆã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚åŸè‘—ã®è¨˜æ³•ã‚’ã»ã¼è¸è¥²ã—ã¦ã„ã¾ã™ã€‚ ã‚¿ã‚¤ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ³ã‚°ãŒå°‘ã—é‡è¤‡ã—ãŸæ›¸ãæ–¹ã«ãªã£ã¦ã„ã‚‹ã®ãŒæ®‹å¿µã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> LinearAlgebra, StatsBase
<span class=hljs-keyword >function</span> knn(X_train::<span class=hljs-built_in >Matrix</span>,y_train::<span class=hljs-built_in >Vector</span>,X_test::<span class=hljs-built_in >Vector</span>, k)
    n = size(X_train)[<span class=hljs-number >1</span>]
    distance = [norm(X_train[i,:]-X_test) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n]
    S = sortperm(distance)[<span class=hljs-number >1</span>:k]
    u = counts(y_train[S], <span class=hljs-number >1</span>:k)
    u_max = maximum(u)
    m = findall(c-&gt;c==u_max,u)
    <span class=hljs-keyword >while</span> length(m)!==<span class=hljs-number >1</span> <span class=hljs-comment >#ã‚¿ã‚¤ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ³ã‚°</span>
        k -=<span class=hljs-number >1</span>
        S = S[<span class=hljs-number >1</span>:k]
        u = counts(S, <span class=hljs-number >1</span>:k)
        u_max = maximum(u)
        m = findall(c-&gt;c==u_max,u)
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> m[<span class=hljs-number >1</span>]
<span class=hljs-keyword >end</span></code></pre>
<p>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒè¤‡æ•°ã®å ´åˆã¯å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã§å¯¾å¿œã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> knn(X_train::<span class=hljs-built_in >Matrix</span>,y_train::<span class=hljs-built_in >Vector</span>,X_test::<span class=hljs-built_in >Matrix</span>, k)
    l = size(X_test)[<span class=hljs-number >1</span>]
    w = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Int</span>}(<span class=hljs-literal >undef</span>,l)
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:l
        w[i] = knn(X_train,y_train,X_test[i,:], k)
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> w
<span class=hljs-keyword >end</span></code></pre>
<h3 id="ä¾‹37_fisherã®ã‚ã‚„ã‚_returns"><a href="#ä¾‹37_fisherã®ã‚ã‚„ã‚_returns">ä¾‹37 Fisherã®ã‚ã‚„ã‚ returns</a></h3>
<p>ä¾‹36ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦Kè¿‘å‚æ³•ã§ã‚„ã£ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe:knn,table_count
y_pred_knn = knn(X_train,y_train,X_test,<span class=hljs-number >3</span>)
table_count(y_test,y_pred_knn)</code></pre><pre><code class="plaintext hljs">3Ã—3 Array{Int64,2}:
 29   0   0
  0  22   3
  0   1  20</code></pre>
<p>ã“ã®ä¹±æ•°ã®ç¨®ã®å ´åˆã ã¨ã€äºŒæ¬¡åˆ¤åˆ¥ã¨ãã‚Œã»ã©ç²¾åº¦ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<h2 id="rocæ›²ç·š"><a href="#rocæ›²ç·š">ROCæ›²ç·š</a></h2>
<h3 id="ä¾‹38"><a href="#ä¾‹38">ä¾‹38</a></h3>
<p>x, y ã¨ã„ã†è¡¨è¨˜ã¯positive, negativeã« æ·»ãˆå­—ã‚’é™½æ€§ã‚’p&#40;positive&#41;, é™°æ€§ã‚’n&#40;negative&#41;ã«å¤‰ãˆã¦ã„ã¾ã™ã€‚ ã¾ãŸã€varã¯Ïƒã«å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, Plots
Î¼â‚š = <span class=hljs-number >1</span>; Î¼â‚™ = -<span class=hljs-number >1</span>
Ïƒâ‚š=<span class=hljs-number >1</span>; Ïƒâ‚™ =<span class=hljs-number >1</span>
Nâ‚š = <span class=hljs-number >1000</span>; Nâ‚™ = <span class=hljs-number >10000</span>
positive = rand(Normal(Î¼â‚š,Ïƒâ‚š),Nâ‚š)
negative = rand(Normal(Î¼â‚™,Ïƒâ‚™),Nâ‚™)
Î¸ = exp.(-<span class=hljs-number >10</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >100</span>);
U = <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>,length(Î¸))
V = <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>,length(Î¸))
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:length(Î¸)
    U[i] = sum(@. pdf(Normal(Î¼â‚š,Ïƒâ‚š),negative) / pdf(Normal(Î¼â‚™,Ïƒâ‚™),negative) &gt; Î¸[i]) / Nâ‚™
    V[i] = sum(@. pdf(Normal(Î¼â‚š,Ïƒâ‚š),positive) / pdf(Normal(Î¼â‚™,Ïƒâ‚™),positive) &gt; Î¸[i]) / Nâ‚š
<span class=hljs-keyword >end</span>

AUC = <span class=hljs-number >0</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:length(Î¸)-<span class=hljs-number >1</span>
    AUC += abs(U[i+<span class=hljs-number >1</span>]-U[i])*V[i]
<span class=hljs-keyword >end</span>
p38 = plot(U,V,xlabel=<span class=hljs-string >&quot;False Positive&quot;</span>,ylabel=<span class=hljs-string >&quot;False Negative&quot;</span>,
            title=<span class=hljs-string >&quot;ROC curve&quot;</span>,legend=<span class=hljs-literal >false</span>,
            ann = (<span class=hljs-number >0.5</span>,<span class=hljs-number >0.5</span>,<span class=hljs-string >&quot;AUC = <span class=hljs-subst >$(round(AUC,digits=<span class=hljs-number >2</span>)</span>)&quot;</span>))</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-6.svg" alt="">
  <p style="text-align:right">  ã‚ã§ãŸã—ã‚ã§ãŸã— </p>  <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p>
<div class=page-foot >
  <div class=copyright >
    &copy; Kei Hanafusa. Last modified: December 30, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/Joe.jl/libs/vela/slideout.min.js"></script>
  <script src="/Joe.jl/libs/myBtn/myBtn.js"></script>
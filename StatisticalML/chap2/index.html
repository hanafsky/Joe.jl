<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="css/magnific-popup.css" /> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•ã‚’juliaã§ã‚„ã‚‹ </title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">ãƒˆãƒƒãƒ—</a> <li><a href="" class=has-arrow >çµ±è¨ˆçš„æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">ç¬¬ä¸€ç« ã€€ç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap2/">ç¬¬äºŒç« ã€€åˆ†é¡</a> <li><a href="/Joe.jl/StatisticalML/chap3/">ç¬¬ä¸‰ç« ã€€ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</a> <li><a href="/Joe.jl/StatisticalML/chap4/">ç¬¬å››ç« ã€€æƒ…å ±é‡åŸºæº–</a> <li><a href="/Joe.jl/StatisticalML/chap5/">ç¬¬äº”ç« ã€€æ­£å‰‡åŒ–</a> <li><a href="/Joe.jl/StatisticalML/chap6/">ç¬¬å…­ç« ã€€éç·šå½¢å›å¸°</a> <li><a href="/Joe.jl/StatisticalML/chap7/">ç¬¬ä¸ƒç« ã€€æ±ºå®šæœ¨</a> </ul> <li><a href="" class=has-arrow >ã‚¹ãƒ‘ãƒ¼ã‚¹æ¨å®š100å•</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">åˆ†é¡</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</a><ol><li><a href="#ä¾‹29">ä¾‹29</a></ol><li><a href="#ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•">ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ»ãƒ©ãƒ•ã‚½ãƒ³æ³•</a><ol><li><a href="#ä¾‹31">ä¾‹31</a><li><a href="#ä¾‹31__2">ä¾‹31</a><li><a href="#ä¾‹33">ä¾‹33</a><li><a href="#ä¾‹34">ä¾‹34</a></ol><li><a href="#23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥">2.3 ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥</a><ol><li><a href="#ä¾‹35">ä¾‹35</a><li><a href="#ä¾‹36_fisherã®ã‚ã‚„ã‚">ä¾‹36 &#40;Fisherã®ã‚ã‚„ã‚&#41;</a><li><a href="#å•29_äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ">å•29 äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ</a></ol><li><a href="#kè¿‘å‚æ³•">Kè¿‘å‚æ³•</a><ol><li><a href="#ä¾‹37_fisherã®ã‚ã‚„ã‚_returns">ä¾‹37 Fisherã®ã‚ã‚„ã‚ returns</a></ol><li><a href="#rocæ›²ç·š">ROCæ›²ç·š</a><ol><li><a href="#ä¾‹38">ä¾‹38</a></ol></ol></div> <h2 id="ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°"><a href="#ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°" class=header-anchor >ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</a></h2> <h3 id="ä¾‹29"><a href="#ä¾‹29" class=header-anchor >ä¾‹29</a></h3> <p>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p> <pre><code class=language-julia >sigmoid&#40;x::Matrix, Î²::Vector&#41; &#61; 1 / &#40;1 &#43; exp&#40;-x*Î²&#41;&#41;</code></pre>
<pre><code class=language-julia >using Joe, Plots
p29 &#61; plot&#40;xlims&#61;&#40;-10,10&#41;, xlabel&#61;&quot;x&quot;,ylabel&#61;&quot;P&#40;Y&#61;1|x&#41;&quot;,
            legend&#61;:topleft, title&#61;&quot;ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ›²ç·š&quot;&#41;
x29 &#61; insert_ones&#40;-10:0.1:10&#41;
for i in &#91;0, 0.2, 0.5, 1, 2, 10&#93;
    plot&#33;&#40;p29, x29&#91;:,2&#93;, Joe.sigmoid&#40;x29,&#91;0,i&#93;&#41;,label&#61;&quot;&#36;i&quot;&#41;
end</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-1.svg" alt="">
<h2 id="ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•"><a href="#ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•" class=header-anchor >ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ»ãƒ©ãƒ•ã‚½ãƒ³æ³•</a></h2>
<h3 id="ä¾‹31"><a href="#ä¾‹31" class=header-anchor >ä¾‹31</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x^2-1=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã‚’4ã‚’åˆæœŸå€¤ã¨ã—ã¦æ•°å€¤è¨ˆç®—ã§è§£ãå•é¡Œã€‚10å›ã§ã©ã®ç¨‹åº¦è¿‘ã¥ãã‹ã€‚ ã›ã£ã‹ããªã®ã§ã€ å¾®åˆ†ã‚’ã‚ã‚‰ã‚ã«æ›¸ãä¸‹ã™ã®ã§ã¯ãªãã¦ã€è‡ªå‹•å¾®åˆ†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ è¦‹ãŸç›®ãŒ<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>â†</mo><mi>x</mi><mo>âˆ’</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mrow><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">x \leftarrow x - \dfrac{f(x)}{f&#x27;(x)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã¨ã„ã†å…¬å¼ã®ã¾ã‚“ã¾ã§ã™ã­ã€‚</p>
<pre><code class=language-julia >using Zygote
f&#40;x&#41; &#61; x^2 -1
x&#61;4
for i in 1:10
    x -&#61; f&#40;x&#41;/f&#39;&#40;x&#41;
    println&#40;x&#41;
end</code></pre><pre><code class="plaintext code-output">2.125
1.2977941176470589
1.0341661806365605
1.0005643811996305
1.0000001591732348
1.0000000000000127
1.0
1.0
1.0
1.0
</code></pre>
<h3 id="ä¾‹31__2"><a href="#ä¾‹31__2" class=header-anchor >ä¾‹31</a></h3>
<p>2å¤‰æ•°é–¢æ•°ãŒ2ã¤ã‚ã‚‹å ´åˆã€‚ Zygote.jlã«jacobianãŒãªã‹ã£ãŸã®ã§ã€ForwardDiff.jlã‚’ä½¿ã£ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >using ForwardDiff

f&#40;x,y&#41; &#61; &#91;x^2&#43;y^2-1, x&#43;y&#93;
z &#61; &#91;3,4&#93;
for i in 1:10
    z -&#61; ForwardDiff.jacobian&#40;x-&gt;f&#40;x&#91;1&#93;, x&#91;2&#93;&#41;,z&#41; \ f&#40;z&#91;1&#93;,z&#91;2&#93;&#41;
    println&#40;z&#41;
end</code></pre><pre><code class="plaintext code-output">[-13.000000000000004, 13.000000000000002]
[-6.519230769230771, 6.519230769230771]
[-3.297963467211255, 3.297963467211255]
[-1.7247860905930625, 1.7247860905930625]
[-1.0073385555621193, 1.0073385555621193]
[-0.7518480044063836, 0.7518480044063836]
[-0.7084380190454468, 0.7084380190454468]
[-0.7071080319623313, 0.7071080319623313]
[-0.7071067811876538, 0.7071067811876538]
[-0.7071067811865475, 0.7071067811865475]
</code></pre>
<h3 id="ä¾‹33"><a href="#ä¾‹33" class=header-anchor >ä¾‹33</a></h3>
<p>æœ€å°¤æ¨å®šã«ã‚ˆã‚Šãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã‚’è¡Œã†å•é¡Œã€‚ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >âˆ‡</mi><mi>l</mi><mo stretchy=false >(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo separator=true >,</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nabla l(\beta_0, \beta) = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >âˆ‡</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã‚’æ±‚ã‚ã‚‹å•é¡Œã‚’è§£ã„ã¦ã¿ã‚‹ã€‚</p>
<pre><code class=language-julia >using Joe, Random, LinearAlgebra
using Plots
N&#61;1000; p&#61;2; Random.seed&#33;&#40;1&#41;
X &#61; insert_ones&#40;randn&#40;N,p&#41;&#41;
Î² &#61; randn&#40;p&#43;1&#41;
prob &#61; @. 1/&#40;1 &#43; exp&#40;&#36;*&#40;X,Î²&#41;&#41;&#41;
threshold&#61;0.5
y &#61; ifelse.&#40;rand&#40;N&#41; .&gt; prob,1,-1&#41; # ã“ã“ã¾ã§ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
@show y Î²;</code></pre><pre><code class="plaintext code-output">y = [-1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, 1, 1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, -1, 1, 1, 1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, -1, -1, -1, -1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1]
Î² = [-0.8743656729822114, -1.945231200473885, 1.6388761704740658]
</code></pre>
<p>ã›ã£ã‹ããªã®ã§ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >data1 &#61; X&#91;y .&#61;&#61; 1, 2:3&#93;
data2 &#61; X&#91;y .&#61;&#61; -1, 2:3&#93;
p33&#61;scatter&#40;data1&#91;:,1&#93;,data1&#91;:,2&#93;,ylims&#61;&#40;-5,5&#41;,marker&#61;:auto, label&#61;&quot;y&#61;1&quot;&#41;
scatter&#33;&#40;p33,data2&#91;:,1&#93;,data2&#91;:,2&#93;,marker&#61;:auto,label&#61;&quot;y&#61;-1&quot;&#41;
plot&#33;&#40;p33,x-&gt; -Î²&#91;1&#93;/Î²&#91;3&#93; - Î²&#91;2&#93;/Î²&#91;3&#93;*x, label&#61;&quot;Î²&quot;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2.svg" alt="">
<pre><code class=language-julia >Î³ &#61; randn&#40;2&#43;1&#41; #åˆæœŸå€¤
Î³2 &#61; copy&#40;Î³&#41; #åˆ¥è§£ç”¨ã«ã‚³ãƒ”ãƒ¼
@show Î³
W&#40;v::Vector&#41; &#61; @.&#40;v/&#40;1&#43; v&#41;^2&#41; |&gt; diagm
t &#61; true
for i in 1:10
    global Î³
    s&#61;X*Î³
    v &#61; @. exp&#40;-y*s&#41;
    u &#61; @. y*v/&#40;1&#43;v&#41;
    Î³ &#43;&#61; &#40;&#40;X&#39;*W&#40;v&#41;*X&#41; \ X&#39;&#41; * u
    #Î´&#39;*Î´ &lt; 0.001 &amp;&amp; &#40;t &#61; false&#41;
    @show Î³
end
plot&#33;&#40;x-&gt; -Î³&#91;1&#93;/Î³&#91;3&#93; - Î³&#91;2&#93;/Î³&#91;3&#93;*x, label&#61;&quot;Î³&quot;&#41;</code></pre><pre><code class="plaintext code-output">Î³ = [-0.9588319286678549, -2.142965143840243, 0.49000586969362697]
Î³ = [-0.6868290426397672, -1.490557450602416, 1.3181038933475095]
Î³ = [-0.838957828687075, -1.8133142733288052, 1.4260329338938003]
Î³ = [-0.8649335248084838, -1.871868634791574, 1.4560345475721008]
Î³ = [-0.8656536058114845, -1.8735243209383907, 1.4570217428831782]
Î³ = [-0.8656541720759061, -1.8735256324938316, 1.4570225945617943]
Î³ = [-0.8656541720762697, -1.873525632494675, 1.4570225945623723]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³ = [-0.8656541720762697, -1.873525632494675, 1.4570225945623723]
Î³ = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³ = [-0.8656541720762697, -1.873525632494675, 1.4570225945623723]
Plot{Plots.GRBackend() n=4}</code></pre>
<p>ä»Šåº¦ã¯æ¨ªç€ã‚’ã—ã¦ã€ãƒ˜ã‚·ã‚¢ãƒ³ã‚’ä½¿ã£ã¦è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Zygote, LinearAlgebra
l&#40;Î³,X&#61;X,y&#61;y&#41; &#61; sum&#40;@. log&#40; 1 /&#40;1&#43;exp&#40;*&#40;&#36;*&#40;X,Î³&#41;,-y&#41;&#41;&#41;&#41;&#41; #å¯¾æ•°å°¤åº¦é–¢æ•°

for i in 1:10
    global Î³2
    Î´ &#61;  Zygote.hessian&#40;l,Î³2&#41; \ l&#39;&#40;Î³2&#41;
    Î³2 -&#61; Î´
    @show Î³2
end

plot&#33;&#40;p33,x-&gt; -Î³2&#91;1&#93;/Î³2&#91;3&#93; - Î³2&#91;2&#93;/Î³2&#91;3&#93;*x, label&#61;&quot;Î³2&quot;&#41;</code></pre><pre><code class="plaintext code-output">Î³2 = [-0.6868290426397674, -1.4905574506024166, 1.3181038933475095]
Î³2 = [-0.8389578286870754, -1.8133142733288061, 1.4260329338938007]
Î³2 = [-0.864933524808484, -1.8718686347915743, 1.4560345475721008]
Î³2 = [-0.8656536058114844, -1.8735243209383907, 1.457021742883178]
Î³2 = [-0.8656541720759061, -1.8735256324938316, 1.4570225945617945]
Î³2 = [-0.8656541720762696, -1.8735256324946747, 1.4570225945623723]
Î³2 = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³2 = [-0.8656541720762696, -1.8735256324946747, 1.4570225945623723]
Î³2 = [-0.8656541720762697, -1.8735256324946747, 1.4570225945623725]
Î³2 = [-0.8656541720762696, -1.8735256324946747, 1.4570225945623723]
</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2-2.svg" alt=""> <div class=blank ></div> ã ã„ãŸã„åŒã˜ã‚ˆã†ãªå¢ƒç•Œç·šãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚</p>
<h3 id="ä¾‹34"><a href="#ä¾‹34" class=header-anchor >ä¾‹34</a></h3>
<p>ãƒ‡ãƒ¼ã‚¿ã®åŠåˆ†ã‚’ä½¿ã£ã¦ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã§å­¦ç¿’ã—ã€æ®‹ã‚Šã®ãƒ‡ãƒ¼ã‚¿ã§æ¤œè¨¼ã™ã‚‹ç·´ç¿’ã€‚ ã¾ãšãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Joe, Random, Distributions, Plots, LinearAlgebra
Random.seed&#33;&#40;123&#41;
n&#61;100
x34 &#61; vcat&#40;randn&#40;n&#41;.&#43;1,randn&#40;n&#41;.-1&#41; |&gt; insert_ones
y34 &#61; vcat&#40;ones&#40;n&#41;,-ones&#40;n&#41;&#41;;</code></pre>
<p>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¦å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >index &#61; sample&#40;1:2n,2n,replace&#61;false&#41;; #ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œã‚Š
train &#61; index&#91;begin:n&#93;;# å­¦ç¿’ç”¨ã¨ãƒ†ã‚¹ãƒˆç”¨ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ†ã‘ã‚‹ã€‚
test &#61; index&#91;n&#43;1:end&#93;;
X_train &#61; x34&#91;train,:&#93;;y_train &#61; y34&#91;train&#93;
X_test &#61; x34&#91;test,:&#93;;y_test &#61; y34&#91;test&#93;
p34 &#61; scatter&#40;X_train&#91;:,2&#93;,y_train,label&#61;&quot;train&quot;&#41;
scatter&#33;&#40;p34,X_test&#91;:,2&#93;,y_test,label&#61;&quot;test&quot;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2-3.svg" alt=""> <div class=blank ></div> <div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content ><p><strong>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã‚‹æ–¹æ³•</strong></p>
<p>åŸè‘—ã®pythonã‚³ãƒ¼ãƒ‰ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
<pre><code class=language-python >import numpy as np
train &#61; np.random.choice&#40;2*n, int&#40;n&#41;, replace&#61;false&#41;
test &#61; list&#40;set&#40;range&#40;n&#41;&#41;-set&#40;train&#41;&#41;</code></pre>
<p>setã‚’ä½¿ã£ãŸæ›¸ãæ–¹ã¯ä¾¿åˆ©ã§ã™ãŒã€juliaã§ã¯é‡è¤‡ã‚’è¨±ã•ãšã«ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã¹ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’äºŒã¤ã«åˆ†ã‘ã‚‹ æ–¹æ³•ã‚’ä½¿ã„ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >using StatsBase
index &#61; sample&#40;1:n,n,replace&#61;false&#41;;
train &#61; index&#91;begin:Int&#40;n/2&#41;&#93;;
test &#61; index&#91;Int&#40;n/2&#41;&#43;1:end&#93;;</code></pre>
<p>ã§ã‚‚ã‚ˆãè€ƒãˆã‚‹ã¨setdiffã‚’ä½¿ãˆã°ååˆ†ã§ã—ãŸã€‚</p>
<pre><code class=language-julia >train &#61; sample&#40;1:2n,n,replace&#61;false&#41;; test &#61; setdiff&#40;1:2n,train&#41;</code></pre></div></div> ãƒ«ãƒ¼ãƒ—ã¯åŸè‘—ã®æ–¹æ³•ã«å¾“ã„ã¾ã—ãŸã€‚</p>
<pre><code class=language-julia >Î² &#61; &#91;0,0&#93; #åˆæœŸå€¤
Î³ &#61; randn&#40;2&#41;
while sum&#40;Î²-Î³&#41;^2 &gt; 0.001
    global Î², Î³
    local W
    Î² &#61; Î³
    s &#61; X_train*Î²
    v &#61; @. exp&#40;-s*y_train&#41;
    u &#61; @. y_train*v/&#40;1&#43;v&#41;
    w &#61; @. v/&#40;1&#43;v&#41;^2
    W &#61; diagm&#40;w&#41;
    z &#61; @. s &#43; u/w
    Î³ &#61; &#40;X_train&#39;*W*X_train&#41;\&#40;X_train&#39;*W*z&#41;
    @show Î³;
end</code></pre><pre><code class="plaintext code-output">Î³ = [-0.023534241071816894, 1.8766480785201571]
Î³ = [-0.07828495029120094, 1.9944827788964863]
Î³ = [-0.08145979626652322, 2.00413602477381]
</code></pre>
<p>æ¬¡ã«ã“ã®Î³ã‚’ä½¿ã£ã¦ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’äºˆæ¸¬ã—ã¦ã¿ã¾ã™ã€‚ æ­£èª¤ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹é–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >function table_count&#40;test,pred&#41;
    @assert length&#40;test&#41; &#61;&#61; length&#40;pred&#41;
    m &#61; unique&#40;test&#41; |&gt; length
    count &#61; zeros&#40;Int,m,m&#41;
    for i in 1:length&#40;test&#41;
        count&#91;test&#91;i&#93;,pred&#91;i&#93;&#93; &#43;&#61; 1
    end
    return count
end</code></pre>
<pre><code class=language-julia >using Joe:table_count
y_pred &#61; X_test*Î³ .|&gt; x -&gt; ifelse&#40;x&gt;0,2,1&#41;
y_answer &#61; y_test .|&gt; x -&gt; ifelse&#40;x&gt;0,2,1&#41;
table &#61; table_count&#40;y_answer,y_pred&#41;
@show table;
æ­£ç­”ç‡ &#61; sum&#40;diag&#40;table&#41;&#41; / sum&#40;table&#41;</code></pre><pre><code class="plaintext code-output">table = [38 11; 7 44]
0.82</code></pre>
<h2 id="23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥"><a href="#23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥" class=header-anchor >2.3 ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥</a></h2>
<h3 id="ä¾‹35"><a href="#ä¾‹35" class=header-anchor >ä¾‹35</a></h3>
<p>ã¾ãšã¯ä¸ãˆã‚‰ã‚ŒãŸå¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‹ã‚‰äºŒæ¬¡å…ƒæ­£è¦åˆ†å¸ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’2ç¨®é¡ç”Ÿæˆã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Distributions, Random,Plots, LinearAlgebra, Parameters
Î¼â‚&#61;&#91;2,2&#93;;  Î£â‚ &#61; &#91;2 0; 0 2&#93;
Î¼â‚‚&#61;&#91;-3,-3&#93;; Î£â‚‚ &#61; &#91;1 -0.8; -0.8 1&#93;

N &#61; 100;Random.seed&#33;&#40;123&#41;
data1 &#61; rand&#40;MvNormal&#40;Î¼â‚,Î£â‚&#41;,100&#41; |&gt; transpose
data2 &#61; rand&#40;MvNormal&#40;Î¼â‚‚,Î£â‚‚&#41;,100&#41; |&gt; transpose
p35 &#61; scatter&#40;data1&#91;:,1&#93;,data1&#91;:,2&#93;&#41;
scatter&#33;&#40;p35, data2&#91;:,1&#93;,data2&#91;:,2&#93;&#41;</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-3.svg" alt=""> <div class=blank ></div> ã“ã“ã¾ã§ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã€‚ ç”Ÿæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®—ã™ã‚‹ã€‚</p>
<pre><code class=language-julia >Î¼Ì‚â‚ &#61; mean&#40;data1,dims&#61;1&#41;&#39;; Î£Ì‚â‚ &#61; cov&#40;data1,dims&#61;1&#41;;
Î¼Ì‚â‚‚ &#61; mean&#40;data2,dims&#61;1&#41;&#39; ; Î£Ì‚â‚‚ &#61; cov&#40;data2,dims&#61;1&#41;;</code></pre>
<p><div class=warning ><div class=title >ğŸ˜• Warning&#33;</div>
<div class=content >meané–¢æ•°ã§è¡Œåˆ—ã®åˆ—æ–¹å‘ã®å¹³å‡ã‚’ã¨ã‚‹æ™‚ã€å¾—ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯äºŒæ¬¡å…ƒã®æ¨ªãƒ™ã‚¯ãƒˆãƒ«ã«ãªã£ã¦ã„ã‚‹ã€‚ ç¸¦ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦æ‰±ã„ãŸã„ã®ã§ã€è»¢ç½®&#40;æ­£ç¢ºã«ã¯è¤‡ç´ å…±å½¹ï¼‰ã‚’ã—ã¦ã„ã‚‹ã€‚</div></div> ãã‚Œãã‚Œã®åˆ†å¸ƒã®æƒ…å ±ã‚’è¤‡åˆå‹ã«ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class=language-julia >@with_kw struct QDA
    Î¼::Array # å¹³å‡
    Î£::Matrix # åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—
    invÎ£::Array &#61; inv&#40;Î£&#41; # åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®é€†è¡Œåˆ—
    detÎ£ &#61; det&#40;Î£&#41; # åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®è¡Œåˆ—å¼
end</code></pre>
<p><div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content >ã—ã‚Œã£ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ãŸè¤‡åˆå‹ã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€ã“ã“ã§ã¯Parameters.jlã¨ã„ ã†ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚</div></div> ã¾ãŸã€å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®å¯¾æ•°å°¤åº¦ã‚’å–å¾—ã™ã‚‹é–¢æ•°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚ ã“ã“ã§ã¯ã€juliaã®function-like objectã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ ã¾ãŸã€å¯å¤‰é•·å¼•æ•°&#40;x...&#41;ã‚’åˆ©ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãŒ3æ¬¡å…ƒä»¥ä¸Šã®å ´åˆã«ã‚‚æ‹¡å¼µã—ã¦ã„ã¾ã™ã€‚ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»˜ãå¼•æ•°ã«äº‹å‰ç¢ºç‡ã‚’åŠ ãˆã¦ã„ã¾ã™ã€‚ <div class=note ><div class=title >ğŸ˜² Note</div>
<div class=content >function-like objectã®æ©Ÿèƒ½ã‚’ä½¿ã†ã¨ã€è¤‡åˆå‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’é–¢æ•°ã®ã‚ˆã†ã« ä½¿ã†ã“ã¨ãŒã§ãã€å†åˆ©ç”¨ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚</div></div></p>
<pre><code class=language-julia >function &#40;qda::QDA&#41;&#40;x...,prior&#61;1.0&#41;
    data &#61; collect&#40;x&#41;
    @unpack Î¼,invÎ£,detÎ£ &#61; qda
    a &#61; -0.5*&#40;data-Î¼&#41;&#39; * invÎ£ * &#40;data-Î¼&#41;
    a&#91;1&#93; - log&#40;detÎ£&#41; - log&#40;prior&#41;
end</code></pre>
<pre><code class=language-julia >using Joe: QDA
param1&#61;QDA&#40;Î¼&#61; Î¼Ì‚â‚,Î£ &#61; Î£Ì‚â‚&#41;;param2&#61;QDA&#40;Î¼ &#61; Î¼Ì‚â‚‚,Î£ &#61; Î£Ì‚â‚‚&#41;

hanbetsu&#40;x,y&#41; &#61; param1&#40;x,y&#41; - param2&#40;x,y&#41;
x35&#61;-5:0.1:5;y35&#61;-5:0.1:5;
scatter&#40;data1&#91;:,1&#93;,data1&#91;:,2&#93;&#41;
scatter&#33;&#40; data2&#91;:,1&#93;,data2&#91;:,2&#93;&#41;
p35_2&#61;contour&#33;&#40;x35,y35, hanbetsu.&#40;x35,y35&#39;&#41;, title&#61;&quot;QDA&quot;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-4.svg" alt="">
<p>ç·šå½¢åˆ¤åˆ¥ã‚’è¡Œã†å ´åˆã¯ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ãŒç­‰ã—ã„ã“ã¨ã‚’ä»®å®šã—ã¾ã™ã€‚ data1ã¨data2ã‚’ã€ãã‚Œãã‚Œä¸­å¿ƒåŒ–å¾Œã«çµ±åˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦ã€ æ–°ãŸãªåˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ±‚ã‚ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >Î£_L &#61;  vcat&#40;data1 .- Î¼Ì‚â‚&#39; , data2 .- Î¼Ì‚â‚‚&#39;&#41; |&gt; cov
param1_L&#61;QDA&#40;Î¼&#61; Î¼Ì‚â‚,Î£ &#61;Î£_L &#41;;param2_L&#61;QDA&#40;Î¼ &#61; Î¼Ì‚â‚‚,Î£ &#61; Î£_L&#41;
hanbetsu_L&#40;x,y&#41; &#61; param1_L&#40;x,y&#41; - param2_L&#40;x,y&#41;
p35_3&#61;contour&#33;&#40;p35,x35,y35, hanbetsu_L.&#40;x35,y35&#39;&#41;, title&#61;&quot;LDA&quot;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-5.svg" alt="">
<h3 id="ä¾‹36_fisherã®ã‚ã‚„ã‚"><a href="#ä¾‹36_fisherã®ã‚ã‚„ã‚" class=header-anchor >ä¾‹36 &#40;Fisherã®ã‚ã‚„ã‚&#41;</a></h3>
<p>ã¾ãšRDatasetsã‹ã‚‰irisã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >using ScikitLearn, StatsBase, Random
using Joe:QDA
@sk_import datasets: load_iris
iris &#61; load_iris&#40;&#41;
x &#61; iris&#91;&quot;data&quot;&#93;
y &#61; iris&#91;&quot;target&quot;&#93;</code></pre><pre><code class="plaintext code-output">150-element Vector{Int64}:
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 0
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2</code></pre>
<p>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¾ã™ã€‚</p>
<pre><code class=language-julia >Random.seed&#33;&#40;123&#41;
n &#61; length&#40;y&#41;
index &#61; sample&#40;1:n,n,replace&#61;false&#41;; #ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œã‚Š
train &#61; index&#91;begin:Int&#40;n/2&#41;&#93;;# å­¦ç¿’ç”¨ã¨ãƒ†ã‚¹ãƒˆç”¨ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ†ã‘ã‚‹ã€‚
test &#61; index&#91;Int&#40;n/2&#41;&#43;1:end&#93;;
X_train&#61; x&#91;train,:&#93;; X_test &#61; x&#91;test,:&#93;;
y_train &#61; y&#91;train&#93;; y_test &#61; y&#91;test&#93;;</code></pre>
<p>ãã‚Œãã‚Œã®ã‚ã‚„ã‚ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ±‚ã‚ã¦ä¿å­˜ã™ã‚‹ã€‚</p>
<pre><code class=language-julia >Params &#61; QDA&#91;&#93;
for i in 1:3
    Î¼,Î£ &#61;  mean_and_cov&#40;X_train&#91;y_train .&#61;&#61;i,:&#93;&#41;
    push&#33;&#40;Params, QDA&#40;Î¼&#61;Î¼&#39;, Î£&#61;Î£&#41;&#41; #Î¼ã¯è¡Œãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„
end</code></pre><pre><code class="plaintext code-output">LinearAlgebra.LAPACKException(1)
</code></pre>
<p>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§æ¤œè¨¼ã™ã‚‹ã€‚å¯¾æ•°å°¤åº¦ã‚’æœ€å¤§åŒ–ã™ã‚‹ãƒ©ãƒ™ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >y_pred &#61; similar&#40;y_test&#41;
for i in 1:length&#40;y_test&#41;
    y_pred&#91;i&#93; &#61; argmax&#40;&#91;param&#40;X_test&#91;i,:&#93;...&#41; for param in Params&#93;&#41;
end

using Joe:table_count
table_count&#40;y_test,y_pred&#41;</code></pre><pre><code class="plaintext code-output">BoundsError: attempt to access 3Ã—3 Matrix{Int64} at index [0, 1]
</code></pre>
<h3 id="å•29_äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ"><a href="#å•29_äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ" class=header-anchor >å•29 äº‹å‰ç¢ºç‡ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆ</a></h3>
<p>ã‚ã‚„ã‚ã®äº‹å‰ç¢ºç‡ãŒ&#91;0.5,0.25,0.25&#93;ã ã£ãŸã¨ãã¯ã€å¯¾æ•°ã‚’ã¨ã£ã¦è¶³ã›ã°è‰¯ã„ã§ã—ã‚‡ã†ã€‚ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»˜ãå¼•æ•°ã§äº‹å‰ç¢ºç‡ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã—ãŸã®ã§ã€ å°‘ã—æ›¸ãæ›ãˆã‚‹ã ã‘ã§å¯¾å¿œå¯èƒ½ã§ã™ã€‚ä»Šå›ã®å ´åˆã€äºˆæ¸¬çµæœã«å¯¾ã—ã¦å½±éŸ¿ã¯å°‘ãªã„ã‚ˆã†ã§ã™ã€‚</p>
<pre><code class=language-julia >priors &#61; &#91;0.5,0.25,0.25&#93;
y_pred2 &#61; similar&#40;y_test&#41;
for i in 1:length&#40;y_test&#41;
    y_pred2&#91;i&#93; &#61; argmax&#40;&#91;Params&#91;j&#93;&#40;X_test&#91;i,:&#93;...;prior&#61;priors&#91;j&#93;&#41; for j in 1:3&#93;&#41;
end
table_count&#40;y_test,y_pred2&#41;</code></pre><pre><code class="plaintext code-output">BoundsError: attempt to access 2-element Vector{Joe.QDA} at index [3]
</code></pre>
<h2 id="kè¿‘å‚æ³•"><a href="#kè¿‘å‚æ³•" class=header-anchor >Kè¿‘å‚æ³•</a></h2>
<p>ã¾ãšã€Kè¿‘å‚æ³•ã«ã‚ˆã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚åŸè‘—ã®è¨˜æ³•ã‚’ã»ã¼è¸è¥²ã—ã¦ã„ã¾ã™ã€‚ ã‚¿ã‚¤ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ³ã‚°ãŒå°‘ã—é‡è¤‡ã—ãŸæ›¸ãæ–¹ã«ãªã£ã¦ã„ã‚‹ã®ãŒæ®‹å¿µã€‚</p>
<pre><code class=language-julia >using LinearAlgebra, StatsBase
function knn&#40;X_train::Matrix,y_train::Vector,X_test::Vector, k&#41;
    n &#61; size&#40;X_train&#41;&#91;1&#93;
    distance &#61; &#91;norm&#40;X_train&#91;i,:&#93;-X_test&#41; for i in 1:n&#93;
    S &#61; sortperm&#40;distance&#41;&#91;1:k&#93;
    u &#61; counts&#40;y_train&#91;S&#93;, 1:k&#41;
    u_max &#61; maximum&#40;u&#41;
    m &#61; findall&#40;c-&gt;c&#61;&#61;u_max,u&#41;
    while length&#40;m&#41;&#33;&#61;&#61;1 #ã‚¿ã‚¤ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ³ã‚°
        k -&#61;1
        S &#61; S&#91;1:k&#93;
        u &#61; counts&#40;S, 1:k&#41;
        u_max &#61; maximum&#40;u&#41;
        m &#61; findall&#40;c-&gt;c&#61;&#61;u_max,u&#41;
    end
    return m&#91;1&#93;
end</code></pre>
<p>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒè¤‡æ•°ã®å ´åˆã¯å¤šé‡ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã§å¯¾å¿œã—ã¾ã™ã€‚</p>
<pre><code class=language-julia >function knn&#40;X_train::Matrix,y_train::Vector,X_test::Matrix, k&#41;
    l &#61; size&#40;X_test&#41;&#91;1&#93;
    w &#61; Array&#123;Int&#125;&#40;undef,l&#41;
    for i in 1:l
        w&#91;i&#93; &#61; knn&#40;X_train,y_train,X_test&#91;i,:&#93;, k&#41;
    end
    return w
end</code></pre>
<h3 id="ä¾‹37_fisherã®ã‚ã‚„ã‚_returns"><a href="#ä¾‹37_fisherã®ã‚ã‚„ã‚_returns" class=header-anchor >ä¾‹37 Fisherã®ã‚ã‚„ã‚ returns</a></h3>
<p>ä¾‹36ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦Kè¿‘å‚æ³•ã§ã‚„ã£ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Joe:knn,table_count
y_pred_knn &#61; knn&#40;X_train,y_train,X_test,3&#41;
table_count&#40;y_test,y_pred_knn&#41;</code></pre><pre><code class="plaintext code-output">BoundsError: attempt to access 3Ã—3 Matrix{Int64} at index [0, 1]
</code></pre>
<p>ã“ã®ä¹±æ•°ã®ç¨®ã®å ´åˆã ã¨ã€äºŒæ¬¡åˆ¤åˆ¥ã¨ãã‚Œã»ã©ç²¾åº¦ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<h2 id="rocæ›²ç·š"><a href="#rocæ›²ç·š" class=header-anchor >ROCæ›²ç·š</a></h2>
<h3 id="ä¾‹38"><a href="#ä¾‹38" class=header-anchor >ä¾‹38</a></h3>
<p>x, y ã¨ã„ã†è¡¨è¨˜ã¯positive, negativeã« æ·»ãˆå­—ã‚’é™½æ€§ã‚’p&#40;positive&#41;, é™°æ€§ã‚’n&#40;negative&#41;ã«å¤‰ãˆã¦ã„ã¾ã™ã€‚ ã¾ãŸã€varã¯Ïƒã«å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚</p>
<pre><code class=language-julia >using Distributions, Plots
Î¼â‚š &#61; 1; Î¼â‚™ &#61; -1
Ïƒâ‚š&#61;1; Ïƒâ‚™ &#61;1
Nâ‚š &#61; 1000; Nâ‚™ &#61; 10000
positive &#61; rand&#40;Normal&#40;Î¼â‚š,Ïƒâ‚š&#41;,Nâ‚š&#41;
negative &#61; rand&#40;Normal&#40;Î¼â‚™,Ïƒâ‚™&#41;,Nâ‚™&#41;
Î¸ &#61; exp.&#40;-10:0.1:100&#41;;
U &#61; Vector&#123;Float64&#125;&#40;undef,length&#40;Î¸&#41;&#41;
V &#61; Vector&#123;Float64&#125;&#40;undef,length&#40;Î¸&#41;&#41;
for i in 1:length&#40;Î¸&#41;
    U&#91;i&#93; &#61; sum&#40;@. pdf&#40;Normal&#40;Î¼â‚š,Ïƒâ‚š&#41;,negative&#41; / pdf&#40;Normal&#40;Î¼â‚™,Ïƒâ‚™&#41;,negative&#41; &gt; Î¸&#91;i&#93;&#41; / Nâ‚™
    V&#91;i&#93; &#61; sum&#40;@. pdf&#40;Normal&#40;Î¼â‚š,Ïƒâ‚š&#41;,positive&#41; / pdf&#40;Normal&#40;Î¼â‚™,Ïƒâ‚™&#41;,positive&#41; &gt; Î¸&#91;i&#93;&#41; / Nâ‚š
end

AUC &#61; 0
for i in 1:length&#40;Î¸&#41;-1
    AUC &#43;&#61; abs&#40;U&#91;i&#43;1&#93;-U&#91;i&#93;&#41;*V&#91;i&#93;
end
p38 &#61; plot&#40;U,V,xlabel&#61;&quot;False Positive&quot;,ylabel&#61;&quot;False Negative&quot;,
            title&#61;&quot;ROC curve&quot;,legend&#61;false,
            ann &#61; &#40;0.5,0.5,&quot;AUC &#61; &#36;&#40;round&#40;AUC,digits&#61;2&#41;&#41;&quot;&#41;&#41;</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-6.svg" alt="">
  <p style="text-align:right">  ã‚ã§ãŸã—ã‚ã§ãŸã— </p>  <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p>
<div class=page-foot >
  <div class=copyright >
    &copy; Kei Hanafusa. Last modified: August 09, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/Joe.jl/libs/vela/slideout.min.js"></script>
  <script src="/Joe.jl/libs/myBtn/myBtn.js"></script>
  <script src="/Joe.jl/libs/popup/jquery.magnific-popup.min.js"></script>
  <script src="/Joe.jl/libs/popup/mypopup.js"></script>
  
    



  
  
    <script src="/Joe.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
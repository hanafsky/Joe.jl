<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Joe.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Joe.jl/libs/highlight/github.min.css"> <link href="/Joe.jl/css/franklin.css" rel=stylesheet > <link href="/Joe.jl/css/vela.css" rel=stylesheet > <script src="/Joe.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/Joe.jl/assets/favicon.ico"> <title>ãªã‚“ã§ã‚‚juliaã§ã‚„ã£ã¦ã¿ã‚‹ã€‚</title> <div class=main-nav  id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/Joe.jl/index.html">ãƒˆãƒƒãƒ—</a> <li><a href="" class=has-arrow >çµ±è¨ˆçš„æ©Ÿæ¢°å­¦ç¿’ã®æ•°ç†100å•</a> <ul> <li><a href="/Joe.jl/StatisticalML/chap1/">ç¬¬ä¸€ç« </a> <li><a href="/Joe.jl/StatisticalML/chap2/">ç¬¬äºŒç« </a> <li><a href="/Joe.jl/StatisticalML/chap4/">ç¬¬å››ç« </a> </ul> <li><a href="" class=has-arrow >ã‚¹ãƒ‘ãƒ¼ã‚¹æ¨å®š100å•</a> <ul> <li> </ul> </ul> </nav> </div> <main id=panel > <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">åˆ†é¡</h1> <hr> <div class=franklin-content ><p><div class=franklin-toc ><ol><li><a href="#ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</a><ol><li><a href="#ä¾‹29">ä¾‹29</a></ol><li><a href="#ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•">ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ»ãƒ©ãƒ•ã‚½ãƒ³æ³•</a><ol><li><a href="#ä¾‹31">ä¾‹31</a><li><a href="#ä¾‹31__2">ä¾‹31</a><li><a href="#ä¾‹33">ä¾‹33</a></ol><li><a href="#23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥">2.3 ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥</a><ol><li><a href="#ä¾‹35">ä¾‹35</a><li><a href="#ä¾‹36_fisherã®ã‚ã‚„ã‚">ä¾‹36 &#40;Fisherã®ã‚ã‚„ã‚&#41;</a></ol></ol></div> <h2 id="ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°"><a href="#ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</a></h2> <h3 id="ä¾‹29"><a href="#ä¾‹29">ä¾‹29</a></h3> <p>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚</p> <pre><code class="julia hljs">sigmoid(x::<span class=hljs-built_in >Matrix</span>, Î²::<span class=hljs-built_in >Vector</span>) = <span class=hljs-number >1</span> / (<span class=hljs-number >1</span> + exp(-x*Î²))</code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Plots
p29 = plot(xlims=(-<span class=hljs-number >10</span>,<span class=hljs-number >10</span>), xlabel=<span class=hljs-string >&quot;x&quot;</span>,ylabel=<span class=hljs-string >&quot;P(Y=1|x)&quot;</span>,
            legend=:topleft, title=<span class=hljs-string >&quot;ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ›²ç·š&quot;</span>)
x29 = expand_matrix(-<span class=hljs-number >10</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >10</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> [<span class=hljs-number >0</span>, <span class=hljs-number >0.2</span>, <span class=hljs-number >0.5</span>, <span class=hljs-number >1</span>, <span class=hljs-number >2</span>, <span class=hljs-number >10</span>]
    plot!(p29, x29[:,<span class=hljs-number >2</span>], Joe.sigmoid(x29,[<span class=hljs-number >0</span>,i]),label=<span class=hljs-string >&quot;<span class=hljs-variable >$i</span>&quot;</span>)
<span class=hljs-keyword >end</span></code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-1.svg" alt="">
<h2 id="ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•"><a href="#ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ©ãƒ•ã‚½ãƒ³æ³•">ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ãƒ»ãƒ©ãƒ•ã‚½ãƒ³æ³•</a></h2>
<h3 id="ä¾‹31"><a href="#ä¾‹31">ä¾‹31</a></h3>
<p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x^2-1=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã‚’4ã‚’åˆæœŸå€¤ã¨ã—ã¦æ•°å€¤è¨ˆç®—ã§è§£ãå•é¡Œã€‚10å›ã§ã©ã®ç¨‹åº¦è¿‘ã¥ãã‹ã€‚ ã›ã£ã‹ããªã®ã§ã€ å¾®åˆ†ã‚’ã‚ã‚‰ã‚ã«æ›¸ãä¸‹ã™ã®ã§ã¯ãªãã¦ã€è‡ªå‹•å¾®åˆ†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ è¦‹ãŸç›®ãŒ<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>â†</mo><mi>x</mi><mo>âˆ’</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mrow><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">x \leftarrow x - \dfrac{f(x)}{f&#x27;(x)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã¨ã„ã†å…¬å¼ã®ã¾ã‚“ã¾ã§ã™ã­ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Zygote
f(x) = x^<span class=hljs-number >2</span> -<span class=hljs-number >1</span>
x=<span class=hljs-number >4</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    x -= f(x)/f&#x27;(x)
    println(x)
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">2.125
1.2977941176470589
1.0341661806365605
1.0005643811996305
1.0000001591732348
1.0000000000000127
1.0
1.0
1.0
1.0
</code></pre>
<h3 id="ä¾‹31__2"><a href="#ä¾‹31__2">ä¾‹31</a></h3>
<p>2å¤‰æ•°é–¢æ•°ãŒ2ã¤ã‚ã‚‹å ´åˆã€‚ Zygote.jlã«jacobianãŒãªã‹ã£ãŸã®ã§ã€ForwardDiff.jlã‚’ä½¿ã£ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> ForwardDiff

f(x,y) = [x^<span class=hljs-number >2</span>+y^<span class=hljs-number >2</span>-<span class=hljs-number >1</span>, x+y]
z = [<span class=hljs-number >3</span>,<span class=hljs-number >4</span>]
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    z -= ForwardDiff.jacobian(x-&gt;f(x[<span class=hljs-number >1</span>], x[<span class=hljs-number >2</span>]),z) \ f(z[<span class=hljs-number >1</span>],z[<span class=hljs-number >2</span>])
    println(z)
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">[-13.000000000000004, 13.000000000000002]
[-6.519230769230771, 6.519230769230771]
[-3.297963467211255, 3.297963467211255]
[-1.7247860905930625, 1.7247860905930625]
[-1.0073385555621193, 1.0073385555621193]
[-0.7518480044063836, 0.7518480044063836]
[-0.7084380190454468, 0.7084380190454468]
[-0.7071080319623313, 0.7071080319623313]
[-0.7071067811876538, 0.7071067811876538]
[-0.7071067811865475, 0.7071067811865475]
</code></pre>
<h3 id="ä¾‹33"><a href="#ä¾‹33">ä¾‹33</a></h3>
<p>æœ€å°¤æ¨å®šã«ã‚ˆã‚Šãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã‚’è¡Œã†å•é¡Œã€‚ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >âˆ‡</mi><mi>l</mi><mo stretchy=false >(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo separator=true >,</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nabla l(\beta_0, \beta) = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >âˆ‡</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã‚’æ±‚ã‚ã‚‹å•é¡Œã‚’è§£ã„ã¦ã¿ã‚‹ã€‚ ç´ ç›´ã«<code>1 ./ &#40;1 .&#43; exp.&#40;X*Î²&#41;&#41;</code>ã¨æ›¸ã„ãŸã‚Šforæ–‡ã‚’å›ã—ã¦ã‚‚è‰¯ã„ã¨æ€ã„ã¾ã™ãŒã€‚ï¼‰</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe, Random, LinearAlgebra
N=<span class=hljs-number >1000</span>; p=<span class=hljs-number >2</span>; Random.seed!(<span class=hljs-number >12</span>)
X = expand_matrix(randn(N,p))
Î² = randn(p+<span class=hljs-number >1</span>)
prob = @. <span class=hljs-number >1</span>/(<span class=hljs-number >1</span> + exp($*(X,Î²)))
threshold=<span class=hljs-number >0.5</span>
y = ifelse.(rand(N) .&gt; prob,<span class=hljs-number >1</span>,-<span class=hljs-number >1</span>) <span class=hljs-comment ># ã“ã“ã¾ã§ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ</span>
<span class=hljs-meta >@show</span> y Î²</code></pre><pre><code class="plaintext hljs">y = [-1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1, -1, -1, 1, -1, 1, 1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, 1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, 1, -1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, 1, -1, 1, 1, -1, 1, 1, -1, 1, 1, -1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, 1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1, 1, 1, 1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, -1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, 1, 1, -1, -1, -1, 1, 1]
Î² = [-0.4162625490184776, -1.342542682700591, 0.09043723155291195]
</code></pre>
<p>ã›ã£ã‹ããªã®ã§ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs">data1 = X[y .== <span class=hljs-number >1</span>, <span class=hljs-number >2</span>:<span class=hljs-number >3</span>]
data2 = X[y .== -<span class=hljs-number >1</span>, <span class=hljs-number >2</span>:<span class=hljs-number >3</span>]
p33=scatter(data1[:,<span class=hljs-number >1</span>],data1[:,<span class=hljs-number >2</span>],ylims=(-<span class=hljs-number >5</span>,<span class=hljs-number >5</span>),marker=:auto, label=<span class=hljs-string >&quot;y=1&quot;</span>)
scatter!(data2[:,<span class=hljs-number >1</span>],data2[:,<span class=hljs-number >2</span>],marker=:auto,label=<span class=hljs-string >&quot;y=-1&quot;</span>)
plot!(x-&gt; -Î²[<span class=hljs-number >1</span>]/Î²[<span class=hljs-number >3</span>] - Î²[<span class=hljs-number >2</span>]/Î²[<span class=hljs-number >3</span>]*x, label=<span class=hljs-string >&quot;Î²&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-2.svg" alt="">
<pre><code class="julia hljs">Î³ = randn(p+<span class=hljs-number >1</span>)
Î³<span class=hljs-number >2</span>=copy(Î³)
<span class=hljs-meta >@show</span> Î³

W(v::<span class=hljs-built_in >Vector</span>) = @.(v/(<span class=hljs-number >1</span>+ v)^<span class=hljs-number >2</span>) |&gt; diagm
t = <span class=hljs-literal >true</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    <span class=hljs-keyword >global</span> Î³
    s=X*Î³
    v = @. exp(-y*s)
    u = @. y*v/(<span class=hljs-number >1</span>+v)
    Î³ += ((X&#x27;*W(v)*X) \ X&#x27;) * u
    <span class=hljs-comment >#Î´&#x27;*Î´ &lt; 0.001 &amp;&amp; (t = false)</span>
    <span class=hljs-meta >@show</span> Î³
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">Î³ = [-0.8771716229486168, -0.2526647989249558, 0.03370522564888635]
Î³ = [-0.3160894896511689, -1.0914139744134563, -0.15348497886015344]
Î³ = [-0.379765402697948, -1.25496756611813, -0.17121180318377313]
Î³ = [-0.3846741826784717, -1.2691296918419084, -0.17335517332850547]
Î³ = [-0.3847054570036605, -1.2692254442251742, -0.17337199438178288]
Î³ = [-0.3847054583679146, -1.2692254485603638, -0.17337199521205846]
Î³ = [-0.3847054583679146, -1.2692254485603638, -0.17337199521205846]
Î³ = [-0.3847054583679146, -1.2692254485603638, -0.17337199521205846]
Î³ = [-0.3847054583679146, -1.2692254485603638, -0.17337199521205846]
Î³ = [-0.3847054583679146, -1.2692254485603638, -0.17337199521205846]
Î³ = [-0.3847054583679146, -1.2692254485603638, -0.17337199521205846]
</code></pre>
<p>æ¨ªç€ã‚’ã—ã¦ã€è‡ªå‹•å¾®åˆ†ã‚’ä½¿ã£ã¦è¨ˆç®—ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Zygote, LinearAlgebra
l(Î³,X=X,y=y) = sum(@. log( <span class=hljs-number >1</span> /(<span class=hljs-number >1</span>+exp(*($*(X,Î³),-y))))) <span class=hljs-comment >#å¯¾æ•°å°¤åº¦é–¢æ•°</span>

<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    <span class=hljs-keyword >global</span> Î³,Î³<span class=hljs-number >2</span>
    Î´ =  Zygote.hessian(l,Î³) \ l&#x27;(Î³)
    <span class=hljs-meta >@show</span> norm(Î´)^<span class=hljs-number >2</span>
    Î³<span class=hljs-number >2</span> -= Î´
    <span class=hljs-meta >@show</span> Î³<span class=hljs-number >2</span>
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.2526647989249557, 0.03370522564888639]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.2526647989249556, 0.03370522564888642]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.25266479892495547, 0.03370522564888646]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.25266479892495536, 0.03370522564888649]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.25266479892495525, 0.033705225648886526]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.25266479892495514, 0.03370522564888656]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.252664798924955, 0.033705225648886596]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.2526647989249549, 0.03370522564888663]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.2526647989249548, 0.033705225648886665]
norm(Î´) ^ 2 = 1.74613568400146e-32
Î³2 = [-0.8771716229486168, -0.2526647989249547, 0.0337052256488867]
</code></pre>
<h2 id="23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥"><a href="#23_ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥">2.3 ç·šå½¢åˆ¤åˆ¥ã¨äºŒæ¬¡åˆ¤åˆ¥</a></h2>
<h3 id="ä¾‹35"><a href="#ä¾‹35">ä¾‹35</a></h3>
<p>ã¾ãšã¯ä¸ãˆã‚‰ã‚ŒãŸå¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‹ã‚‰äºŒæ¬¡å…ƒæ­£è¦åˆ†å¸ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’2ç¨®é¡ç”Ÿæˆã—ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, Random,Plots, LinearAlgebra, Parameters
Î¼â‚=[<span class=hljs-number >2</span>,<span class=hljs-number >2</span>];  Î£â‚ = [<span class=hljs-number >2</span> <span class=hljs-number >0</span>; <span class=hljs-number >0</span> <span class=hljs-number >2</span>]
Î¼â‚‚=[-<span class=hljs-number >3</span>,-<span class=hljs-number >3</span>]; Î£â‚‚ = [<span class=hljs-number >1</span> -<span class=hljs-number >0.8</span>; -<span class=hljs-number >0.8</span> <span class=hljs-number >1</span>]

N = <span class=hljs-number >100</span>;Random.seed!(<span class=hljs-number >123</span>)
data1 = rand(MvNormal(Î¼â‚,Î£â‚),<span class=hljs-number >100</span>) |&gt; transpose
data2 = rand(MvNormal(Î¼â‚‚,Î£â‚‚),<span class=hljs-number >100</span>) |&gt; transpose
p35 = scatter(data1[:,<span class=hljs-number >1</span>],data1[:,<span class=hljs-number >2</span>])
scatter!(p35, data2[:,<span class=hljs-number >1</span>],data2[:,<span class=hljs-number >2</span>])</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-3.svg" alt="">
<p>ã“ã“ã¾ã§ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã€‚ ç”Ÿæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’è¨ˆç®—ã™ã‚‹ã€‚</p>
<pre><code class="julia hljs">Î¼Ì‚â‚ = mean(data1,dims=<span class=hljs-number >1</span>)&#x27;; Î£Ì‚â‚ = cov(data1,dims=<span class=hljs-number >1</span>);
Î¼Ì‚â‚‚ = mean(data2,dims=<span class=hljs-number >1</span>)&#x27; ; Î£Ì‚â‚‚ = cov(data2,dims=<span class=hljs-number >1</span>);</code></pre>
<p><div class=warning ><div class=title >ğŸ˜• Warning&#33;</div>
<div class=content >meané–¢æ•°ã§è¡Œåˆ—ã®åˆ—æ–¹å‘ã®å¹³å‡ã‚’ã¨ã‚‹æ™‚ã€å¾—ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯äºŒæ¬¡å…ƒã®æ¨ªãƒ™ã‚¯ãƒˆãƒ«ã«ãªã£ã¦ã„ã‚‹ã€‚<br />ç¸¦ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦æ‰±ã„ãŸã„ã®ã§ã€è»¢ç½®ã—ã¦ã„ã‚‹ã€‚</div></div> ãã‚Œãã‚Œã®åˆ†å¸ƒã®æƒ…å ±ã‚’è¤‡åˆå‹ã«ã¾ã¨ã‚ã¦ãŠãã€‚</p>
<pre><code class="julia hljs"><span class=hljs-meta >@with_kw</span> <span class=hljs-keyword >struct</span> mvnormal
    Î¼::<span class=hljs-built_in >Array</span> <span class=hljs-comment ># å¹³å‡</span>
    Î£::<span class=hljs-built_in >Matrix</span> <span class=hljs-comment ># åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—</span>
    invÎ£::<span class=hljs-built_in >Array</span> = inv(Î£) <span class=hljs-comment ># åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®é€†è¡Œåˆ—</span>
    detÎ£ = det(Î£) <span class=hljs-comment ># åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®è¡Œåˆ—å¼</span>
<span class=hljs-keyword >end</span></code></pre>
<p>ã¾ãŸã€å¤šå¤‰é‡æ­£è¦åˆ†å¸ƒã®å¯¾æ•°å°¤åº¦ã‚’å–å¾—ã™ã‚‹é–¢æ•°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ã€‚ å¯å¤‰é•·å¼•æ•°ã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãŒ3æ¬¡å…ƒä»¥ä¸Šã®å ´åˆã«ã‚‚æ‹¡å¼µã—ã¦ã„ã‚‹ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> logMvNormal(parameter::mvnormal,x...)
    data = collect(x)
    <span class=hljs-meta >@unpack</span> Î¼,invÎ£,detÎ£ = parameter
    a = <span class=hljs-number >0.5</span>*(data-Î¼)&#x27; * invÎ£ * (data-Î¼)
    a[<span class=hljs-number >1</span>] - log(detÎ£)
<span class=hljs-keyword >end</span></code></pre>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Joe: mvnormal, logMvNormal
param1=mvnormal(Î¼= Î¼Ì‚â‚,Î£ = Î£Ì‚â‚);param2=mvnormal(Î¼ = Î¼Ì‚â‚‚,Î£ = Î£Ì‚â‚‚)</code></pre><pre><code class="plaintext hljs">Joe.mvnormal
  Î¼: Array{Float64}((2, 1)) [-3.047955710310618; -2.932266562954253]
  Î£: Array{Float64}((2, 2)) [1.0429822697740516 -0.7599159692872768; -0.7599159692872768 0.9117178328466301]
  invÎ£: Array{Float64}((2, 2)) [2.441447895452185 2.0349445597046123; 2.0349445597046123 2.792954986504203]
  detÎ£: Float64 0.37343325431803626
</code></pre>
<p>ãã‚Œãã‚Œã®æ­£è¦åˆ†å¸ƒã®å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã®ã‚’ä¸ãˆãŸã¨ãã® å¯¾æ•°å°¤åº¦ã®å·®ã‚’ã¨ã£ã¦ã€ã‚³ãƒ³ã‚¿ãƒ¼å›³ã«ã™ã‚‹ã€‚&#40;äºŒæ¬¡åˆ¤åˆ¥&#41;</p>
<pre><code class="julia hljs">hanbetsu(x,y) = logMvNormal(param1,x,y) - logMvNormal(param2,x,y)
x35=-<span class=hljs-number >5</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >5</span>;
y35=-<span class=hljs-number >5</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >5</span>;
scatter(data1[:,<span class=hljs-number >1</span>],data1[:,<span class=hljs-number >2</span>])
scatter!( data2[:,<span class=hljs-number >1</span>],data2[:,<span class=hljs-number >2</span>])
p35_2=contour!(x35,y35, hanbetsu.(x35,y35&#x27;), title=<span class=hljs-string >&quot;QDA&quot;</span>)</code></pre>
<p><img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-4.svg" alt=""> ç·šå½¢åˆ¤åˆ¥ã‚’è¡Œã†å ´åˆã¯ã€åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ãŒç­‰ã—ã„ã“ã¨ã‚’ä»®å®šã™ã‚‹ã€‚ data1ã¨data2ã‚’ã€ãã‚Œãã‚Œä¸­å¿ƒåŒ–å¾Œã«çµ±åˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦ã€ æ–°ãŸãªåˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—ã‚’æ±‚ã‚ã‚‹ã“ã¨ã«ã™ã‚‹ã€‚ å¾Œã¯</p>
<pre><code class="julia hljs">Î£_L =  vcat(data1 .- Î¼Ì‚â‚&#x27; , data2 .- Î¼Ì‚â‚‚&#x27;) |&gt; cov
param1_L=mvnormal(Î¼= Î¼Ì‚â‚,Î£ =Î£_L );param2_L=mvnormal(Î¼ = Î¼Ì‚â‚‚,Î£ = Î£_L)
hanbetsu_L(x,y) = logMvNormal(param1_L,x,y) - logMvNormal(param2_L,x,y)
p35_3=contour!(p35,x35,y35, hanbetsu_L.(x35,y35&#x27;), title=<span class=hljs-string >&quot;LDA&quot;</span>)</code></pre>
<img src="/Joe.jl/assets/StatisticalML/chap2/code/output/fig2-5.svg" alt="">
<h3 id="ä¾‹36_fisherã®ã‚ã‚„ã‚"><a href="#ä¾‹36_fisherã®ã‚ã‚„ã‚">ä¾‹36 &#40;Fisherã®ã‚ã‚„ã‚&#41;</a></h3>
<p>ã¾ãšRDatasetsã‹ã‚‰irisã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã‚€ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> RDatasets, StatsBase
<span class=hljs-keyword >using</span> Joe:mvnormal, logMvNormal
iris = dataset(<span class=hljs-string >&quot;datasets&quot;</span>,<span class=hljs-string >&quot;iris&quot;</span>)
x = iris[!,<span class=hljs-number >1</span>:<span class=hljs-number >4</span>]
y = iris.Species
n = length(y)
index = sample(<span class=hljs-number >1</span>:n,n,replace=<span class=hljs-literal >false</span>); <span class=hljs-comment >#ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œã‚Š</span>
train=index[<span class=hljs-keyword >begin</span>:<span class=hljs-built_in >Int</span>(n/<span class=hljs-number >2</span>)];<span class=hljs-comment ># å­¦ç¿’ç”¨ã¨ãƒ†ã‚¹ãƒˆç”¨ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ†ã‘ã‚‹ã€‚</span>
text = index[<span class=hljs-built_in >Int</span>(n/<span class=hljs-number >2</span>)+<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>];
X = x[train,:] |&gt; <span class=hljs-built_in >Matrix</span>
Y = y[train];</code></pre><pre><code class="plaintext hljs">ArgumentError: Package StatsBase not found in current path:
- Run `import Pkg; Pkg.add(&quot;StatsBase&quot;)` to install the StatsBase package.

</code></pre>
<p>params &#61; mvnormal&#91;&#93; ã‚ã‚„ã‚ã®ç¨®é¡ã”ã¨ã«å¹³å‡ã¨åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ— for species in unique&#40;y&#41;     xx &#61; X&#91;y&#61;&#61;species,:&#93;     push&#33;&#40;Î¼, mean&#40;xx,dims&#61;1&#41;&#41;     push&#33;&#40;Î£, cov&#40;xx,dims&#61;1&#41;&#41; end</p>
</p>
<div class=page-foot >
  <div class=copyright >
    &copy; Kei Hanafusa. Last modified: December 22, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/Joe.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/Joe.jl/libs/vela/slideout.min.js"></script>